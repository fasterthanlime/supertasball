/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.0 - 2012/03/13

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
"use strict";window.neoart=Object.create(null);function ByteArray(b){var a=Object.create(null,{endian:{value:1,writable:!0},length:{value:0,writable:!0},index:{value:0,writable:!0},buffer:{value:null,writable:!0},view:{value:null,writable:!0},bytesAvailable:{get:function(){return this.length-this.index}},position:{get:function(){return this.index},set:function(a){0>a?a=0:a>this.length&&(a=this.length);this.index=a}},clear:{value:function(){this.buffer=new ArrayBuffer;this.view=null;this.index=this.length=0}},readAt:{value:function(a){return this.view.getUint8(a)}},
readByte:{value:function(){return this.view.getInt8(this.index++)}},readShort:{value:function(){var a=this.view.getInt16(this.index,this.endian);this.index+=2;return a}},readInt:{value:function(){var a=this.view.getInt32(this.index,this.endian);this.index+=4;return a}},readUbyte:{value:function(){return this.view.getUint8(this.index++)}},readUshort:{value:function(){var a=this.view.getUint16(this.index,this.endian);this.index+=2;return a}},readUint:{value:function(){var a=this.view.getUint32(this.index,
this.endian);this.index+=4;return a}},readBytes:{value:function(a,b,d){var a=a.view,c=this.index,e=this.view;if((d+=c)>this.length)d=this.length;for(;c<d;++c)a.setUint8(b++,e.getUint8(c));this.index=c}},readString:{value:function(a){var b=this.index,d=this.view,c="";if((a+=b)>this.length)a=this.length;for(;b<a;++b)c+=String.fromCharCode(d.getUint8(b));this.index=a;return c}},writeAt:{value:function(a,b){this.view.setUint8(a,b)}},writeByte:{value:function(a){this.view.setInt8(this.index++,a)}},writeShort:{value:function(a){this.view.setInt16(this.index,
a);this.index+=2}},writeInt:{value:function(a){this.view.setInt32(this.index,a);this.index+=4}}});a.buffer=b;a.view=new DataView(b);a.length=b.byteLength;return Object.seal(a)}function Sample(){return Object.create(null,{l:{value:0,writable:!0},r:{value:0,writable:!0},next:{value:null,writable:!0}})}
function CoreMixer(){return Object.create(null,{player:{value:null,writable:!0},channels:{value:[],writable:!0},buffer:{value:[],writable:!0},samplesTick:{value:0,writable:!0},samplesLeft:{value:0,writable:!0},remains:{value:0,writable:!0},completed:{value:0,writable:!0},bufferSize:{get:function(){return this.buffer.length},set:function(b){var a;a=this.buffer.length||0;if(!(b==a||512>b))if(this.buffer.length=b,b>a){this.buffer[a]=Sample();for(a=++a;a<b;++a)this.buffer[a]=this.buffer[a-1].next=Sample()}}},
complete:{get:function(){return this.completed},set:function(b){this.completed=b^this.player.loopSong}},reset:{value:function(){var b=this.channels[0],a=this.buffer[0];for(this.completed=this.remains=this.samplesLeft=0;b;)b.initialize(),b=b.next;for(;a;)a.l=a.r=0,a=a.next}},restore:{configurable:!0,value:function(){}}})}
function CorePlayer(){var b=Object.create(null,{context:{value:null,writable:!0},node:{value:null,writable:!0},analyse:{value:0,writable:!0},endian:{value:0,writable:!0},sampleRate:{value:0,writable:!0},playSong:{value:0,writable:!0},lastSong:{value:0,writable:!0},version:{value:0,writable:!0},title:{value:"",writable:!0},channels:{value:0,writable:!0},loopSong:{value:0,writable:!0},speed:{value:0,writable:!0},tempo:{value:0,writable:!0},mixer:{value:null,writable:!0},tick:{value:0,writable:!0},paused:{value:0,
writable:!0},callback:{value:null,writable:!0},quality:{configurable:!0,set:function(a){this.callback=a?this.mixer.accurate.bind(this.mixer):this.mixer.fast.bind(this.mixer)}},toggle:{value:function(a){this.mixer.channels[a].mute^=1}},setup:{configurable:!0,value:function(){}},load:{value:function(a){this.lastSong=this.playSong=this.version=0;this.mixer.restore();a.view||(a=ByteArray(a));a.position=0;if(67324752==a.readUint())if(window.neoart.Unzip)a=ZipFile(a),a=a.uncompress(a.entries[0]);else throw"Unzip support is not available.";
a.endian=this.endian;a.position=0;this.loader(a);this.version&&this.setup();return this.version}},play:{value:function(){var a;this.version&&(this.paused?this.paused=0:(this.initialize(),this.node=this.context.createScriptProcessor(this.mixer.bufferSize),this.node.onaudioprocess=this.callback),this.analyse&&window.neoart.Flectrum?(a=window.neoart.analyserNode=this.context.createAnalyser(),this.node.connect(a),a.connect(this.context.destination)):this.node.connect(this.context.destination),a=document.createEvent("Event"),
a.initEvent("flodPlay",!0,!1),document.dispatchEvent(a))}},pause:{value:function(){if(this.node){this.node.disconnect();this.paused=1;var a=document.createEvent("Event");a.initEvent("flodPause",!0,!1);document.dispatchEvent(a)}}},stop:{value:function(){if(this.node){this.node.disconnect();this.node.onaudioprocess=this.node=null;this.paused=0;this.restore&&this.restore();var a=document.createEvent("Event");a.initEvent("flodStop",!0,!1);document.dispatchEvent(a)}}},reset:{value:function(){this.tick=
0;this.mixer.initialize();this.mixer.samplesTick=2.5*this.sampleRate/this.tempo>>0}}});window.neoart.audioContext||(window.neoart.audioContext=new AudioContext);b.context=window.neoart.audioContext;b.sampleRate=b.context.sampleRate;return b};/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.0 - 2012/03/13

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
function ZipFile(e){function h(c){var b=Object.create(null,{count:{value:null,writable:!0},symbol:{value:null,writable:!0}});b.count=new Uint16Array(c);b.symbol=new Uint16Array(c);return Object.seal(b)}function n(){var c=Object.create(null,{output:{value:null,writable:!0},inpbuf:{value:null,writable:!0},inpcnt:{value:0,writable:!0},outcnt:{value:0,writable:!0},bitbuf:{value:0,writable:!0},bitcnt:{value:0,writable:!0},flencode:{value:null,writable:!0},fdiscode:{value:null,writable:!0},dlencode:{value:null,
writable:!0},ddiscode:{value:null,writable:!0},input:{set:function(b){this.inpbuf=b[0];this.inpbuf.endian=b[2];this.inpcnt=this.inpbuf.position=0;this.output=ByteArray(new ArrayBuffer(b[1]));this.output.endian=b[2];this.outcnt=this.output.position=0}},inflate:{value:function(){var b,a;do if(a=this.bits(1),b=this.bits(2),b=0==b?this.stored():1==b?this.codes(this.flencode,this.fdiscode):2==b?this.dynamic():1)throw o;while(!a)}},initialize:{value:function(){var b=new Uint8Array(288),a=0;this.flencode=
h(288);for(this.fdiscode=h(30);144>a;++a)b[a]=8;for(;256>a;++a)b[a]=9;for(;280>a;++a)b[a]=7;for(;288>a;++a)b[a]=8;this.construct(this.fdiscode,b,288);for(a=0;30>a;++a)b[a]=5;this.construct(this.fdiscode,b,30);this.dlencode=h(286);this.ddiscode=h(30)}},construct:{value:function(b,a,k){for(var c=0,d=1,i=new Uint16Array(16),f=0;16>c;++c)b.count[c]=0;for(;f<k;++f)b.count[a[f]]++;if(b.count[0]==k)return 0;for(c=1;16>c;++c)if(d<<=1,d-=b.count[c],0>d)return d;for(c=1;15>c;++c)i[c+1]=i[c]+b.count[c];for(f=
0;f<k;++f)0!=a[f]&&(b.symbol[i[a[f]]++]=f);return d}},bits:{value:function(b){for(var a=this.bitbuf,c=this.inpbuf.length;this.bitcnt<b;){if(this.inpcnt==c)throw j;a|=this.inpbuf.readAt(this.inpcnt++)<<this.bitcnt;this.bitcnt+=8}this.bitbuf=a>>b;this.bitcnt-=b;return a&(1<<b)-1}},codes:{value:function(b,a){var c,g,d;do{d=this.decode(b);if(0>d)return d;if(256>d)this.output.writeAt(this.outcnt++,d);else if(256<d){d-=257;if(29<=d)throw ERRRO7;g=p[d]+this.bits(q[d]);d=this.decode(a);if(0>d)return d;c=
r[d]+this.bits(s[d]);if(c>this.outcnt)throw t;for(c=this.outcnt-c;g--;)this.output.writeAt(this.outcnt++,this.output.readAt(c++))}}while(256!=d);return 0}},decode:{value:function(b){for(var a=this.bitbuf,c=0,g,d=0,i=0,f=this.inpbuf.length,e=this.bitcnt,h=1;;){for(;e--;){c|=a&1;a>>=1;g=b.count[h];if(c<d+g)return this.bitbuf=a,this.bitcnt=this.bitcnt-h&7,b.symbol[i+(c-d)];i+=g;d+=g;d<<=1;c<<=1;++h}e=16-h;if(!e)break;if(this.inpcnt==f)throw j;a=this.inpbuf.readAt(this.inpcnt++);8<e&&(e=8)}return-9}},
stored:{value:function(){var b=this.inpbuf.length,a;this.bitbuf=this.bitcnt=0;if(this.inpcnt+4>b)throw j;a=this.inpbuf.readAt(this.inpcnt++);a|=this.inpbuf.readAt(this.inpcnt++)<<8;if(this.inpbuf.readAt(this.inpcnt++)!=(~a&255)||this.inpbuf.readAt(this.inpcnt++)!=(~a>>8&255))throw u;if(this.inpcnt+a>b)throw j;for(;a--;)this.output.writeAt(this.outcnt++,this.inpbuf.readAt(this.inpcnt++));return 0}},dynamic:{value:function(){var b=new Uint8Array(316),a;a=0;var c,g=this.bits(5)+257,d=this.bits(5)+1;
c=this.bits(4)+4;var e=g+d,f;if(286<g||30<d)throw v;for(;a<c;++a)b[m[a]]=this.bits(3);for(;19>a;++a)b[m[a]]=0;if(a=this.construct(this.dlencode,b,19))throw w;for(a=0;a<e;)if(f=this.decode(this.dlencode),16>f)b[a++]=f;else{c=0;if(16==f){if(0==a)throw x;c=b[a-1];f=3+this.bits(2)}else f=17==f?3+this.bits(3):11+this.bits(7);if(a+f>e)throw y;for(;f--;)b[a++]=c}a=this.construct(this.dlencode,b,g);if(0>a||0<a&&1!=g-this.dlencode.count[0])throw z;a=this.construct(this.ddiscode,b.subarray(g),d);if(0>a||0<
a&&1!=d-this.ddiscode.count[0])throw A;return this.codes(this.dlencode,this.ddiscode)}}});c.initialize();return Object.seal(c)}function B(){return Object.create(null,{name:{value:"",writable:!0},extra:{value:null,writable:!0},version:{value:0,writable:!0},flag:{value:0,writable:!0},method:{value:0,writable:!0},time:{value:0,writable:!0},crc:{value:0,writable:!0},compressed:{value:0,writable:!0},size:{value:0,writable:!0},offset:{value:0,writable:!0},date:{get:function(){return new Date((this.time>>
25&127)+1980,(this.time>>21&15)-1,this.time>>16&31,this.time>>11&31,this.time>>5&63,(this.time&31)<<1)}},isDirectory:{get:function(){return"/"==this.name.charAt(this.name.length-1)}}})}if(!e)return null;var o="Invalid block type.",j="Available inflate data did not terminate.",t="Distance is too far back.",u="Stored block length did not match one's complement.",v="Too many length or distance codes.",w="Code lengths codes incomplete.",x="Repeat lengths with no first length.",y="Repeat more than specified lengths.",
z="Invalid literal/length code lengths.",A="Invalid distance code lengths.",p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],r=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],m=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],l=Object.create(null,{endian:{value:1,
writable:!0},entries:{value:null,writable:!0},stream:{value:null,writable:!0},uncompress:{value:function(c){var b=this.stream,a;a=!1;var e,g,d;if(!c)return null;if("string"==typeof c){d=this.entries.length;for(e=0;e<d;++e)if(g=this.entries[e],g.name==c){c=g;a=!0;break}if(!a)return null}b.position=c.offset+28;a=b.readUshort();b.position+=c.name.length+a;if(c.compressed)switch(a=ByteArray(new ArrayBuffer(c.compressed),this.endian),b.readBytes(a,0,c.compressed),c.method){case 0:return a;case 8:return b=n(),
b.input=[a,c.size,this.endian],b.inflate(),b.output;default:throw"Compression method not supported.";}}},parseCentral:{value:function(){var c=this.stream,b,a=ByteArray(new ArrayBuffer(46),this.endian),e,g=this.entries.length,d;for(e=0;e<g;++e){c.readBytes(a,0,46);a.position=0;if(33639248!=a.readUint())throw"Unexpected end of archive.";a.position+=24;d=a.readUshort();if(!d)throw"Unexpected end of archive.";b=B();b.name=c.readString(d);if(d=a.readUshort())b.extra=ByteArray(new ArrayBuffer(d),this.endian),
c.readBytes(b.extra,0,d);c.position+=a.readUshort();a.position=6;b.version=a.readUshort();b.flag=a.readUshort();if(1==(b.flag&1))throw"Encrypted archive not supported.";b.method=a.readUshort();b.time=a.readUint();b.crc=a.readUint();b.compressed=a.readUint();b.size=a.readUint();a.position=42;b.offset=a.readUint();Object.freeze(b);this.entries[e]=b}}},parseEnd:{value:function(){var c=this.stream,b=c.length-22,a=b-65536;0>a&&(a=0);do if(80==c.readAt(b)&&(c.position=b,101010256==c.readUint()))break;while(--b>
a);if(b==a)throw"The archive is either in unknown format or damaged.";c.position=b+10;this.entries=[];this.entries.length=c.readUshort();c.position=b+16;c.position=c.readUint();this.parseCentral()}}});e.view||(e=ByteArray(e));e.endian=1;e.position=0;l.stream=e;l.parseEnd();return Object.seal(l)}window.neoart.Unzip=1;/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.1 - 2012/04/09

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
function AmigaChannel(c){var b=Object.create(null,{next:{value:null,writable:!0},mute:{value:0,writable:!0},panning:{value:0,writable:!0},delay:{value:0,writable:!0},pointer:{value:0,writable:!0},length:{value:0,writable:!0},audena:{value:0,writable:!0},audcnt:{value:0,writable:!0},audloc:{value:0,writable:!0},audper:{value:0,writable:!0},audvol:{value:0,writable:!0},timer:{value:0,writable:!0},level:{value:0,writable:!0},ldata:{value:0,writable:!0},rdata:{value:0,writable:!0},enabled:{get:function(){return this.audena},
set:function(a){a!=this.audena&&(this.audena=a,this.audloc=this.pointer,this.audcnt=this.pointer+this.length,this.timer=1,a&&(this.delay+=2))}},period:{set:function(a){0>a?a=0:65535<a&&(a=65535);this.audper=a}},volume:{set:function(a){0>a?a=0:64<a&&(a=64);this.audvol=a}},resetData:{value:function(){this.rdata=this.ldata=0}},initialize:{value:function(){this.audloc=this.audcnt=this.audena=0;this.audper=50;this.length=this.pointer=this.delay=this.rdata=this.ldata=this.timer=this.audvol=0}}});b.panning=
b.level=0==(++c&2)?-1:1;return Object.seal(b)}function AmigaFilter(){return Object.create(null,{active:{value:0,writable:!0},forced:{value:-1,writable:!0},l0:{value:0,writable:!0},l1:{value:0,writable:!0},l2:{value:0,writable:!0},l3:{value:0,writable:!0},l4:{value:0,writable:!0},r0:{value:0,writable:!0},r1:{value:0,writable:!0},r2:{value:0,writable:!0},r3:{value:0,writable:!0},r4:{value:0,writable:!0},initialize:{value:function(){this.r0=this.r1=this.r2=this.r3=this.r4=this.l0=this.l1=this.l2=this.l3=this.l4=0}},process:{value:function(c,b){var a=
0.5139651662784244;0==c&&(this.l0=0.4860348337215757*b.l+a*this.l0,this.r0=0.4860348337215757*b.r+a*this.r0,a=0.06850445132502514,b.l=this.l1=0.9314955486749749*this.l0+a*this.l1,b.r=this.r1=0.9314955486749749*this.r0+a*this.r1);0<(this.active|this.forced)&&(a=0.47866541564678,this.l2=0.52133458435322*b.l+a*this.l2,this.r2=0.52133458435322*b.r+a*this.r2,this.l3=0.52133458435322*this.l2+a*this.l3,this.r3=0.52133458435322*this.r2+a*this.r3,b.l=this.l4=0.52133458435322*this.l3+a*this.l4,b.r=this.r4=
0.52133458435322*this.r3+a*this.r4);1<b.l?b.l=1:-1>b.l&&(b.l=-1);1<b.r?b.r=1:-1>b.r&&(b.r=-1)}}})}function AmigaRow(){return Object.create(null,{note:{value:0,writable:!0},sample:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0}})}
function AmigaSample(){return Object.create(null,{name:{value:"",writable:!0},length:{value:0,writable:!0},loop:{value:0,writable:!0},repeat:{value:0,writable:!0},volume:{value:0,writable:!0},pointer:{value:0,writable:!0},loopPtr:{value:0,writable:!0}})}function AmigaStep(){return Object.create(null,{pattern:{value:0,writable:!0},transpose:{value:0,writable:!0}})}
function Amiga(){var c=CoreMixer();Object.defineProperties(c,{filter:{value:null,writable:!0},model:{value:1,writable:!0},memory:{value:[],writable:!0},loopPtr:{value:0,writable:!0},loopLen:{value:4,writable:!0},clock:{value:0,writable:!0},master:{value:0,writable:!0},ready:{value:0,writable:!0},volume:{set:function(b){0<b?(64<b&&(b=64),this.master=0.00390625*(b/64)):this.master=0}},initialize:{value:function(){var b=this.memory.length,a=b+this.loopLen;this.reset();this.filter.initialize();if(!this.ready){this.ready=
1;for(this.loopPtr=b;b<a;++b)this.memory[b]=0}}},restore:{value:function(){this.ready=0;this.memory.length=0}},store:{value:function(b,a,l){var c,e,g=b.position,h=this.memory.length;l&&(b.position=l);e=b.position+a;e>=b.length&&(c=e-b.length,a=b.length-b.position);e=h;for(a+=h;e<a;++e)this.memory[e]=b.readByte();for(a+=c;e<a;++e)this.memory[e]=0;l&&(b.position=g);return h}},fast:{value:function(b){var a,c,m=this.memory,e,g=0,h,k=0,n,d,f=this.bufferSize,o,j,i;if(this.completed){if(!this.remains){this.player.stop();
return}f=this.remains}for(;g<f;){this.samplesLeft||(this.player.process(),this.samplesLeft=this.samplesTick,this.completed&&(f=g+this.samplesTick,f>this.bufferSize&&(this.remains=f-this.bufferSize,f=this.bufferSize)));j=this.samplesLeft;g+j>=f&&(j=f-g);h=k+j;for(a=this.channels[0];a;){d=this.buffer[k];if(a.audena&&60<a.audper){o=a.audper/this.clock;i=a.audvol*this.master;e=i*(1-a.level);n=i*(1+a.level);for(c=k;c<h;++c){if(a.delay)a.delay--;else if(1>--a.timer&&(a.mute||(i=0.0078125*m[a.audloc],a.ldata=
i*e,a.rdata=i*n),a.audloc++,a.timer+=o,a.audloc>=a.audcnt))a.audloc=a.pointer,a.audcnt=a.pointer+a.length;d.l+=a.ldata;d.r+=a.rdata;d=d.next}}else for(c=k;c<h;++c)d.l+=a.ldata,d.r+=a.rdata,d=d.next;a=a.next}k=h;g+=j;this.samplesLeft-=j}i=this.model;m=this.filter;d=this.buffer[0];a=b.outputBuffer.getChannelData(0);b=b.outputBuffer.getChannelData(1);for(c=0;c<f;++c)m.process(i,d),a[c]=d.l,b[c]=d.r,d.l=d.r=0,d=d.next}}});c.channels[0]=AmigaChannel(0);c.channels[0].next=c.channels[1]=AmigaChannel(1);
c.channels[1].next=c.channels[2]=AmigaChannel(2);c.channels[2].next=c.channels[3]=AmigaChannel(3);c.bufferSize=8192;c.filter=AmigaFilter();c.master=0.00390625;return Object.seal(c)}function AmigaPlayer(c){var b=CorePlayer();Object.defineProperties(b,{quality:{set:function(){this.callback=this.mixer.fast.bind(this.mixer)}},stereo:{set:function(a){var b=this.mixer.channels[0];for(0>a?a=0:1<a&&(a=1);b;)b.level=a*b.panning,b=b.next}},volume:{set:function(a){0>a?a=0:1<a&&(a=1);this.mixer.master=0.00390625*a}},frequency:{value:function(a){a?(this.mixer.clock=3579545/this.sampleRate,this.mixer.samplesTick=735):(this.mixer.clock=3546895/this.sampleRate,this.mixer.samplesTick=882)}}});
b.mixer=c||Amiga();b.mixer.player=b;b.frequency(0);b.channels=4;b.endian=0;b.quality=0;b.speed=6;b.tempo=125;return b};/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.1 - 2012/04/21

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
function SBChannel(){return Object.create(null,{next:{value:null,writable:!0},mute:{value:0,writable:!0},enabled:{value:0,writable:!0},sample:{value:null,writable:!0},length:{value:0,writable:!0},index:{value:0,writable:!0},pointer:{value:0,writable:!0},delta:{value:0,writable:!0},fraction:{value:0,writable:!0},speed:{value:0,writable:!0},dir:{value:0,writable:!0},oldSample:{value:null,writable:!0},oldLength:{value:0,writable:!0},oldPointer:{value:0,writable:!0},oldFraction:{value:0,writable:!0},
oldSpeed:{value:0,writable:!0},oldDir:{value:0,writable:!0},volume:{value:0,writable:!0},lvol:{value:0,writable:!0},rvol:{value:0,writable:!0},panning:{value:128,writable:!0},lpan:{value:0.5,writable:!0},rpan:{value:0.5,writable:!0},ldata:{value:0,writable:!0},rdata:{value:0,writable:!0},mixCounter:{value:0,writable:!0},lmixRampU:{value:0,writable:!0},lmixDeltaU:{value:0,writable:!0},rmixRampU:{value:0,writable:!0},rmixDeltaU:{value:0,writable:!0},lmixRampD:{value:0,writable:!0},lmixDeltaD:{value:0,
writable:!0},rmixRampD:{value:0,writable:!0},rmixDeltaD:{value:0,writable:!0},volCounter:{value:0,writable:!0},lvolDelta:{value:0,writable:!0},rvolDelta:{value:0,writable:!0},panCounter:{value:0,writable:!0},lpanDelta:{value:0,writable:!0},rpanDelta:{value:0,writable:!0},initialize:{value:function(){this.enabled=0;this.sample=null;this.dir=this.speed=this.fraction=this.delta=this.pointer=this.index=this.length=0;this.oldSample=null;this.rvol=this.lvol=this.volume=this.oldDir=this.oldSpeed=this.oldFraction=
this.oldPointer=this.oldLength=0;this.panning=128;this.rpan=this.lpan=0.5;this.rpanDelta=this.lpanDelta=this.panCounter=this.rvolDelta=this.lvolDelta=this.volCounter=this.rmixDeltaD=this.rmixRampD=this.lmixDeltaD=this.lmixRampD=this.rmixDeltaU=this.rmixRampU=this.lmixDeltaU=this.lmixRampU=this.mixCounter=this.rdata=this.ldata=0}}})}function SBSample(){return Object.create(null,{name:{value:"",writable:!0},bits:{value:8,writable:!0},volume:{value:0,writable:!0},length:{value:0,writable:!0},data:{value:[],writable:!0},loopMode:{value:0,writable:!0},loopStart:{value:0,writable:!0},loopLen:{value:0,writable:!0},store:{value:function(d){var b=0,a,g=this.length,f;this.loopLen||(this.loopMode=0);f=d.position;this.loopMode?(g=this.loopStart+this.loopLen,this.data=new Float32Array(g+1)):this.data=new Float32Array(this.length+1);if(8==
this.bits){f+g>d.length&&(g=d.length-f);for(a=0;a<g;a++)b=d.readByte()+b,-128>b?b+=256:127<b&&(b-=256),this.data[a]=0.0078125*b}else{f+(g<<1)>d.length&&(g=d.length-f>>1);for(a=0;a<g;a++)b=d.readShort()+b,-32768>b?b+=65536:32767<b&&(b-=65536),this.data[a]=3.051758E-5*b}b=f+length;this.loopMode?(this.length=this.loopStart+this.loopLen,this.data[g]=1==this.loopMode?this.data[this.loopStart]:this.data[g-1]):this.data[this.length]=0;if(g!=this.length){f=this.data[g-1];for(a=g;a<this.length;a++)this.data[a]=
f}d.position=b<d.length?b:d.length-1}}})}function Soundblaster(){var d=CoreMixer();Object.defineProperties(d,{setup:{value:function(b){var a=1;this.channels.length=b;for(this.channels[0]=SBChannel();a<b;++a)this.channels[a]=this.channels[a-1].next=SBChannel()}},initialize:{value:function(){this.reset()}},fast:{value:function(b){var a,g,f,d=0,k,m=0,l,e,i=this.bufferSize,h,j;if(this.completed){if(!this.remains){this.player.stop();return}i=this.remains}for(;d<i;){this.samplesLeft||(this.player.process(),this.player.fast(),this.samplesLeft=
this.samplesTick,this.completed&&(i=d+this.samplesTick,i>this.bufferSize&&(this.remains=i-this.bufferSize,i=this.bufferSize)));h=this.samplesLeft;d+h>=i&&(h=i-d);k=m+h;for(a=this.channels[0];a;){if(a.enabled){l=a.sample;g=l.data;e=this.buffer[m];for(f=m;f<k;++f){if(a.index!=a.pointer){if(a.index>=a.length)if(l.loopMode)a.pointer=l.loopStart+(a.index-a.length),a.length=l.length,2==l.loopMode&&(a.dir=a.dir?0:l.length+l.loopStart-1);else{a.enabled=0;break}else a.pointer=a.index;a.mute?(a.ldata=0,a.rdata=
0):(j=a.dir?g[a.dir-a.pointer]:g[a.pointer],a.ldata=j*a.lvol,a.rdata=j*a.rvol)}a.index=a.pointer+a.delta;if(1<=(a.fraction+=a.speed))a.index++,a.fraction--;e.l+=a.ldata;e.r+=a.rdata;e=e.next}}a=a.next}m=k;d+=h;this.samplesLeft-=h}e=this.buffer[0];a=b.outputBuffer.getChannelData(0);b=b.outputBuffer.getChannelData(1);for(f=0;f<i;++f)1<e.l?e.l=1:-1>e.l&&(e.l=-1),1<e.r?e.r=1:-1>e.r&&(e.r=-1),a[f]=e.l,b[f]=e.r,e.l=e.r=0,e=e.next}},accurate:{value:function(b){var a,d,f,p,k,m=0,l,e=0,i,h,j,c,o=this.bufferSize,
q,n;if(this.completed){if(!this.remains){this.player.stop();return}o=this.remains}for(;m<o;){this.samplesLeft||(this.player.process(),this.player.accurate(),this.samplesLeft=this.samplesTick,this.completed&&(o=m+this.samplesTick,o>this.bufferSize&&(this.remains=o-this.bufferSize,o=this.bufferSize)));q=this.samplesLeft;m+q>=o&&(q=o-m);l=e+q;for(a=this.channels[0];a;){if(a.enabled){h=a.sample;d=h.data;if(j=a.oldSample)f=j.data;c=this.buffer[e];for(k=e;k<l;++k){n=a.mute?0:d[a.pointer];n+=(d[a.pointer+
a.dir]-n)*a.fraction;if(1<=(a.fraction+=a.speed))p=a.fraction>>0,a.fraction-=p,0<a.dir?(a.pointer+=p,a.pointer>a.length&&(a.fraction+=a.pointer-a.length,a.pointer=a.length)):(a.pointer-=p,a.pointer<a.length&&(a.fraction+=a.length-a.pointer,a.pointer=a.length));if(a.mixCounter){if(j){i=a.mute?0:f[a.oldPointer];i+=(f[a.oldPointer+a.oldDir]-i)*a.oldFraction;if(1<(a.oldFraction+=a.oldSpeed))p=a.oldFraction>>0,a.oldFraction-=p,0<a.oldDir?(a.oldPointer+=p,a.oldPointer>a.oldLength&&(a.oldFraction+=a.oldPointer-
a.oldLength,a.oldPointer=a.oldLength)):(a.oldPointer-=p,a.oldPointer<a.oldLength&&(a.oldFraction+=a.oldLength-a.oldPointer,a.oldPointer=a.oldLength));c.l+=n*a.lmixRampU+i*a.lmixRampD;c.r+=n*a.rmixRampU+i*a.rmixRampD;a.lmixRampD-=a.lmixDeltaD;a.rmixRampD-=a.rmixDeltaD}else c.l+=n*a.lmixRampU,c.r+=n*a.rmixRampU;a.lmixRampU+=a.lmixDeltaU;a.rmixRampU+=a.rmixDeltaU;a.mixCounter--;a.oldPointer==a.oldLength&&(j.loopMode?1==j.loopMode?(a.oldPointer=j.loopStart,a.oldLength=j.length):0<a.oldDir?(a.oldPointer=
j.length-1,a.oldLength=j.loopStart,a.oldDir=-1):(a.oldFraction-=1,a.oldPointer=j.loopStart,a.oldLength=j.length,a.oldDir=1):(j=null,a.oldPointer=0))}else c.l+=n*a.lvol,c.r+=n*a.rvol,a.volCounter?(a.lvol+=a.lvolDelta,a.rvol+=a.rvolDelta,a.volCounter--):a.panCounter&&(a.lpan+=a.lpanDelta,a.rpan+=a.rpanDelta,a.panCounter--,a.lvol=a.volume*a.lpan,a.rvol=a.volume*a.rpan);if(a.pointer==a.length)if(h.loopMode)1==h.loopMode?(a.pointer=h.loopStart,a.length=h.length):0<a.dir?(a.pointer=h.length-1,a.length=
h.loopStart,a.dir=-1):(a.fraction-=1,a.pointer=h.loopStart,a.length=h.length,a.dir=1);else{a.enabled=0;break}c=c.next}}a=a.next}e=l;m+=q;this.samplesLeft-=q}c=this.buffer[0];a=b.outputBuffer.getChannelData(0);b=b.outputBuffer.getChannelData(1);for(k=0;k<o;++k)1<c.l?c.l=1:-1>c.l&&(c.l=-1),1<c.r?c.r=1:-1>c.r&&(c.r=-1),a[k]=c.l,b[k]=c.r,c.l=c.r=0,c=c.next}}});d.bufferSize=8192;return Object.seal(d)}function SBPlayer(d){var b=CorePlayer();Object.defineProperties(b,{track:{value:null,writable:!0},length:{value:0,writable:!0},restart:{value:0,writable:!0},timer:{value:0,writable:!0},master:{value:0,writable:!0},volume:{set:function(a){0>a?a=0:1<a&&(a=1);this.master=64*a}},setup:{configurable:!1,value:function(){this.mixer.setup(this.channels)}}});b.mixer=d||Soundblaster();b.mixer.player=b;b.endian=1;b.quality=1;return b};/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.1 - 2012/04/16

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){var d="Unknown Format,Ultimate SoundTracker,D.O.C. SoundTracker 9,Master SoundTracker,D.O.C. SoundTracker 2.0/2.2,SoundTracker 2.3,SoundTracker 2.4,NoiseTracker 1.0,NoiseTracker 1.1,NoiseTracker 2.0,ProTracker 1.0,ProTracker 1.1/2.1,ProTracker 1.2/2.0,His Master's NoiseTracker,SoundFX 1.0/1.7,SoundFX 1.8,SoundFX 1.945,SoundFX 1.994/2.0,BP SoundMon V1,BP SoundMon V2,BP SoundMon V3,Delta Music 1.0,Delta Music 2.0,Digital Mugician,Digital Mugician 7 Voices,Future Composer 1.0/1.3,Future Composer 1.4,SidMon 1.0,SidMon 2.0,David Whittaker,FredEd,Jochen Hippel,Jochen Hippel COSO,Rob Hubbard,FastTracker II,Sk@leTracker,MadTracker 2.0,MilkyTracker,DigiBooster Pro 2.18,OpenMPT".split(",");
window.neoart.FileLoader=function(){var e=Object.create(null,{player:{value:null,writable:!0},index:{value:0,writable:!0},amiga:{value:null,writable:!0},mixer:{value:null,writable:!0},tracker:{get:function(){return this.player?d[this.index+this.player.version]:d[0]}},load:{value:function(a){var b,c;a.view||(a=ByteArray(a));a.endian=1;a.position=0;if(67324752==a.readUint())if(window.neoart.Unzip)a=ZipFile(a),a=a.uncompress(a.entries[0]);else throw"Unzip support is not available.";if(!a)return null;
if(this.player&&"STPlayer"!=this.player.id&&(this.player.load(a),this.player.version))return this.player;if(336<a.length&&(a.position=38,b=a.readString(20),"FastTracker v2.00   "==b||"FastTracker v 2.00  "==b||"Sk@le Tracker"==b||"MadTracker 2.0"==b||"MilkyTracker        "==b||"DigiBooster Pro 2.18"==b||-1!=b.indexOf("OpenMPT")))if(this.player=window.neoart.F2Player(this.mixer),this.player.load(a),this.player.version)return this.index=33,this.player;a.endian=0;if(2105<a.length)if(a.position=1080,b=a.readString(4),
"M.K."==b||"FLT4"==b){if(this.player=window.neoart.MKPlayer(this.amiga),this.player.load(a),this.player.version)return this.index=4,this.player}else if("FEST"==b&&(this.player=window.neoart.HMPlayer(this.amiga),this.player.load(a),this.player.version))return this.index=12,this.player;if(2105<a.length&&(a.position=1080,b=a.readString(4),"M.K."==b||"M!K!"==b))if(this.player=window.neoart.PTPlayer(this.amiga),this.player.load(a),this.player.version)return this.index=9,this.player;if(1685<a.length&&(a.position=
60,b=a.readString(4),"SONG"!=b&&(a.position=124,b=a.readString(4)),"SONG"==b||"SO31"==b))if(this.player=window.neoart.FXPlayer(this.amiga),this.player.load(a),this.player.version)return this.index=13,this.player;if(4<a.length&&(a.position=0,b=a.readString(4),"ALL "==b&&(this.player=window.neoart.D1Player(this.amiga),this.player.load(a),this.player.version))||3018<a.length&&(a.position=3014,b=a.readString(4),".FNL"==b&&(this.player=window.neoart.D2Player(this.amiga),this.player.load(a),this.player.version)))return this.index=
20,this.player;if(30<a.length&&(a.position=26,b=a.readString(3),"BPS"==b||"V.2"==b||"V.3"==b))if(this.player=window.neoart.BPPlayer(this.amiga),this.player.load(a),this.player.version)return this.index=17,this.player;if(4<a.length&&(a.position=0,b=a.readString(4),"SMOD"==b||"FC14"==b))if(this.player=window.neoart.FCPlayer(this.amiga),this.player.load(a),this.player.version)return this.index=24,this.player;if(10<a.length&&(a.position=0,b=a.readString(9)," MUGICIAN"==b&&(this.player=window.neoart.DMPlayer(this.amiga),
this.player.load(a),this.player.version)))return this.index=22,this.player;if(86<a.length&&(a.position=58,b=a.readString(28),"SIDMON II - THE MIDI VERSION"==b&&(this.player=window.neoart.S2Player(this.amiga),this.player.load(a),this.player.version)))return this.index=26,this.player;if(2830<a.length&&(a.position=0,c=a.readUshort(),20218==c&&(this.player=window.neoart.FEPlayer(this.amiga),this.player.load(a),this.player.version)))return this.index=29,this.player;if(5220<a.length&&(this.player=window.neoart.S1Player(this.amiga),
this.player.load(a),this.player.version))return this.index=26,this.player;a.position=0;c=a.readUshort();a.position=0;b=a.readString(4);if("COSO"==b||24576==c||24578==c||24590==c||24598==c)if(this.player=window.neoart.JHPlayer(this.amiga),this.player.load(a),this.player.version)return this.index=30,this.player;a.position=0;a.readUshort();this.player=window.neoart.DWPlayer(this.amiga);this.player.load(a);if(this.player.version)return this.index=28,this.player;a.position=0;c=a.readUshort();if(24576==
c&&(this.player=window.neoart.RHPlayer(this.amiga),this.player.load(a),this.player.version))return this.index=32,this.player;if(1625<a.length&&(this.player=window.neoart.STPlayer(this.amiga),this.player.load(a),this.player.version))return this.index=0,this.player;a.clear();this.index=0;return this.player=null}}});e.amiga=Amiga();return Object.seal(e)}()})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.0 - 2012/03/11

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function j(i){return Object.create(null,{index:{value:i,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},enabled:{value:0,writable:!0},restart:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},sample:{value:0,writable:!0},samplePtr:{value:0,writable:!0},sampleLen:{value:0,writable:!0},synth:{value:0,writable:!0},synthPtr:{value:0,writable:!0},arpeggio:{value:0,writable:!0},autoArpeggio:{value:0,writable:!0},autoSlide:{value:0,writable:!0},
vibrato:{value:0,writable:!0},volume:{value:0,writable:!0},volumeDef:{value:0,writable:!0},adsrControl:{value:0,writable:!0},adsrPtr:{value:0,writable:!0},adsrCtr:{value:0,writable:!0},lfoControl:{value:0,writable:!0},lfoPtr:{value:0,writable:!0},lfoCtr:{value:0,writable:!0},egControl:{value:0,writable:!0},egPtr:{value:0,writable:!0},egCtr:{value:0,writable:!0},egValue:{value:0,writable:!0},fxControl:{value:0,writable:!0},fxCtr:{value:0,writable:!0},modControl:{value:0,writable:!0},modPtr:{value:0,
writable:!0},modCtr:{value:0,writable:!0},initialize:{value:function(){this.channel=null;this.samplePtr=this.sample=this.period=this.note=this.restart=this.enabled=0;this.sampleLen=2;this.synth=0;this.synthPtr=-1;this.modCtr=this.modPtr=this.modControl=this.fxCtr=this.fxControl=this.egValue=this.egCtr=this.egPtr=this.egControl=this.lfoCtr=this.lfoPtr=this.lfoControl=this.adsrCtr=this.adsrPtr=this.adsrControl=this.volumeDef=this.volume=this.vibrato=this.autoSlide=this.autoArpeggio=this.arpeggio=0}}})}
var k=[6848,6464,6080,5760,5440,5120,4832,4576,4320,4064,3840,3616,3424,3232,3040,2880,2720,2560,2416,2288,2160,2032,1920,1808,1712,1616,1520,1440,1360,1280,1208,1144,1080,1016,960,904,856,808,760,720,680,640,604,572,540,508,480,452,428,404,380,360,340,320,302,286,270,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,107,101,95,90,85,80,76,72,68,64,60,57],l=[0,64,128,64,0,-64,-128,-64];window.neoart.BPPlayer=function(i){i=AmigaPlayer(i);Object.defineProperties(i,{id:{value:"BPPlayer"},tracks:{value:[],
writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},buffer:{value:null,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},nextPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},repeatCtr:{value:0,writable:!0},arpeggioCtr:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},initialize:{value:function(){var c,d=this.voices[0];this.reset();this.speed=6;this.tick=1;this.repeatCtr=this.jumpFlag=
this.nextPos=this.patternPos=this.trackPos=0;this.arpeggioCtr=1;for(c=this.vibratoPos=0;128>c;++c)this.buffer[c]=0;for(;d;)d.initialize(),d.channel=this.mixer.channels[d.index],d.samplePtr=this.mixer.loopPtr,d=d.next}},restore:{value:function(){for(var c,d,e,b=this.voices[0];b;){if(-1<b.synthPtr){e=b.index<<5;d=b.synthPtr+32;for(c=b.synthPtr;c<d;++c)this.mixer.memory[c]=this.buffer[e++]}b=b.next}}},loader:{value:function(c){var d=0,e=0,b,g,f;this.title=c.readString(26);b=c.readString(4);if("BPSM"==
b)this.version=1;else{b=b.substr(0,3);if("V.2"==b)this.version=2;else if("V.3"==b)this.version=3;else return;c.position=29;f=c.readUbyte()}for(this.length=c.readUshort();16>++e;)b=AmigaSample(),Object.defineProperties(b,{synth:{value:0,writable:!0},table:{value:0,writable:!0},adsrControl:{value:0,writable:!0},adsrTable:{value:0,writable:!0},adsrLen:{value:0,writable:!0},adsrSpeed:{value:0,writable:!0},lfoControl:{value:0,writable:!0},lfoTable:{value:0,writable:!0},lfoDepth:{value:0,writable:!0},lfoLen:{value:0,
writable:!0},lfoDelay:{value:0,writable:!0},lfoSpeed:{value:0,writable:!0},egControl:{value:0,writable:!0},egTable:{value:0,writable:!0},egLen:{value:0,writable:!0},egDelay:{value:0,writable:!0},egSpeed:{value:0,writable:!0},fxControl:{value:0,writable:!0},fxDelay:{value:0,writable:!0},fxSpeed:{value:0,writable:!0},modControl:{value:0,writable:!0},modTable:{value:0,writable:!0},modLen:{value:0,writable:!0},modDelay:{value:0,writable:!0},modSpeed:{value:0,writable:!0}}),b=Object.seal(b),255==c.readUbyte()?
(b.synth=1,b.table=c.readUbyte(),b.pointer=b.table<<6,b.length=c.readUshort()<<1,b.adsrControl=c.readUbyte(),b.adsrTable=c.readUbyte()<<6,b.adsrLen=c.readUshort(),b.adsrSpeed=c.readUbyte(),b.lfoControl=c.readUbyte(),b.lfoTable=c.readUbyte()<<6,b.lfoDepth=c.readUbyte(),b.lfoLen=c.readUshort(),3>this.version?(c.readByte(),b.lfoDelay=c.readUbyte(),b.lfoSpeed=c.readUbyte(),b.egControl=c.readUbyte(),b.egTable=c.readUbyte()<<6,c.readByte(),b.egLen=c.readUshort(),c.readByte(),b.egDelay=c.readUbyte(),b.egSpeed=
c.readUbyte(),b.fxSpeed=1,b.modSpeed=1,b.volume=c.readUbyte(),c.position+=6):(b.lfoDelay=c.readUbyte(),b.lfoSpeed=c.readUbyte(),b.egControl=c.readUbyte(),b.egTable=c.readUbyte()<<6,b.egLen=c.readUshort(),b.egDelay=c.readUbyte(),b.egSpeed=c.readUbyte(),b.fxControl=c.readUbyte(),b.fxSpeed=c.readUbyte(),b.fxDelay=c.readUbyte(),b.modControl=c.readUbyte(),b.modTable=c.readUbyte()<<6,b.modSpeed=c.readUbyte(),b.modDelay=c.readUbyte(),b.volume=c.readUbyte(),b.modLen=c.readUshort())):(c.position--,b.synth=
0,b.name=c.readString(24),b.length=c.readUshort()<<1,b.length?(b.loop=c.readUshort(),b.repeat=c.readUshort()<<1,b.volume=c.readUshort(),b.loop+b.repeat>=b.length&&(b.repeat=b.length-b.loop)):(b.pointer--,b.repeat=2,c.position+=6)),this.samples[e]=b;b=this.length<<2;this.tracks.length=b;for(e=0;e<b;++e)g=AmigaStep(),Object.defineProperties(g,{soundTranspose:{value:0,writable:!0}}),g=Object.seal(g),g.pattern=c.readUshort(),g.soundTranspose=c.readByte(),g.transpose=c.readByte(),g.pattern>d&&(d=g.pattern),
this.tracks[e]=g;b=d<<4;this.patterns.length=b;for(e=0;e<b;++e)d=AmigaRow(),d.note=c.readByte(),d.sample=c.readUbyte(),d.effect=d.sample&15,d.sample=(d.sample&240)>>4,d.param=c.readByte(),this.patterns[e]=d;this.mixer.store(c,f<<6);for(e=0;16>++e;)b=this.samples[e],!b.synth&&b.length&&(b.pointer=this.mixer.store(c,b.length),b.loopPtr=b.pointer+b.loop)}},process:{value:function(){var c,d,e,b,g,f=this.mixer.memory,h,a=this.voices[0];this.arpeggioCtr=--this.arpeggioCtr&3;for(this.vibratoPos=++this.vibratoPos&
7;a;){c=a.channel;a.period+=a.autoSlide;c.period=a.vibrato?a.period+(l[this.vibratoPos]/a.vibrato>>0):a.period;c.pointer=a.samplePtr;c.length=a.sampleLen;if(a.arpeggio||a.autoArpeggio)b=a.note,this.arpeggioCtr?1==this.arpeggioCtr&&(b+=(a.arpeggio&15)+(a.autoArpeggio&15)):b+=((a.arpeggio&240)>>4)+((a.autoArpeggio&240)>>4),c.period=a.period=k[b+35],a.restart=0;if(a.synth&&!(0>a.sample)&&(b=this.samples[a.sample],a.adsrControl&&0==--a.adsrCtr&&(a.adsrCtr=b.adsrSpeed,d=128+f[b.adsrTable+a.adsrPtr]>>2,
c.volume=d*a.volume>>6,++a.adsrPtr==b.adsrLen&&(a.adsrPtr=0,1==a.adsrControl&&(a.adsrControl=0))),a.lfoControl&&0==--a.lfoCtr&&(a.lfoCtr=b.lfoSpeed,d=f[b.lfoTable+a.lfoPtr],b.lfoDepth&&(d=d/b.lfoDepth>>0),c.period=a.period+d,++a.lfoPtr==b.lfoLen&&(a.lfoPtr=0,1==a.lfoControl&&(a.lfoControl=0))),!(0>a.synthPtr))){if(a.egControl&&0==--a.egCtr){a.egCtr=b.egSpeed;d=a.egValue;a.egValue=128+f[b.egTable+a.egPtr]>>3;if(a.egValue!=d)if(h=(a.index<<5)+d,e=a.synthPtr+d,a.egValue<d){d-=a.egValue;for(g=e-d;e>g;)f[--e]=
this.buffer[--h]}else{d=a.egValue-d;for(g=e+d;e<g;)f[e++]=~this.buffer[h++]+1}++a.egPtr==b.egLen&&(a.egPtr=0,1==a.egControl&&(a.egControl=0))}switch(a.fxControl){case 1:if(0==--a.fxCtr){a.fxCtr=b.fxSpeed;e=a.synthPtr;g=a.synthPtr+32;for(d=0<e?f[e-1]:0;e<g;)d=d+f[e+1]>>1,f[e++]=d}break;case 2:h=(a.index<<5)+31;g=a.synthPtr+32;d=b.fxSpeed;for(e=a.synthPtr;e<g;++e)this.buffer[h]<f[e]?f[e]-=d:this.buffer[h]>f[e]&&(f[e]+=d),h--;break;case 3:case 5:h=a.index<<5;g=a.synthPtr+32;d=b.fxSpeed;for(e=a.synthPtr;e<
g;++e)this.buffer[h]<f[e]?f[e]-=d:this.buffer[h]>f[e]&&(f[e]+=d),h++;break;case 4:h=a.synthPtr+64;g=a.synthPtr+32;d=b.fxSpeed;for(e=a.synthPtr;e<g;++e)f[h]<f[e]?f[e]-=d:f[h]>f[e]&&(f[e]+=d),h++;break;case 6:if(0==--a.fxCtr){a.fxControl=0;a.fxCtr=1;h=a.synthPtr+64;g=a.synthPtr+32;for(e=a.synthPtr;e<g;++e)f[e]=f[h++]}}a.modControl&&0==--a.modCtr&&(a.modCtr=b.modSpeed,f[a.synthPtr+32]=f[b.modTable+a.modPtr],++a.modPtr==b.modLen&&(a.modPtr=0,1==a.modControl&&(a.modControl=0)))}a=a.next}if(0==--this.tick){this.tick=
this.speed;for(a=this.voices[0];a;){c=a.channel;a.enabled=0;g=this.tracks[(this.trackPos<<2)+a.index];h=this.patterns[this.patternPos+(g.pattern-1<<4)];b=h.note;e=h.effect;d=h.param;if(b){a.autoArpeggio=a.autoSlide=a.vibrato=0;if(10!=e||0==(d&240))b+=g.transpose;a.note=b;a.period=k[b+35];a.restart=13>e?a.volumeDef=1:0;b=h.sample;0==b&&(b=a.sample);if(10!=e||0==(d&15))b+=g.soundTranspose;if(13>e&&(!a.synth||a.sample!=b))a.sample=b,a.enabled=1}switch(e){case 0:a.arpeggio=d;break;case 1:a.volume=d;a.volumeDef=
0;if(3>this.version||!a.synth)c.volume=a.volume;break;case 2:this.tick=this.speed=d;break;case 3:this.mixer.filter.active=d;break;case 4:a.period-=d;a.arpeggio=0;break;case 5:a.period+=d;a.arpeggio=0;break;case 6:3==this.version?a.vibrato=d:this.repeatCtr=d;break;case 7:3==this.version?(this.nextPos=d,this.jumpFlag=1):0==this.repeatCtr&&(this.trackPos=d);break;case 8:a.autoSlide=d;break;case 9:a.autoArpeggio=d;3==this.version&&(a.adsrPtr=0,0==a.adsrControl&&(a.adsrControl=1));break;case 11:a.fxControl=
d;break;case 13:a.autoArpeggio=d;a.fxControl^=1;a.adsrPtr=0;0==a.adsrControl&&(a.adsrControl=1);break;case 14:a.autoArpeggio=d;a.adsrPtr=0;0==a.adsrControl&&(a.adsrControl=1);break;case 15:a.autoArpeggio=d}a=a.next}this.jumpFlag?(this.trackPos=this.nextPos,this.patternPos=this.jumpFlag=0):16==++this.patternPos&&(this.patternPos=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1));for(a=this.voices[0];a;){c=a.channel;a.enabled&&(c.enabled=a.enabled=0);if(0!=a.restart&&-1<a.synthPtr){h=
a.index<<5;g=a.synthPtr+32;for(e=a.synthPtr;e<g;++e)f[e]=this.buffer[h++];a.synthPtr=-1}a=a.next}for(a=this.voices[0];a;){if(!(0==a.restart||0>a.sample)){c=a.channel;c.period=a.period;a.restart=0;b=this.samples[a.sample];if(b.synth){if(a.synth=1,a.egValue=0,a.adsrPtr=a.lfoPtr=a.egPtr=a.modPtr=0,a.adsrCtr=1,a.lfoCtr=b.lfoDelay+1,a.egCtr=b.egDelay+1,a.fxCtr=b.fxDelay+1,a.modCtr=b.modDelay+1,a.adsrControl=b.adsrControl,a.lfoControl=b.lfoControl,a.egControl=b.egControl,a.fxControl=b.fxControl,a.modControl=
b.modControl,c.pointer=a.samplePtr=b.pointer,c.length=a.sampleLen=b.length,a.adsrControl?(d=128+f[b.adsrTable]>>2,a.volumeDef&&(a.volume=b.volume,a.volumeDef=0),c.volume=d*a.volume>>6):c.volume=a.volumeDef?b.volume:a.volume,a.egControl||a.fxControl||a.modControl){a.synthPtr=b.pointer;e=a.index<<5;g=a.synthPtr+32;for(h=a.synthPtr;h<g;++h)this.buffer[e++]=f[h]}}else a.synth=a.lfoControl=0,0>b.pointer?(a.samplePtr=this.mixer.loopPtr,a.sampleLen=2):(c.pointer=b.pointer,c.volume=a.volumeDef?b.volume:a.volume,
2!=b.repeat?(a.samplePtr=b.loopPtr,c.length=a.sampleLen=b.repeat):(a.samplePtr=this.mixer.loopPtr,a.sampleLen=2,c.length=b.length));c.enabled=a.enabled=1}a=a.next}}}}});i.voices[0]=j(0);i.voices[0].next=i.voices[1]=j(1);i.voices[1].next=i.voices[2]=j(2);i.voices[2].next=i.voices[3]=j(3);i.buffer=new Int8Array(128);return Object.seal(i)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.0 - 2012/03/30

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function h(f){return Object.create(null,{index:{value:f,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},status:{value:0,writable:!0},speed:{value:0,writable:!0},step:{value:null,writable:!0},row:{value:null,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},arpeggioPos:{value:0,writable:!0},pitchBend:{value:0,writable:!0},tableCtr:{value:0,writable:!0},
tablePos:{value:0,writable:!0},vibratoCtr:{value:0,writable:!0},vibratoDir:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoPeriod:{value:0,writable:!0},volume:{value:0,writable:!0},attackCtr:{value:0,writable:!0},decayCtr:{value:0,writable:!0},releaseCtr:{value:0,writable:!0},sustain:{value:0,writable:!0},initialize:{value:function(){this.sample=null;this.status=this.patternPos=this.trackPos=0;this.speed=1;this.row=this.step=null;this.releaseCtr=this.decayCtr=this.attackCtr=this.volume=
this.vibratoPeriod=this.vibratoPos=this.vibratoDir=this.vibratoCtr=this.tablePos=this.tableCtr=this.pitchBend=this.arpeggioPos=this.period=this.note=0;this.sustain=1}}})}function i(){var f=AmigaSample();Object.defineProperties(f,{synth:{value:0,writable:!0},attackStep:{value:0,writable:!0},attackDelay:{value:0,writable:!0},decayStep:{value:0,writable:!0},decayDelay:{value:0,writable:!0},releaseStep:{value:0,writable:!0},releaseDelay:{value:0,writable:!0},sustain:{value:0,writable:!0},arpeggio:{value:null,
writable:!0},pitchBend:{value:0,writable:!0},portamento:{value:0,writable:!0},table:{value:null,writable:!0},tableDelay:{value:0,writable:!0},vibratoWait:{value:0,writable:!0},vibratoStep:{value:0,writable:!0},vibratoLen:{value:0,writable:!0}});f.arpeggio=new Int8Array(8);f.table=new Int8Array(48);return Object.seal(f)}var j=[0,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,960,904,
856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113];window.neoart.D1Player=function(f){f=AmigaPlayer(f);Object.defineProperties(f,{id:{value:"D1Player"},pointers:{value:null,writable:!0},tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},voices:{value:[],writable:!0},initialize:{value:function(){var d=this.voices[0];
this.reset();for(this.speed=6;d;)d.initialize(),d.channel=this.mixer.channels[d.index],d.sample=this.samples[20],d=d.next}},loader:{value:function(d){var g,b=0,c,a=0,f,e,h;if("ALL "==d.readString(4)){for(g=new Uint32Array(25);25>b;++b)g[b]=d.readUint();this.pointers=new Uint32Array(4);for(b=1;4>b;++b)this.pointers[b]=this.pointers[a]+(g[a++]>>1)-1;f=this.pointers[3]+(g[3]>>1)-1;this.tracks.length=f;c=104+g[1]-2;d.position=104;a=1;for(b=0;b<f;++b)e=AmigaStep(),h=d.readUshort(),65535==h||d.position==
c?(e.pattern=-1,e.transpose=d.readUshort(),c+=g[a++]):(d.position--,e.pattern=(h>>2&16320)>>2,e.transpose=d.readByte()),this.tracks[b]=e;f=g[4]>>2;this.patterns.length=f;for(b=0;b<f;++b)c=AmigaRow(),c.sample=d.readUbyte(),c.note=d.readUbyte(),c.effect=d.readUbyte()&31,c.param=d.readUbyte(),this.patterns[b]=c;c=5;for(b=0;20>b;++b){this.samples[b]=null;if(0!=g[c]){e=i();e.attackStep=d.readUbyte();e.attackDelay=d.readUbyte();e.decayStep=d.readUbyte();e.decayDelay=d.readUbyte();e.sustain=d.readUshort();
e.releaseStep=d.readUbyte();e.releaseDelay=d.readUbyte();e.volume=d.readUbyte();e.vibratoWait=d.readUbyte();e.vibratoStep=d.readUbyte();e.vibratoLen=d.readUbyte();e.pitchBend=d.readByte();e.portamento=d.readUbyte();e.synth=d.readUbyte();e.tableDelay=d.readUbyte();for(a=0;8>a;++a)e.arpeggio[a]=d.readByte();e.length=d.readUshort();e.loop=d.readUshort();e.repeat=d.readUshort()<<1;e.synth=e.synth?0:1;if(e.synth){for(a=0;48>a;++a)e.table[a]=d.readByte();f=g[c]-78}else f=e.length;e.pointer=this.mixer.store(d,
f);e.loopPtr=e.pointer+e.loop;this.samples[b]=e}c++}e=i();e.pointer=e.loopPtr=this.mixer.memory.length;e.length=e.repeat=2;this.samples[20]=e;this.version=1}}},process:{value:function(){for(var d,f,b,c,a=this.voices[0];a;){f=a.channel;if(0==--a.speed&&(a.speed=this.speed,0==a.patternPos&&(a.step=this.tracks[this.pointers[a.index]+a.trackPos],0>a.step.pattern&&(a.trackPos=a.step.transpose,a.step=this.tracks[this.pointers[a.index]+a.trackPos]),a.trackPos++),b=this.patterns[a.step.pattern+a.patternPos],
b.effect&&(a.row=b),b.note&&(f.enabled=0,a.row=b,a.note=b.note+a.step.transpose,a.arpeggioPos=a.pitchBend=a.status=0,c=a.sample=this.samples[b.sample],c.synth||(f.pointer=c.pointer),f.length=c.length,a.tableCtr=a.tablePos=0,a.vibratoCtr=c.vibratoWait,a.vibratoPos=c.vibratoLen,a.vibratoDir=c.vibratoLen<<1,a.volume=a.attackCtr=a.decayCtr=a.releaseCtr=0,a.sustain=c.sustain),16==++a.patternPos))a.patternPos=0;c=a.sample;if(c.synth)if(0==a.tableCtr){a.tableCtr=c.tableDelay;do(d=1,48<=a.tablePos&&(a.tablePos=
0),b=c.table[a.tablePos],a.tablePos++,0<=b)?(f.pointer=c.pointer+(b<<5),d=0):-1!=b?c.tableDelay=b&127:a.tablePos=c.table[a.tablePos];while(d)}else a.tableCtr--;c.portamento&&(b=j[a.note]+a.pitchBend,0!=a.period?a.period<b?(a.period+=c.portamento,a.period>b&&(a.period=b)):(a.period-=c.portamento,a.period<b&&(a.period=b)):a.period=b);0==a.vibratoCtr?(a.vibratoPeriod=a.vibratoPos*c.vibratoStep,0==(a.status&1)?(a.vibratoPos++,a.vibratoPos==a.vibratoDir&&(a.status^=1)):(a.vibratoPos--,0==a.vibratoPos&&
(a.status^=1))):a.vibratoCtr--;a.pitchBend=0>c.pitchBend?a.pitchBend+c.pitchBend:a.pitchBend-c.pitchBend;if(a.row)switch(b=a.row,b.effect){case 1:if(b=b.param&15)this.speed=b;break;case 2:a.pitchBend-=b.param;break;case 3:a.pitchBend+=b.param;break;case 4:this.mixer.filter.active=b.param;break;case 5:c.vibratoWait=b.param;break;case 6:c.vibratoStep=b.param;case 7:c.vibratoLen=b.param;break;case 8:c.pitchBend=b.param;break;case 9:c.portamento=b.param;break;case 10:c.volume=64;break;case 11:c.arpeggio[0]=
b.param;break;case 12:c.arpeggio[1]=b.param;break;case 13:c.arpeggio[2]=b.param;break;case 14:c.arpeggio[3]=b.param;break;case 15:c.arpeggio[4]=b.param;break;case 16:c.arpeggio[5]=b.param;break;case 17:c.arpeggio[6]=b.param;break;case 18:c.arpeggio[7]=b.param;break;case 19:c.arpeggio[0]=c.arpeggio[4]=b.param;break;case 20:c.arpeggio[1]=c.arpeggio[5]=b.param;break;case 21:c.arpeggio[2]=c.arpeggio[6]=b.param;break;case 22:c.arpeggio[3]=c.arpeggio[7]=b.param;break;case 23:b=b.param;64<b&&(b=64);c.attackStep=
b;break;case 24:c.attackDelay=b.param;break;case 25:b=b.param;64<b&&(b=64);c.decayStep=b;break;case 26:c.decayDelay=b.param;break;case 27:c.sustain=b.param&c.sustain&255;break;case 28:c.sustain=(c.sustain&65280)+b.param;break;case 29:b=b.param;64<b&&(b=64);c.releaseStep=b;break;case 30:c.releaseDelay=b.param}c.portamento?b=a.period:(b=j[a.note+c.arpeggio[a.arpeggioPos]],a.arpeggioPos=++a.arpeggioPos&7,b-=c.vibratoLen*c.vibratoStep,b+=a.pitchBend,a.period=0);f.period=b+a.vibratoPeriod;d=a.status&14;
b=a.volume;0==d&&(0==a.attackCtr?(a.attackCtr=c.attackDelay,b+=c.attackStep,64<=b&&(d|=2,a.status|=2,b=64)):a.attackCtr--);2==d&&(0==a.decayCtr?(a.decayCtr=c.decayDelay,b-=c.decayStep,b<=c.volume&&(d|=6,a.status|=6,b=c.volume)):a.decayCtr--);6==d&&(0==a.sustain?(d|=14,a.status|=14):a.sustain--);14==d&&(0==a.releaseCtr?(a.releaseCtr=c.releaseDelay,b-=c.releaseStep,0>b&&(a.status&=9,b=0)):a.releaseCtr--);f.volume=a.volume=b;f.enabled=1;c.synth||(c.loop?(f.pointer=c.loopPtr,f.length=c.repeat):(f.pointer=
this.mixer.loopPtr,f.length=2));a=a.next}}}});f.voices[0]=h(0);f.voices[0].next=f.voices[1]=h(1);f.voices[1].next=f.voices[2]=h(2);f.voices[2].next=f.voices[3]=h(3);return Object.seal(f)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.0 - 2012/03/30

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function h(g){return Object.create(null,{index:{value:g,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},trackPtr:{value:0,writable:!0},trackPos:{value:0,writable:!0},trackLen:{value:0,writable:!0},patternPos:{value:0,writable:!0},restart:{value:0,writable:!0},step:{value:null,writable:!0},row:{value:null,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},finalPeriod:{value:0,writable:!0},arpeggioPtr:{value:0,
writable:!0},arpeggioPos:{value:0,writable:!0},pitchBend:{value:0,writable:!0},portamento:{value:0,writable:!0},tableCtr:{value:0,writable:!0},tablePos:{value:0,writable:!0},vibratoCtr:{value:0,writable:!0},vibratoDir:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoPeriod:{value:0,writable:!0},vibratoSustain:{value:0,writable:!0},volume:{value:0,writable:!0},volumeMax:{value:0,writable:!0},volumePos:{value:0,writable:!0},volumeSustain:{value:0,writable:!0},initialize:{value:function(){this.sample=
null;this.restart=this.patternPos=this.trackLen=this.trackPos=this.trackPtr=0;this.row=this.step=null;this.volume=this.vibratoSustain=this.vibratoPeriod=this.vibratoPos=this.vibratoDir=this.vibratoCtr=this.tablePos=this.tableCtr=this.portamento=this.pitchBend=this.arpeggioPos=this.arpeggioPtr=this.finalPeriod=this.period=this.note=0;this.volumeMax=63;this.volumeSustain=this.volumePos=0}}})}function i(){var g=AmigaSample();Object.defineProperties(g,{index:{value:0,writable:!0},pitchBend:{value:0,writable:!0},
synth:{value:0,writable:!0},table:{value:null,writable:!0},vibratos:{value:null,writable:!0},volumes:{value:null,writable:!0}});g.table=new Uint8Array(48);g.vibratos=new Uint8Array(15);g.volumes=new Uint8Array(15);return Object.seal(g)}var j=[0,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,
269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113];window.neoart.D2Player=function(g){g=AmigaPlayer(g);Object.defineProperties(g,{id:{value:"D2Player"},tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},data:{value:null,writable:!0},arpeggios:{value:null,writable:!0},voices:{value:[],writable:!0},noise:{value:0,writable:!0},initialize:{value:function(){var c=this.voices[0];this.reset();this.speed=
5;this.tick=1;for(this.noise=0;c;)c.initialize(),c.channel=this.mixer.channels[c.index],c.sample=this.samples[this.samples.length-1],c.trackPtr=this.data[c.index],c.restart=this.data[c.index+4],c.trackLen=this.data[c.index+8],c=c.next}},loader:{value:function(c){var d=0,b,e=0,a,g,f;c.position=3014;if(".FNL"==c.readString(4)){c.position=4042;for(this.data=new Uint16Array(12);4>d;++d)this.data[d+4]=c.readUshort()>>1,f=c.readUshort()>>1,this.data[d+8]=f,e+=f;f=e;for(d=3;0<d;--d)this.data[d]=f-=this.data[d+
8];this.tracks.length=e;for(d=0;d<e;++d)b=AmigaStep(),b.pattern=c.readUbyte()<<4,b.transpose=c.readByte(),this.tracks[d]=b;e=c.readUint()>>2;this.patterns.length=e;for(d=0;d<e;++d)a=AmigaRow(),a.note=c.readUbyte(),a.sample=c.readUbyte(),a.effect=c.readUbyte()-1,a.param=c.readUbyte(),this.patterns[d]=a;c.position+=254;f=c.readUshort();g=c.position;c.position-=256;e=1;a=new Uint16Array(128);for(d=0;128>d;++d)b=c.readUshort(),b!=f&&(a[e++]=b);this.samples.length=e;for(d=0;d<e;++d){c.position=g+a[d];
f=i();f.length=c.readUshort()<<1;f.loop=c.readUshort();f.repeat=c.readUshort()<<1;for(b=0;15>b;++b)f.volumes[b]=c.readUbyte();for(b=0;15>b;++b)f.vibratos[b]=c.readUbyte();f.pitchBend=c.readUshort();f.synth=c.readByte();f.index=c.readUbyte();for(b=0;48>b;++b)f.table[b]=c.readUbyte();this.samples[d]=f}e=c.readUint();this.mixer.store(c,e);c.position+=64;for(d=0;8>d;++d)a[d]=c.readUint();e=this.samples.length;g=c.position;for(d=0;d<e;++d)f=this.samples[d],0<=f.synth||(c.position=g+a[f.index],f.pointer=
this.mixer.store(c,f.length),f.loopPtr=f.pointer+f.loop);c.position=3018;for(d=0;1024>d;++d)this.arpeggios[d]=c.readByte();f=i();f.pointer=f.loopPtr=this.mixer.memory.length;f.length=f.repeat=2;this.samples[e]=f;e=this.patterns.length;b=this.samples.length-1;for(d=0;d<e;++d)a=this.patterns[d],a.sample>b&&(a.sample=0);this.version=2}}},process:{value:function(){var c;c=0;for(var d,b,e,a=this.voices[0];64>c;)this.noise=this.noise<<7|this.noise>>>25,this.noise+=1858762093,this.noise^=2656676139,b=this.noise>>>
24&255,127<b&&(b|=-256),this.mixer.memory[c++]=b,b=this.noise>>>16&255,127<b&&(b|=-256),this.mixer.memory[c++]=b,b=this.noise>>>8&255,127<b&&(b|=-256),this.mixer.memory[c++]=b,b=this.noise&255,127<b&&(b|=-256),this.mixer.memory[c++]=b;0>--this.tick&&(this.tick=this.speed);for(;a;){if(!(1>a.trackLen)){c=a.channel;e=a.sample;e.synth&&(c.pointer=e.loopPtr,c.length=e.repeat);if(0==this.tick){0==a.patternPos&&(a.step=this.tracks[a.trackPtr+a.trackPos],++a.trackPos==a.trackLen&&(a.trackPos=a.restart));
b=a.row=this.patterns[a.step.pattern+a.patternPos];b.note&&(c.enabled=0,a.note=b.note,a.period=j[b.note+a.step.transpose],e=a.sample=this.samples[b.sample],0>e.synth&&(c.pointer=e.pointer,c.length=e.length),a.arpeggioPos=0,a.tableCtr=0,a.tablePos=0,a.vibratoCtr=e.vibratos[1],a.vibratoPos=0,a.vibratoDir=0,a.vibratoPeriod=0,a.vibratoSustain=e.vibratos[2],a.volume=0,a.volumePos=0,a.volumeSustain=0);switch(b.effect){case 0:this.speed=b.param&15;break;case 1:this.mixer.filter.active=b.param;break;case 2:a.pitchBend=
~(b.param&255)+1;break;case 3:a.pitchBend=b.param&255;break;case 4:a.portamento=b.param;break;case 5:a.volumeMax=b.param&63;break;case 6:this.mixer.volume=b.param;break;case 7:a.arpeggioPtr=(b.param&63)<<4}a.patternPos=++a.patternPos&15}e=a.sample;if(0<=e.synth)if(a.tableCtr)a.tableCtr--;else if(a.tableCtr=e.index,b=e.table[a.tablePos],255==b&&(b=e.table[++a.tablePos],255!=b&&(a.tablePos=b,b=e.table[a.tablePos])),255!=b)c.pointer=b<<8,c.length=e.length,47<++a.tablePos&&(a.tablePos=0);b=e.vibratos[a.vibratoPos];
a.vibratoPeriod=a.vibratoDir?a.vibratoPeriod-b:a.vibratoPeriod+b;0==--a.vibratoCtr&&(a.vibratoCtr=e.vibratos[a.vibratoPos+1],a.vibratoDir=~a.vibratoDir);a.vibratoSustain?a.vibratoSustain--:(a.vibratoPos+=3,15==a.vibratoPos&&(a.vibratoPos=12),a.vibratoSustain=e.vibratos[a.vibratoPos+2]);a.volumeSustain?a.volumeSustain--:(b=e.volumes[a.volumePos],d=e.volumes[a.volumePos+1],d<a.volume?(a.volume-=b,a.volume<d&&(a.volume=d,a.volumePos+=3,a.volumeSustain=e.volumes[a.volumePos-1])):(a.volume+=b,a.volume>
d&&(a.volume=d,a.volumePos+=3,15==a.volumePos&&(a.volumePos=12),a.volumeSustain=e.volumes[a.volumePos-1])));a.portamento&&(a.period<a.finalPeriod?(a.finalPeriod-=a.portamento,a.finalPeriod<a.period&&(a.finalPeriod=a.period)):(a.finalPeriod+=a.portamento,a.finalPeriod>a.period&&(a.finalPeriod=a.period)));b=this.arpeggios[a.arpeggioPtr+a.arpeggioPos];-128==b&&(a.arpeggioPos=0,b=this.arpeggios[a.arpeggioPtr]);a.arpeggioPos=++a.arpeggioPos&15;0==a.portamento&&(b=a.note+a.step.transpose+b,0>b&&(b=0),a.finalPeriod=
j[b]);a.vibratoPeriod-=e.pitchBend-a.pitchBend;c.period=a.finalPeriod+a.vibratoPeriod;b=a.volume>>2&63;b>a.volumeMax&&(b=a.volumeMax);c.volume=b;c.enabled=1}a=a.next}}}});g.voices[0]=h(0);g.voices[0].next=g.voices[1]=h(1);g.voices[1].next=g.voices[2]=h(2);g.voices[2].next=g.voices[3]=h(3);g.arpeggios=new Int8Array(1024);return Object.seal(g)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.0 - 2012/03/13

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function o(){return Object.create(null,{channel:{value:null,writable:!0},sample:{value:null,writable:!0},step:{value:null,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},val1:{value:0,writable:!0},val2:{value:0,writable:!0},finalPeriod:{value:0,writable:!0},arpeggioStep:{value:0,writable:!0},effectCtr:{value:0,writable:!0},pitch:{value:0,writable:!0},pitchCtr:{value:0,writable:!0},pitchStep:{value:0,writable:!0},portamento:{value:0,writable:!0},volume:{value:0,writable:!0},
volumeCtr:{value:0,writable:!0},volumeStep:{value:0,writable:!0},mixMute:{value:0,writable:!0},mixPtr:{value:0,writable:!0},mixEnd:{value:0,writable:!0},mixSpeed:{value:0,writable:!0},mixStep:{value:0,writable:!0},mixVolume:{value:0,writable:!0},initialize:{value:function(){this.step=this.sample=null;this.volumeStep=this.volumeCtr=this.volume=this.portamento=this.pitchStep=this.pitchCtr=this.pitch=this.effectCtr=this.arpeggioStep=this.finalPeriod=this.val2=this.val1=this.period=this.note=0;this.mixMute=
1;this.mixVolume=this.mixStep=this.mixSpeed=this.mixEnd=this.mixPtr=0}}})}var p=[3220,3040,2869,2708,2556,2412,2277,2149,2029,1915,1807,1706,1610,1520,1434,1354,1278,1206,1139,1075,1014,957,904,853,805,760,717,677,639,603,569,537,507,479,452,426,403,380,359,338,319,302,285,269,254,239,226,213,201,190,179,169,160,151,142,134,127,4842,4571,4314,4072,3843,3628,3424,3232,3051,2879,2718,2565,2421,2285,2157,2036,1922,1814,1712,1616,1525,1440,1359,1283,1211,1143,1079,1018,961,907,856,808,763,720,679,641,
605,571,539,509,480,453,428,404,381,360,340,321,303,286,270,254,240,227,214,202,191,180,170,160,151,143,135,127,4860,4587,4330,4087,3857,3641,3437,3244,3062,2890,2728,2574,2430,2294,2165,2043,1929,1820,1718,1622,1531,1445,1364,1287,1215,1147,1082,1022,964,910,859,811,765,722,682,644,607,573,541,511,482,455,430,405,383,361,341,322,304,287,271,255,241,228,215,203,191,181,170,161,152,143,135,128,4878,4604,4345,4102,3871,3654,3449,3255,3073,2900,2737,2584,2439,2302,2173,2051,1936,1827,1724,1628,1536,
1450,1369,1292,1219,1151,1086,1025,968,914,862,814,768,725,684,646,610,575,543,513,484,457,431,407,384,363,342,323,305,288,272,256,242,228,216,203,192,181,171,161,152,144,136,128,4895,4620,4361,4116,3885,3667,3461,3267,3084,2911,2747,2593,2448,2310,2181,2058,1943,1834,1731,1634,1542,1455,1374,1297,1224,1155,1090,1029,971,917,865,817,771,728,687,648,612,578,545,515,486,458,433,408,385,364,343,324,306,289,273,257,243,229,216,204,193,182,172,162,153,144,136,129,4913,4637,4377,4131,3899,3681,3474,3279,
3095,2921,2757,2603,2456,2319,2188,2066,1950,1840,1737,1639,1547,1461,1379,1301,1228,1159,1094,1033,975,920,868,820,774,730,689,651,614,580,547,516,487,460,434,410,387,365,345,325,307,290,274,258,244,230,217,205,193,183,172,163,154,145,137,129,4931,4654,4393,4146,3913,3694,3486,3291,3106,2932,2767,2612,2465,2327,2196,2073,1957,1847,1743,1645,1553,1466,1384,1306,1233,1163,1098,1037,978,923,872,823,777,733,692,653,616,582,549,518,489,462,436,411,388,366,346,326,308,291,275,259,245,231,218,206,194,183,
173,163,154,145,137,130,4948,4671,4409,4161,3928,3707,3499,3303,3117,2942,2777,2621,2474,2335,2204,2081,1964,1854,1750,1651,1559,1471,1389,1311,1237,1168,1102,1040,982,927,875,826,779,736,694,655,619,584,551,520,491,463,437,413,390,368,347,328,309,292,276,260,245,232,219,206,195,184,174,164,155,146,138,130,4966,4688,4425,4176,3942,3721,3512,3315,3129,2953,2787,2631,2483,2344,2212,2088,1971,1860,1756,1657,1564,1477,1394,1315,1242,1172,1106,1044,985,930,878,829,782,738,697,658,621,586,553,522,493,465,
439,414,391,369,348,329,310,293,277,261,246,233,219,207,196,185,174,164,155,146,138,131,4984,4705,4441,4191,3956,3734,3524,3327,3140,2964,2797,2640,2492,2352,2220,2096,1978,1867,1762,1663,1570,1482,1399,1320,1246,1176,1110,1048,989,934,881,832,785,741,699,660,623,588,555,524,495,467,441,416,392,370,350,330,312,294,278,262,247,233,220,208,196,185,175,165,156,147,139,131,5002,4722,4457,4206,3970,3748,3537,3339,3151,2974,2807,2650,2501,2361,2228,2103,1985,1874,1769,1669,1576,1487,1404,1325,1251,1180,
1114,1052,993,937,884,835,788,744,702,662,625,590,557,526,496,468,442,417,394,372,351,331,313,295,279,263,248,234,221,209,197,186,175,166,156,148,139,131,5020,4739,4473,4222,3985,3761,3550,3351,3163,2985,2818,2659,2510,2369,2236,2111,1992,1881,1775,1675,1581,1493,1409,1330,1255,1185,1118,1055,996,940,887,838,791,746,704,665,628,592,559,528,498,470,444,419,395,373,352,332,314,296,280,264,249,235,222,209,198,187,176,166,157,148,140,132,5039,4756,4489,4237,3999,3775,3563,3363,3174,2996,2828,2669,2519,
2378,2244,2118,2E3,1887,1781,1681,1587,1498,1414,1335,1260,1189,1122,1059,1E3,944,891,841,794,749,707,667,630,594,561,530,500,472,445,420,397,374,353,334,315,297,281,265,250,236,223,210,198,187,177,167,157,149,140,132,5057,4773,4505,4252,4014,3788,3576,3375,3186,3007,2838,2679,2528,2387,2253,2126,2007,1894,1788,1688,1593,1503,1419,1339,1264,1193,1126,1063,1003,947,894,844,796,752,710,670,632,597,563,532,502,474,447,422,398,376,355,335,316,298,282,266,251,237,223,211,199,188,177,167,158,149,141,133,
5075,4790,4521,4268,4028,3802,3589,3387,3197,3018,2848,2688,2538,2395,2261,2134,2014,1901,1794,1694,1599,1509,1424,1344,1269,1198,1130,1067,1007,951,897,847,799,754,712,672,634,599,565,533,504,475,449,423,400,377,356,336,317,299,283,267,252,238,224,212,200,189,178,168,159,150,141,133,5093,4808,4538,4283,4043,3816,3602,3399,3209,3029,2859,2698,2547,2404,2269,2142,2021,1908,1801,1700,1604,1514,1429,1349,1273,1202,1134,1071,1011,954,900,850,802,757,715,675,637,601,567,535,505,477,450,425,401,379,357,
337,318,300,284,268,253,238,225,212,201,189,179,169,159,150,142,134];window.neoart.DMPlayer=function(n){n=AmigaPlayer(n);Object.defineProperties(n,{id:{value:"DMPlayer"},songs:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},voices:{value:[],writable:!0},buffer1:{value:0,writable:!0},buffer2:{value:0,writable:!0},song1:{value:0,writable:!0},song2:{value:0,writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternLen:{value:0,writable:!0},
patternEnd:{value:0,writable:!0},stepEnd:{value:0,writable:!0},numChannels:{value:0,writable:!0},arpeggios:{value:null,writable:!0},averages:{value:null,writable:!0},volumes:{value:null,writable:!0},mixChannel:{value:null,writable:!0},mixPeriod:{value:0,writable:!0},initialize:{value:function(){var c,d=0,i;this.reset();7<this.playSong&&(this.playSong=0);this.song1=this.songs[this.playSong];this.speed=this.song1.speed&15;this.speed|=this.speed<<4;this.tick=this.song1.speed;this.patternPos=this.trackPos=
0;this.patternLen=64;this.stepEnd=this.patternEnd=1;for(this.numChannels=4;7>d;++d)i=this.voices[d],i.initialize(),i.sample=this.samples[0],4>d&&(c=this.mixer.channels[d],c.enabled=0,c.pointer=this.mixer.loopPtr,c.length=2,c.period=124,c.volume=0,i.channel=c);if(2==this.version){0!=(this.playSong&1)&&this.playSong--;this.song2=this.songs[this.playSong+1];this.mixChannel=AmigaChannel(7);this.numChannels=7;c=this.mixer.channels[3];c.mute=0;c.pointer=this.buffer1;c.length=350;c.period=this.mixPeriod;
c.volume=64;c=this.buffer1+700;for(d=this.buffer1;d<c;++d)this.mixer.memory[d]=0}}},loader:{value:function(c){var d,i=0,g,h,j,b;g=c.readString(24);if(" MUGICIAN/SOFTEYES 1990 "==g)this.version=1;else if(" MUGICIAN2/SOFTEYES 1990"==g)this.version=2;else return;c.position=28;for(h=new Uint32Array(8);8>i;++i)h[i]=c.readUint();c.position=76;for(i=0;8>i;++i)j=Object.create(null,{title:{value:"",writable:!0},speed:{value:0,writable:!0},length:{value:0,writable:!0},loop:{value:0,writable:!0},loopStep:{value:0,
writable:!0},tracks:{value:[],writable:!0}}),j.loop=c.readUbyte(),j.loopStep=c.readUbyte()<<2,j.speed=c.readUbyte(),j.length=c.readUbyte()<<2,j.title=c.readString(12),this.songs[i]=j;c.position=204;this.lastSong=this.songs.length-1;for(i=0;8>i;++i){j=this.songs[i];g=h[i]<<2;for(d=0;d<g;++d)b=AmigaStep(),b.pattern=c.readUbyte()<<6,b.transpose=c.readByte(),j.tracks[d]=b}j=c.position;c.position=60;g=c.readUint();this.samples.length=++g;c.position=j;for(i=1;i<g;++i)h=AmigaSample(),Object.defineProperties(h,
{wave:{value:0,writable:!0},waveLen:{value:0,writable:!0},finetune:{value:0,writable:!0},arpeggio:{value:0,writable:!0},pitch:{value:0,writable:!0},pitchDelay:{value:0,writable:!0},pitchLoop:{value:0,writable:!0},pitchSpeed:{value:0,writable:!0},effect:{value:0,writable:!0},effectDone:{value:0,writable:!0},effectStep:{value:0,writable:!0},effectSpeed:{value:0,writable:!0},source1:{value:0,writable:!0},source2:{value:0,writable:!0},volumeLoop:{value:0,writable:!0},volumeSpeed:{value:0,writable:!0}}),
b=Object.seal(h),b.wave=c.readUbyte(),b.waveLen=c.readUbyte()<<1,b.volume=c.readUbyte(),b.volumeSpeed=c.readUbyte(),b.arpeggio=c.readUbyte(),b.pitch=c.readUbyte(),b.effectStep=c.readUbyte(),b.pitchDelay=c.readUbyte(),b.finetune=c.readUbyte()<<6,b.pitchLoop=c.readUbyte(),b.pitchSpeed=c.readUbyte(),b.effect=c.readUbyte(),b.source1=c.readUbyte(),b.source2=c.readUbyte(),b.effectSpeed=c.readUbyte(),b.volumeLoop=c.readUbyte(),this.samples[i]=b;this.samples[0]=this.samples[1];j=c.position;c.position=64;
g=c.readUint()<<7;c.position=j;this.mixer.store(c,g);j=c.position;c.position=68;h=c.readUint();c.position=26;g=c.readUshort()<<6;this.patterns.length=g;c.position=j+(h<<5);h&&(h=j);for(i=0;i<g;++i)d=AmigaRow(),d.note=c.readUbyte(),d.sample=c.readUbyte()&63,d.effect=c.readUbyte(),d.param=c.readByte(),this.patterns[i]=d;j=c.position;c.position=72;if(h){g=c.readUint();c.position=j;d=this.mixer.store(c,g);j=c.position;this.mixer.memory.length+=350;this.buffer1=this.mixer.memory.length;this.mixer.memory.length+=
350;this.buffer2=this.mixer.memory.length;this.mixer.memory.length+=350;this.mixer.loopLen=8;g=this.samples.length;for(i=1;i<g;++i)if(b=this.samples[i],!(32>b.wave)&&(c.position=h+(b.wave-32<<5),b.pointer=c.readUint(),b.length=c.readUint()-b.pointer,b.loop=c.readUint(),b.name=c.readString(12),b.loop?(b.loop-=b.pointer,b.repeat=b.length-b.loop,0!=(b.repeat&1)&&b.repeat--):(b.loopPtr=this.mixer.memory.length,b.repeat=8),0!=(b.pointer&1)&&b.pointer--,0!=(b.length&1)&&b.length--,b.pointer+=d,!b.loopPtr))b.loopPtr=
b.pointer+b.loop}else j+=c.readUint();c.position=24;if(1==c.readUshort()){c.position=j;g=c.length-c.position;256<g&&(g=256);for(i=0;i<g;++i)this.arpeggios[i]=c.readUbyte()}}},process:{value:function(){for(var c,d,i=0,g,h,j,b=this.mixer.memory,l,k,m,f,e,a;i<this.numChannels;++i){a=this.voices[i];f=a.sample;if(3>i||4==this.numChannels){if(c=a.channel,this.stepEnd&&(a.step=this.song1.tracks[this.trackPos+i]),31<f.wave)c.pointer=f.loopPtr,c.length=f.repeat}else c=this.mixChannel,this.stepEnd&&(a.step=
this.song2.tracks[this.trackPos+(i-3)]);if(this.patternEnd&&(d=this.patterns[a.step.pattern+this.patternPos],d.note)){74!=d.effect&&(a.note=d.note,d.sample&&(f=a.sample=this.samples[d.sample]));a.val1=64>d.effect?1:d.effect-62;a.val2=d.param;g=a.step.transpose+f.finetune;12!=a.val1?(a.pitch=d.effect,1==a.val1&&(g+=a.pitch,a.period=0>g?0:p[g])):(a.pitch=d.note,g+=a.pitch,a.period=0>g?0:p[g]);11==a.val1&&(f.arpeggio=a.val2&7);if(12!=a.val1)if(31<f.wave)c.pointer=f.pointer,c.length=f.length,c.enabled=
0,a.mixPtr=f.pointer,a.mixEnd=f.pointer+f.length,a.mixMute=0;else if(d=f.wave<<7,c.pointer=d,c.length=f.waveLen,10!=a.val1&&(c.enabled=0),4==this.numChannels&&0!=f.effect&&2!=a.val1&&4!=a.val1){j=d+128;k=f.source1<<7;for(h=d;h<j;++h)b[h]=b[k++];f.effectStep=0;a.effectCtr=f.effectSpeed}3!=a.val1&&4!=a.val1&&12!=a.val1&&(a.volumeCtr=1,a.volumeStep=0);a.arpeggioStep=0;a.pitchCtr=f.pitchDelay;a.pitchStep=0;a.portamento=0}switch(a.val1){case 5:e=a.val2;0<e&&65>e&&(this.patternLen=e);break;case 6:e=a.val2&
15;e|=e<<4;if(0==a.val2||15<a.val2)break;this.speed=e;break;case 7:this.mixer.filter.active=1;break;case 8:this.mixer.filter.active=0;break;case 13:a.val1=0;e=a.val2&15;if(0==e)break;e=a.val2&240;if(0==e)break;this.speed=a.val2}}for(i=0;i<this.numChannels;++i){a=this.voices[i];f=a.sample;if(4==this.numChannels){if(c=a.channel,32>f.wave&&f.effect&&!f.effectDone)if(f.effectDone=1,a.effectCtr)a.effectCtr--;else switch(a.effectCtr=f.effectSpeed,d=f.wave<<7,f.effect){case 1:for(h=0;127>h;++h)e=b[d],e+=
b[d+1],b[d++]=e>>1;break;case 2:k=f.source1<<7;m=f.source2<<7;g=f.effectStep;j=f.waveLen;f.effectStep=++f.effectStep&127;for(h=0;h<j;++h)e=b[k++],e+=b[m+g],b[d++]=e>>1,g=++g&127;break;case 3:e=b[d];for(h=0;127>h;++h)b[d]=b[++d];b[d]=e;break;case 4:d+=127;e=b[d];for(h=0;127>h;++h)b[d]=b[--d];b[d]=e;break;case 5:g=e=d;for(h=0;64>h;++h)b[g++]=b[d++],d++;g=d=e;g+=64;for(h=0;64>h;++h)b[g++]=b[d++];break;case 6:k=d+64;d+=128;for(h=0;64>h;++h)b[--d]=b[--k],b[--d]=b[k];break;case 7:d+=f.effectStep;b[d]=~b[d]+
1;++f.effectStep>=f.waveLen&&(f.effectStep=0);break;case 8:f.effectStep=++f.effectStep&127;m=(f.source2<<7)+f.effectStep;g=b[m];j=f.waveLen;e=3;for(h=0;h<j;++h)k=b[d]+e,-128>k?k+=256:127<k&&(k-=256),b[d++]=k,e+=g,-128>e?e+=256:127<e&&(e-=256);break;case 9:m=f.source2<<7;j=f.waveLen;for(h=0;h<j;++h)e=b[m++],e+=b[d],127<e&&(e-=256),b[d++]=e;break;case 10:for(h=0;126>h;++h)e=3*b[d++],e+=b[d+1],b[d]=e>>2;break;case 11:k=f.source1<<7;m=f.source2<<7;j=f.waveLen;f.effectStep=++f.effectStep&127;e=f.effectStep;
64<=e&&(e=127-e);g=(e^255)&63;for(h=0;h<j;++h)l=b[k++]*e,l+=b[m++]*g,b[d++]=l>>6;break;case 12:k=f.source1<<7;m=f.source2<<7;j=f.waveLen;f.effectStep=++f.effectStep&31;e=f.effectStep;16<=e&&(e=31-e);g=(e^255)&15;for(h=0;h<j;++h)l=b[k++]*e,l+=b[m++]*g,b[d++]=l>>4;break;case 13:for(h=0;126>h;++h)e=b[d++],e+=b[d+1],b[d]=e>>1;break;case 14:g=d+f.effectStep;b[g]=~b[g]+1;g=f.effectStep+f.source2&f.waveLen-1;g+=d;b[g]=~b[g]+1;++f.effectStep>=f.waveLen&&(f.effectStep=0);break;case 15:g=d;for(h=0;127>h;++h)e=
b[d],e+=b[d+1],b[d++]=e>>1;d=g;f.effectStep++;if(f.effectStep==f.source2){f.effectStep=0;g=e=d;for(h=0;64>h;++h)b[g++]=b[d++],d++;g=d=e;g+=64;for(h=0;64>h;++h)b[g++]=b[d++]}}}else c=3>i?a.channel:this.mixChannel;a.volumeCtr&&(a.volumeCtr--,0==a.volumeCtr&&(a.volumeCtr=f.volumeSpeed,a.volumeStep=++a.volumeStep&127,a.volumeStep||f.volumeLoop?(g=a.volumeStep+(f.volume<<7),e=~(b[g]+129)+1,a.volume=(e&255)>>2,c.volume=a.volume):a.volumeCtr=0));e=a.note;f.arpeggio&&(g=a.arpeggioStep+(f.arpeggio<<5),e+=
this.arpeggios[g],a.arpeggioStep=++a.arpeggioStep&31);g=e+a.step.transpose+f.finetune;a.finalPeriod=p[g];d=a.finalPeriod;if(1==a.val1||12==a.val1)if(e=~a.val2+1,a.portamento+=e,a.finalPeriod+=a.portamento,a.val2&&(0>e&&a.finalPeriod<=a.period||0<=e&&a.finalPeriod>=a.period))a.portamento=a.period-d,a.val2=0;f.pitch&&(a.pitchCtr?a.pitchCtr--:(g=a.pitchStep,a.pitchStep=++a.pitchStep&127,0==a.pitchStep&&(a.pitchStep=f.pitchLoop),g+=f.pitch<<7,e=b[g],a.finalPeriod+=~e+1));c.period=a.finalPeriod}if(4<this.numChannels){k=
this.buffer1;this.buffer1=this.buffer2;this.buffer2=k;c=this.mixer.channels[3];c.pointer=k;for(i=3;7>i;++i)a=this.voices[i],a.mixStep=0,125>a.finalPeriod?(a.mixMute=1,a.mixSpeed=0):(h=(a.finalPeriod<<8)/this.mixPeriod&65535,m=(256/h&255)<<8,d=256%h<<8&16777215,a.mixSpeed=(m|d/h&255)<<8),a.mixVolume=a.mixMute?0:a.volume<<8;for(i=0;350>i;++i){d=0;for(h=3;7>h;++h)a=this.voices[h],m=(b[a.mixPtr+(a.mixStep>>16)]&255)+a.mixVolume,d+=this.volumes[m],a.mixStep+=a.mixSpeed;b[k++]=this.averages[d]}c.length=
350;c.period=this.mixPeriod;c.volume=64}if(0==--this.tick){if(this.tick=this.speed&15,this.speed=(this.speed&240)>>4,this.speed|=this.tick<<4,this.patternEnd=1,this.patternPos++,64==this.patternPos||this.patternPos==this.patternLen)this.patternPos=0,this.stepEnd=1,this.trackPos+=4,this.trackPos==this.song1.length&&(this.trackPos=this.song1.loopStep,this.mixer.complete=1)}else this.stepEnd=this.patternEnd=0;for(i=0;i<this.numChannels;++i)if(a=this.voices[i],a.mixPtr+=a.mixStep>>16,f=a.sample,f.effectDone=
0,a.mixPtr>=a.mixEnd&&(f.loop?a.mixPtr-=f.repeat:(a.mixPtr=0,a.mixMute=1)),4>i)c=a.channel,c.enabled=1}},tables:{value:function(){var c=0,d,i,g=0,h=0,j,b,l=128;this.averages=new Int32Array(1024);this.volumes=new Int32Array(16384);for(this.mixPeriod=203;1024>c;++c)127<l&&(l-=256),this.averages[c]=l,383<c&&639>c&&(l=++l&255);for(c=0;64>c;++c){j=-128;b=128;for(i=0;256>i;++i)l=j*h/63+128,d=g+b,this.volumes[d]=l&255,0!=c&&63!=c&&128<=b&&--this.volumes[d],j++,b=++b&255;g+=256;h++}}}});n.voices[0]=o();n.voices[1]=
o();n.voices[2]=o();n.voices[3]=o();n.voices[4]=o();n.voices[5]=o();n.voices[6]=o();n.arpeggios=new Uint8Array(256);n.tables();return Object.seal(n)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.0 - 2012/03/24

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function l(k,a){return Object.create(null,{index:{value:k,writable:!0},bitFlag:{value:a,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},trackPtr:{value:0,writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},frqseqPtr:{value:0,writable:!0},frqseqPos:{value:0,writable:!0},volseqPtr:{value:0,writable:!0},volseqPos:{value:0,writable:!0},volseqSpeed:{value:0,writable:!0},volseqCounter:{value:0,writable:!0},
halve:{value:0,writable:!0},speed:{value:0,writable:!0},tick:{value:0,writable:!0},busy:{value:0,writable:!0},flags:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},transpose:{value:0,writable:!0},portaDelay:{value:0,writable:!0},portaDelta:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},vibrato:{value:0,writable:!0},vibratoDelta:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},initialize:{value:function(){this.sample=
this.channel=null;this.speed=this.halve=this.volseqCounter=this.volseqSpeed=this.volseqPos=this.volseqPtr=this.frqseqPos=this.frqseqPtr=this.patternPos=this.trackPos=this.trackPtr=0;this.tick=1;this.busy=-1;this.vibratoDepth=this.vibratoSpeed=this.vibratoDelta=this.vibrato=this.portaSpeed=this.portaDelta=this.portaDelay=this.transpose=this.period=this.note=this.flags=0}}})}window.neoart.DWPlayer=function(k){k=AmigaPlayer(k);Object.defineProperties(k,{id:{value:"DWPlayer"},songs:{value:[],writable:!0},
samples:{value:[],writable:!0},stream:{value:null,writable:!0},song:{value:null,writable:!0},songvol:{value:0,writable:!0},master:{value:0,writable:!0},periods:{value:0,writable:!0},frqseqs:{value:0,writable:!0},volseqs:{value:0,writable:!0},transpose:{value:0,writable:!0},slower:{value:0,writable:!0},slowerCounter:{value:0,writable:!0},delaySpeed:{value:0,writable:!0},delayCounter:{value:0,writable:!0},fadeSpeed:{value:0,writable:!0},fadeCounter:{value:0,writable:!0},wave:{value:null,writable:!0},
waveCenter:{value:0,writable:!0},waveLo:{value:0,writable:!0},waveHi:{value:0,writable:!0},waveDir:{value:0,writable:!0},waveLen:{value:0,writable:!0},wavePos:{value:0,writable:!0},waveRateNeg:{value:0,writable:!0},waveRatePos:{value:0,writable:!0},voices:{value:[],writable:!0},active:{value:0,writable:!0},complete:{value:0,writable:!0},variant:{value:0,writable:!0},base:{value:0,writable:!0},com2:{value:0,writable:!0},com3:{value:0,writable:!0},com4:{value:0,writable:!0},readMix:{value:"",writable:!0},
readLen:{value:0,writable:!0},initialize:{value:function(){var a,d,f=this.voices[this.active];this.reset();this.song=this.songs[this.playSong];this.songvol=this.master;this.speed=this.song.speed;this.transpose=0;this.slowerCounter=6;this.delaySpeed=this.song.delay;this.fadeCounter=this.fadeSpeed=this.delayCounter=0;if(this.wave){this.waveDir=0;this.wavePos=this.wave.pointer+this.waveCenter;a=this.wave.pointer;for(d=this.wavePos;a<d;++a)this.mixer.memory[a]=this.waveRateNeg;for(d+=this.waveCenter;a<
d;++a)this.mixer.memory[a]=this.waveRatePos}for(;f;)f.initialize(),f.channel=this.mixer.channels[f.index],f.sample=this.samples[0],this.complete+=f.bitFlag,f.trackPtr=this.song.tracks[f.index],f.trackPos=this.readLen,this.stream.position=f.trackPtr,f.patternPos=this.base+this.stream[this.readMix](),this.frqseqs&&(this.stream.position=this.frqseqs,f.frqseqPtr=this.base+this.stream.readUshort(),f.frqseqPos=f.frqseqPtr),f=f.next}},loader:{value:function(a){var d,f,g,e,b,h,j=10,i,c;this.master=64;this.readMix=
"readUshort";this.readLen=2;this.variant=0;if(18663==a.readUshort()){a.position=4;if(24832!=a.readUshort())return;a.position+=a.readUshort();this.variant=30}else a.position=0;for(;20085!=c;){c=a.readUshort();switch(c){case 18426:this.base=a.position+a.readShort();break;case 24832:a.position+=2;b=a.position;24832==a.readUshort()&&(b=a.position+a.readUshort());break;case 49404:j=a.readUshort();18==j?(this.readMix="readUint",this.readLen=4):this.variant=10;16890==a.readUshort()&&(f=a.position+a.readUshort());
4656==a.readUshort()&&(d=1);break;case 4656:a.position-=6;16890==a.readUshort()&&(f=a.position+a.readUshort(),d=1);a.position+=4;break;case 48764:this.channels=a.readUshort(),a.position+=2,14204==a.readUshort()&&(this.master=a.readUshort())}if(20>a.bytesAvailable)return}e=a.position;this.songs=[];h=2147483647;i=0;for(a.position=f;;){f=Object.create(null,{speed:{value:0,writable:!0},delay:{value:0,writable:!0},tracks:{value:null,writable:!0}});f.tracks=new Uint32Array(this.channels);d?(f.speed=a.readUbyte(),
f.delay=a.readUbyte()):f.speed=a.readUshort();if(255<f.speed)break;for(g=0;g<this.channels;++g)c=this.base+a[this.readMix](),c<h&&(h=c),f.tracks[g]=c;this.songs[i++]=f;if(h-a.position<j)break}if(i&&(this.lastSong=this.songs.length-1,a.position=b,18987==a.readUshort())){f=j=0;for(this.wave=null;20085!=c;)switch(c=a.readUshort(),c){case 19450:if(f)break;b=a.position+a.readShort();a.position++;i=a.readUbyte();a.position-=10;c=a.readUshort();d=a.position;16890==c||8314==c?f=a.position+a.readUshort():
53500==c&&(f=64+a.readUshort(),a.position-=18,f+=a.position+a.readUshort());a.position=d;break;case 33987:if(j)break;a.position+=4;c=a.readUshort();56060==c?j=a.readUshort():56316==c&&(j=a.readUint());12==j&&30>this.variant&&(this.variant=20);d=a.position;this.samples=[];this.samples.length=++i;a.position=f;for(g=0;g<i;++g)c=AmigaSample(),Object.defineProperties(c,{relative:{value:0,writable:!0},finetune:{value:0,writable:!0}}),h=Object.seal(c),h.length=a.readUint(),h.relative=parseInt(3579545/a.readUshort()),
h.pointer=this.mixer.store(a,h.length),c=a.position,a.position=b+g*j+4,h.loopPtr=a.readInt(),0==this.variant?(a.position+=6,h.volume=a.readUshort()):10==this.variant&&(a.position+=4,h.volume=a.readUshort(),h.finetune=a.readByte()),a.position=c,this.samples[g]=h;this.mixer.loopLen=64;a.length=f;a.position=d;break;case 8314:c=a.position+a.readShort();if(12860!=a.readUshort()){a.position-=2;break}this.wave=this.samples[parseInt((c-b)/j)];this.waveCenter=a.readUshort()+1<<1;a.position+=2;this.waveRateNeg=
a.readByte();a.position+=12;this.waveRatePos=a.readByte();break;case 1131:case 1643:i=a.readUshort(),h=this.samples[parseInt((a.readUshort()-b)/j)],h.relative=1643==c?h.relative+i:h.relative-i}if(this.samples.length){a.position=e;this.slower=this.volseqs=this.frqseqs=this.periods=0;this.com2=176;this.com3=160;for(this.com4=144;16<a.bytesAvailable;)switch(c=a.readUshort(),c){case 18426:a.position+=2;if(18987!=a.readUshort())break;d=a.position;a.position+=4;c=a.readUshort();if(4154==c){if(a.position+=
4,49404==a.readUshort()){c=a.readUshort();i=this.songs.length;for(g=0;g<i;++g)this.songs[g].delay*=c;a.position+=6}}else 21291==c&&(a.position-=8);c=a.readUshort();18987==c&&(a.position=this.base+a.readUshort(),this.slower=a.readByte());a.position=d;break;case 3179:a.position-=6;c=a.readUshort();if(21611==c||21099==c)a.position+=4,this.waveHi=this.wave.pointer+a.readUshort();else if(21867==c||21355==c)a.position+=4,this.waveLo=this.wave.pointer+a.readUshort();this.waveLen=21611>c?1:2;break;case 32256:case 32257:case 32258:case 32259:this.active=
c&15;i=this.channels-1;if(this.active){this.voices[0].next=null;for(g=i;0<g;)this.voices[g].next=this.voices[--g]}else{this.voices[i].next=null;for(g=0;g<i;)this.voices[g].next=this.voices[++g]}break;case 3176:a.position+=22;3089==a.readUshort()&&(this.variant=40);break;case 12845:d=a.position;c=a.readUshort();if(10==c||12==c)a.position-=8,17914==a.readUshort()&&(this.periods=a.position+a.readUshort());a.position=d+2;break;case 1024:case 1088:case 1536:c=a.readUshort();192==c||64==c?(this.com2=192,
this.com3=176,this.com4=160):c==this.com3?(a.position+=2,17914==a.readUshort()&&(this.volseqs=a.position+a.readUshort(),40>this.variant&&(this.variant=30))):c==this.com4&&(a.position+=2,17914==a.readUshort()&&(this.frqseqs=a.position+a.readUshort()));break;case 20211:a.position+=2;case 20178:if(h=a.position,a.position-=10,a.position+=a.readUshort(),d=a.position,a.position=d+2,a.position=this.base+a.readUshort()+10,18964==a.readUshort()&&(this.variant=41),a.position=d+16,c=this.base+a.readUshort(),
c>h&&c<d&&(a.position=c,c=a.readUshort(),20712==c?this.variant=21:5977==c&&(this.variant=11)),a.position=d+20,c=this.base+a.readUshort(),c>h&&c<d&&(a.position=c+2,18560!=a.readUshort()&&(this.variant=31)),a.position=d+26,c=a.readUshort(),c>h&&c<d&&(this.variant=32),this.frqseqs)a.position=a.length}this.periods&&(this.com2-=256,this.com3-=256,this.com4-=256,this.stream=a,this.version=1)}}}},process:{value:function(){var a,d,f,g,e,b=this.voices[this.active];if(this.slower&&0==--this.slowerCounter)this.slowerCounter=
6;else if(255<(this.delayCounter+=this.delaySpeed))this.delayCounter-=256;else{if(this.fadeSpeed&&(0==--this.fadeCounter&&(this.fadeCounter=this.fadeSpeed,this.songvol--),!this.songvol))if(this.loopSong)this.initialize();else{this.mixer.complete=1;return}if(this.wave)if(this.waveDir){if(this.mixer.memory[this.wavePos++]=this.waveRatePos,1<this.waveLen&&(this.mixer.memory[this.wavePos++]=this.waveRatePos),(this.wavePos-=this.waveLen<<1)==this.waveLo)this.waveDir=0}else if(this.mixer.memory[this.wavePos++]=
this.waveRateNeg,1<this.waveLen&&(this.mixer.memory[this.wavePos++]=this.waveRateNeg),this.wavePos==this.waveHi)this.waveDir=1;for(;b;){a=b.channel;this.stream.position=b.patternPos;g=b.sample;b.busy||(b.busy=1,0>g.loopPtr?(a.pointer=this.mixer.loopPtr,a.length=this.mixer.loopLen):(a.pointer=g.pointer+g.loopPtr,a.length=g.length-g.loopPtr));if(0==--b.tick){b.flags=0;for(d=1;0<d;)if(e=this.stream.readByte(),0>e)if(-32<=e)b.speed=this.speed*(e+33);else if(e>=this.com2)e-=this.com2,b.sample=g=this.samples[e];
else if(e>=this.com3)f=this.stream.position,this.stream.position=this.volseqs+(e-this.com3<<1),this.stream.position=this.base+this.stream.readUshort(),b.volseqPtr=this.stream.position,this.stream.position--,b.volseqSpeed=this.stream.readUbyte(),this.stream.position=f;else if(e>=this.com4)f=this.stream.position,this.stream.position=this.frqseqs+(e-this.com4<<1),b.frqseqPtr=this.base+this.stream.readUshort(),b.frqseqPos=b.frqseqPtr,this.stream.position=f;else switch(e){case -128:this.stream.position=
b.trackPtr+b.trackPos;(e=this.stream[this.readMix]())?(this.stream.position=this.base+e,b.trackPos+=this.readLen):(this.stream.position=b.trackPtr,this.stream.position=this.base+this.stream[this.readMix](),b.trackPos=this.readLen,this.loopSong||(this.complete&=~b.bitFlag,this.complete||(this.mixer.complete=1)));break;case -127:0<this.variant&&(b.portaDelta=0);b.portaSpeed=this.stream.readByte();b.portaDelay=this.stream.readUbyte();b.flags|=2;break;case -126:b.tick=b.speed;b.patternPos=this.stream.position;
41==this.variant?(b.busy=1,a.enabled=0):(a.pointer=this.mixer.loopPtr,a.length=this.mixer.loopLen);d=0;break;case -125:0<this.variant&&(b.tick=b.speed,b.patternPos=this.stream.position,a.enabled=1,d=0);break;case -124:this.mixer.complete=1;break;case -123:0<this.variant&&(this.transpose=this.stream.readByte());break;case -122:b.vibrato=-1;b.vibratoSpeed=this.stream.readUbyte();b.vibratoDepth=this.stream.readUbyte();b.vibratoDelta=0;break;case -121:b.vibrato=0;break;case -120:21==this.variant?b.halve=
1:11==this.variant?this.fadeSpeed=this.stream.readUbyte():b.transpose=this.stream.readByte();break;case -119:21==this.variant?b.halve=0:(b.trackPtr=this.base+this.stream.readUshort(),b.trackPos=0);break;case -118:31==this.variant?this.delaySpeed=this.stream.readUbyte():this.speed=this.stream.readUbyte();break;case -117:this.fadeCounter=this.fadeSpeed=this.stream.readUbyte();break;case -116:e=this.stream.readUbyte(),32!=this.variant&&(this.songvol=e)}else b.patternPos=this.stream.position,b.note=e+=
g.finetune,b.tick=b.speed,b.busy=0,20<=this.variant?(e=e+this.transpose+b.transpose&255,this.stream.position=b.volseqPtr,d=this.stream.readUbyte(),b.volseqPos=this.stream.position,b.volseqCounter=b.volseqSpeed,b.halve&&(d>>=1),d=d*this.songvol>>6):d=g.volume,a.pointer=g.pointer,a.length=g.length,a.volume=d,this.stream.position=this.periods+(e<<1),e=this.stream.readUshort()*g.relative>>10,10>this.variant&&(b.portaDelta=e),a.period=e,a.enabled=1,d=0}else if(1==b.tick)if(30>this.variant)a.enabled=0;
else{if(e=this.stream.readUbyte(),131!=e&&(40>this.variant||224>e||131!=this.stream.readUbyte()))a.enabled=0}else 0==this.variant?b.flags&2&&(b.portaDelay?b.portaDelay--:(b.portaDelta-=b.portaSpeed,a.period=b.portaDelta)):(this.stream.position=b.frqseqPos,e=this.stream.readByte(),0>e&&(e&=127,this.stream.position=b.frqseqPtr),b.frqseqPos=this.stream.position,e=e+b.note+this.transpose+b.transpose&255,this.stream.position=this.periods+(e<<1),e=this.stream.readUshort()*g.relative>>10,b.flags&2&&(b.portaDelay?
b.portaDelay--:(b.portaDelta+=b.portaSpeed,e-=b.portaDelta)),b.vibrato&&(0<b.vibrato?(b.vibratoDelta-=b.vibratoSpeed,b.vibratoDelta||(b.vibrato^=2147483648)):(b.vibratoDelta+=b.vibratoSpeed,b.vibratoDelta==b.vibratoDepth&&(b.vibrato^=2147483648)),b.vibratoDelta||(b.vibrato^=1),e=b.vibrato&1?e+b.vibratoDelta:e-b.vibratoDelta),a.period=e,20<=this.variant&&0>--b.volseqCounter&&(this.stream.position=b.volseqPos,d=this.stream.readByte(),0<=d&&(b.volseqPos=this.stream.position),b.volseqCounter=b.volseqSpeed,
d&=127,b.halve&&(d>>=1),a.volume=d*this.songvol>>6));b=b.next}}}}});k.voices[0]=l(0,1);k.voices[1]=l(1,2);k.voices[2]=l(2,4);k.voices[3]=l(3,8);return Object.seal(k)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.0 - 2012/03/15

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function j(h){return Object.create(null,{index:{value:h,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},pattern:{value:0,writable:!0},soundTranspose:{value:0,writable:!0},transpose:{value:0,writable:!0},patStep:{value:0,writable:!0},frqStep:{value:0,writable:!0},frqPos:{value:0,writable:!0},frqSustain:{value:0,writable:!0},frqTranspose:{value:0,writable:!0},volStep:{value:0,writable:!0},volPos:{value:0,
writable:!0},volCtr:{value:0,writable:!0},volSpeed:{value:0,writable:!0},volSustain:{value:0,writable:!0},note:{value:0,writable:!0},pitch:{value:0,writable:!0},volume:{value:0,writable:!0},pitchBendFlag:{value:0,writable:!0},pitchBendSpeed:{value:0,writable:!0},pitchBendTime:{value:0,writable:!0},portamentoFlag:{value:0,writable:!0},portamento:{value:0,writable:!0},volBendFlag:{value:0,writable:!0},volBendSpeed:{value:0,writable:!0},volBendTime:{value:0,writable:!0},vibratoFlag:{value:0,writable:!0},
vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},vibratoDelay:{value:0,writable:!0},vibrato:{value:0,writable:!0},initialize:{value:function(){this.sample=null;this.volPos=this.volStep=this.frqTranspose=this.frqSustain=this.frqPos=this.frqStep=this.patStep=this.transpose=this.soundTranspose=this.pattern=this.enabled=0;this.volSpeed=this.volCtr=1;this.vibrato=this.vibratoDelay=this.vibratoDepth=this.vibratoSpeed=this.vibratoFlag=this.volBendTime=this.volBendSpeed=this.volBendFlag=
this.portamento=this.portamentoFlag=this.pitchBendTime=this.pitchBendSpeed=this.pitchBendFlag=this.volume=this.pitch=this.note=this.volSustain=0}},volumeBend:{value:function(){if(this.volBendFlag^=1)if(this.volBendTime--,this.volume+=this.volBendSpeed,0>this.volume||64<this.volume)this.volBendTime=0}}})}var l=[1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,
127,120,113,113,113,113,113,113,113,113,113,113,113,113,113,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1812,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113],k=[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,8,8,8,8,8,8,8,8,16,8,16,16,8,8,
24,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,63,55,47,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,55,47,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,47,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,
-80,-88,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-1,7,15,23,31,39,47,55,-64,
-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,31,39,47,55,-64,-64,-48,
-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,-96,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,-96,-88,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,-96,-88,-80,55,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,
127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,
-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,
-127,-127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,
127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,-128,-128,-128,-128,-128,-128,
-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,127,127,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,127,-128,-128,-128,-128,-128,-128,-128,-128,127,127,127,127,127,127,127,127,-128,-128,-128,-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,-128,-128,-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,-128,
-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,127,-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,-112,-104,-96,-88,-80,-72,-64,-56,-48,-40,-32,-24,-16,-8,0,8,16,24,32,40,48,56,64,72,80,88,96,104,112,127,-128,-128,-96,-80,-64,-48,-32,-16,0,16,32,48,64,80,96,
112,69,69,121,125,122,119,112,102,97,88,83,77,44,32,24,18,4,-37,-45,-51,-58,-68,-75,-82,-88,-93,-99,-103,-109,-114,-117,-118,69,69,121,125,122,119,112,102,91,75,67,55,44,32,24,18,4,-8,-24,-37,-49,-58,-66,-80,-88,-92,-98,-102,-107,-108,-115,-125,0,0,64,96,127,96,64,32,0,-32,-64,-96,-128,-96,-64,-32,0,0,64,96,127,96,64,32,0,-32,-64,-96,-128,-96,-64,-32,-128,-128,-112,-104,-96,-88,-80,-72,-64,-56,-48,-40,-32,-24,-16,-8,0,8,16,24,32,40,48,56,64,72,80,88,96,104,112,127,-128,-128,-96,-80,-64,-48,-32,-16,
0,16,32,48,64,80,96,112];window.neoart.FCPlayer=function(h){h=AmigaPlayer(h);Object.defineProperties(h,{id:{value:"FCPlayer"},seqs:{value:null,writable:!0},pats:{value:null,writable:!0},vols:{value:null,writable:!0},frqs:{value:null,writable:!0},length:{value:0,writable:!0},samples:{value:[],writable:!0},voices:{value:[],writable:!0},initialize:{value:function(){var b=this.voices[0];this.reset();this.seqs.position=0;this.pats.position=0;this.vols.position=0;for(this.frqs.position=0;b;)b.initialize(),
b.channel=this.mixer.channels[b.index],b.pattern=this.seqs.readUbyte()<<6,b.transpose=this.seqs.readByte(),b.soundTranspose=this.seqs.readByte(),b=b.next;this.speed=this.seqs.readUbyte();this.speed||(this.speed=3);this.tick=this.speed}},loader:{value:function(b){var g,d,e,f,a,c,i,h,j;d=b.readString(4);if("SMOD"==d)this.version=1;else if("FC14"==d)this.version=2;else return;b.position=4;this.length=b.readUint();b.position=1==this.version?100:180;this.seqs=ByteArray(new ArrayBuffer(this.length));b.readBytes(this.seqs,
0,this.length);this.length=this.length/13>>0;b.position=12;e=b.readUint();b.position=8;b.position=b.readUint();this.pats=ByteArray(new ArrayBuffer(e+1));b.readBytes(this.pats,0,e);b.position=20;e=b.readUint();b.position=16;b.position=b.readUint();this.frqs=ByteArray(new ArrayBuffer(e+9));this.frqs.writeInt(16777216);this.frqs.writeInt(225);b.readBytes(this.frqs,8,e);this.frqs.position=this.frqs.length-1;this.frqs.writeByte(225);this.frqs.position=0;b.position=28;e=b.readUint();b.position=24;b.position=
b.readUint();this.vols=ByteArray(new ArrayBuffer(e+8));this.vols.writeInt(16777216);this.vols.writeInt(225);b.readBytes(this.vols,8,e);b.position=32;i=b.readUint();b.position=40;1==this.version?(this.samples.length=57,f=0):(this.samples.length=200,f=2);for(g=0;10>g;++g)if(e=b.readUshort()<<1,0<e)if(a=b.position,b.position=i,d=b.readString(4),"SSMP"==d){h=e;for(d=0;10>d;++d)(b.readInt(),e=b.readUshort()<<1,0<e)?(c=AmigaSample(),c.length=e+2,c.loop=b.readUshort(),c.repeat=b.readUshort()<<1,c.loop+c.repeat>
c.length&&(c.repeat=c.length-c.loop),i+c.length>b.length&&(c.length=b.length-i),c.pointer=this.mixer.store(b,c.length,i+j),c.loopPtr=c.pointer+c.loop,this.samples[100+10*g+d]=c,j+=c.length,b.position+=6):b.position+=10;i+=h+2;b.position=a+4}else b.position=a,c=AmigaSample(),c.length=e+f,c.loop=b.readUshort(),c.repeat=b.readUshort()<<1,c.loop+c.repeat>c.length&&(c.repeat=c.length-c.loop),i+c.length>b.length&&(c.length=b.length-i),c.pointer=this.mixer.store(b,c.length,i),c.loopPtr=c.pointer+c.loop,
this.samples[g]=c,i+=c.length;else b.position+=4;if(1==this.version){f=0;h=47;for(g=10;57>g;++g){c=AmigaSample();c.length=k[f++]<<1;c.loop=0;c.repeat=c.length;a=this.mixer.memory.length;c.pointer=a;c.loopPtr=a;this.samples[g]=c;e=a+c.length;for(d=a;d<e;++d)this.mixer.memory[d]=k[h++]}}else{b.position=36;i=b.readUint();b.position=100;for(g=10;90>g;++g)e=b.readUbyte()<<1,2>e||(c=AmigaSample(),c.length=e,c.loop=0,c.repeat=c.length,i+c.length>b.length&&(c.length=b.length-i),c.pointer=this.mixer.store(b,
c.length,i),c.loopPtr=c.pointer,this.samples[g]=c,i+=c.length)}this.length*=13}},process:{value:function(){var b,g,d,e,f,a=this.voices[0];if(0==--this.tick){for(b=this.seqs.position;a;){g=a.channel;this.pats.position=a.pattern+a.patStep;f=this.pats.readUbyte();if(64<=a.patStep||73==f)this.seqs.position==this.length&&(this.seqs.position=0,this.mixer.complete=1),a.patStep=0,a.pattern=this.seqs.readUbyte()<<6,a.transpose=this.seqs.readByte(),a.soundTranspose=this.seqs.readByte(),this.pats.position=a.pattern,
f=this.pats.readUbyte();d=this.pats.readUbyte();this.frqs.position=0;this.vols.position=0;0!=f&&(a.note=f&127,a.pitch=0,a.portamento=0,a.enabled=g.enabled=0,f=8+((d&63)+a.soundTranspose<<6),0<=f&&f<this.vols.length&&(this.vols.position=f),a.volStep=0,a.volSpeed=a.volCtr=this.vols.readUbyte(),a.volSustain=0,a.frqPos=8+(this.vols.readUbyte()<<6),a.frqStep=0,a.frqSustain=0,a.vibratoFlag=0,a.vibratoSpeed=this.vols.readUbyte(),a.vibratoDepth=a.vibrato=this.vols.readUbyte(),a.vibratoDelay=this.vols.readUbyte(),
a.volPos=this.vols.position);d&64?a.portamento=0:d&128&&(a.portamento=this.pats[this.pats.position+1],1==this.version&&(a.portamento<<=1));a.patStep+=2;a=a.next}if(this.seqs.position!=b&&(f=this.seqs.readUbyte()))this.speed=f;this.tick=this.speed}for(a=this.voices[0];a;){g=a.channel;do{b=0;if(a.frqSustain){a.frqSustain--;break}this.frqs.position=a.frqPos+a.frqStep;do{e=0;if(!this.frqs.bytesAvailable)break;d=this.frqs.readUbyte();if(225==d)break;224==d&&(a.frqStep=this.frqs.readUbyte()&63,this.frqs.position=
a.frqPos+a.frqStep,d=this.frqs.readUbyte());switch(d){case 226:g.enabled=0,a.enabled=1,a.volCtr=1,a.volStep=0;case 228:(d=this.samples[this.frqs.readUbyte()])?(g.pointer=d.pointer,g.length=d.length):a.enabled=0;a.sample=d;a.frqStep+=2;break;case 233:f=100+10*this.frqs.readUbyte();if(d=this.samples[f+this.frqs.readUbyte()])g.enabled=0,g.pointer=d.pointer,g.length=d.length,a.enabled=1;a.sample=d;a.volCtr=1;a.volStep=0;a.frqStep+=3;break;case 231:e=1;a.frqPos=8+(this.frqs.readUbyte()<<6);a.frqPos>=this.frqs.length&&
(a.frqPos=0);a.frqStep=0;this.frqs.position=a.frqPos;break;case 234:a.pitchBendSpeed=this.frqs.readByte();a.pitchBendTime=this.frqs.readUbyte();a.frqStep+=3;break;case 232:b=1;a.frqSustain=this.frqs.readUbyte();a.frqStep+=2;break;case 227:a.vibratoSpeed=this.frqs.readUbyte(),a.vibratoDepth=this.frqs.readUbyte(),a.frqStep+=3}!b&&!e&&(this.frqs.position=a.frqPos+a.frqStep,a.frqTranspose=this.frqs.readByte(),a.frqStep++)}while(e)}while(b);if(a.volSustain)a.volSustain--;else if(a.volBendTime)a.volumeBend();
else if(0==--a.volCtr){a.volCtr=a.volSpeed;do{e=0;this.vols.position=a.volPos+a.volStep;if(!this.vols.bytesAvailable)break;d=this.vols.readUbyte();if(225==d)break;switch(d){case 234:a.volBendSpeed=this.vols.readByte();a.volBendTime=this.vols.readUbyte();a.volStep+=3;a.volumeBend();break;case 232:a.volSustain=this.vols.readUbyte();a.volStep+=2;break;case 224:e=1;f=this.vols.readUbyte()&63;a.volStep=f-5;break;default:a.volume=d,a.volStep++}}while(e)}d=a.frqTranspose;0<=d&&(d+=a.note+a.transpose);d&=
127;e=l[d];if(a.vibratoDelay)a.vibratoDelay--;else{f=a.vibrato;a.vibratoFlag?(b=a.vibratoDepth<<1,f+=a.vibratoSpeed,f>b&&(f=b,a.vibratoFlag=0)):(f-=a.vibratoSpeed,0>f&&(f=0,a.vibratoFlag=1));a.vibrato=f;f-=a.vibratoDepth;for(b=(d<<1)+160;256>b;)f<<=1,b+=24;e+=f}a.portamentoFlag^=1;a.portamentoFlag&&a.portamento&&(a.pitch=31<a.portamento?a.pitch+(a.portamento&31):a.pitch-a.portamento);a.pitchBendFlag^=1;a.pitchBendFlag&&a.pitchBendTime&&(a.pitchBendTime--,a.pitch-=a.pitchBendSpeed);e+=a.pitch;113>
e?e=113:3424<e&&(e=3424);g.period=e;g.volume=a.volume;a.sample&&(d=a.sample,g.enabled=a.enabled,g.pointer=d.loopPtr,g.length=d.repeat);a=a.next}}}});h.voices[0]=j(0);h.voices[0].next=h.voices[1]=j(1);h.voices[1].next=h.voices[2]=j(2);h.voices[2].next=h.voices[3]=j(3);return Object.seal(h)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.0 - 2012/03/24

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function k(i,b){return Object.create(null,{index:{value:i,writable:!0},bitFlag:{value:b,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},tick:{value:0,writable:!0},busy:{value:0,writable:!0},synth:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},volume:{value:0,writable:!0},envelopePos:{value:0,writable:!0},sustainTime:{value:0,writable:!0},
arpeggioPos:{value:0,writable:!0},arpeggioSpeed:{value:0,writable:!0},portamento:{value:0,writable:!0},portaCounter:{value:0,writable:!0},portaDelay:{value:0,writable:!0},portaFlag:{value:0,writable:!0},portaLimit:{value:0,writable:!0},portaNote:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},vibrato:{value:0,writable:!0},vibratoDelay:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},vibratoFlag:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},
pulseCounter:{value:0,writable:!0},pulseDelay:{value:0,writable:!0},pulseDir:{value:0,writable:!0},pulsePos:{value:0,writable:!0},pulseSpeed:{value:0,writable:!0},blendCounter:{value:0,writable:!0},blendDelay:{value:0,writable:!0},blendDir:{value:0,writable:!0},blendPos:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.patternPos=this.trackPos=0;this.busy=this.tick=1;this.blendPos=this.blendDir=this.blendDelay=this.blendCounter=this.pulseSpeed=this.pulsePos=this.pulseDir=
this.pulseDelay=this.pulseCounter=this.vibratoSpeed=this.vibratoFlag=this.vibratoDepth=this.vibratoDelay=this.vibrato=this.portaSpeed=this.portaPeriod=this.portaNote=this.portaLimit=this.portaFlag=this.portaDelay=this.portaCounter=this.portamento=this.arpeggioSpeed=this.arpeggioPos=this.sustainTime=this.envelopePos=this.volume=this.period=this.note=0}}})}var l=[8192,7728,7296,6888,6504,6136,5792,5464,5160,4872,4600,4336,4096,3864,3648,3444,3252,3068,2896,2732,2580,2436,2300,2168,2048,1932,1824,1722,
1626,1534,1448,1366,1290,1218,1150,1084,1024,966,912,861,813,767,724,683,645,609,575,542,512,483,456,430,406,383,362,341,322,304,287,271,256,241,228,215,203,191,181,170,161,152,143,135];window.neoart.FEPlayer=function(i){i=AmigaPlayer(i);Object.defineProperties(i,{id:{value:"FEPlayer"},songs:{value:[],writable:!0},samples:{value:[],writable:!0},patterns:{value:null,writable:!0},song:{value:null,writable:!0},voices:{value:[],writable:!0},complete:{value:0,writable:!0},sampFlag:{value:0,writable:!0},
initialize:{value:function(){var b,f,e=this.voices[3];this.reset();this.song=this.songs[this.playSong];this.speed=this.song.speed;for(this.complete=15;e;){e.initialize();e.channel=this.mixer.channels[e.index];e.patternPos=this.song.tracks[e.index][0];b=e.synth;for(f=b+64;b<f;++b)this.mixer.memory[b]=0;e=e.next}}},loader:{value:function(b){for(var f,e,g,d,c,a,h,i,j,k;16>b.position;)if(h=b.readUshort(),b.position+=2,20218!=h)return;for(;1024>b.position;)if(h=b.readUshort(),4666==h)b.position+=2,h=b.readUshort(),
45057==h&&(b.position-=4,e=b.position+b.readUshort()-2197);else if(8522==h&&(b.position+=2,h=b.readUshort(),18426==h)){f=b.position+b.readShort();this.version=1;break}if(this.version){b.position=e+2210;a=b.readUint();b.position=f+a;this.samples=[];for(a=2147483647;a>b.position;){if(h=b.readUint()){if(h<b.position||h>=b.length){b.position-=4;break}h<a&&(a=f+h)}d=Object.create(null,{pointer:{value:0,writable:!0},loopPtr:{value:0,writable:!0},length:{value:0,writable:!0},relative:{value:0,writable:!0},
type:{value:0,writable:!0},synchro:{value:0,writable:!0},envelopeVol:{value:0,writable:!0},attackSpeed:{value:0,writable:!0},attackVol:{value:0,writable:!0},decaySpeed:{value:0,writable:!0},decayVol:{value:0,writable:!0},sustainTime:{value:0,writable:!0},releaseSpeed:{value:0,writable:!0},releaseVol:{value:0,writable:!0},arpeggio:{value:null,writable:!0},arpeggioLimit:{value:0,writable:!0},arpeggioSpeed:{value:0,writable:!0},vibratoDelay:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},vibratoSpeed:{value:0,
writable:!0},pulseCounter:{value:0,writable:!0},pulseDelay:{value:0,writable:!0},pulsePosL:{value:0,writable:!0},pulsePosH:{value:0,writable:!0},pulseSpeed:{value:0,writable:!0},pulseRateNeg:{value:0,writable:!0},pulseRatePos:{value:0,writable:!0},blendCounter:{value:0,writable:!0},blendDelay:{value:0,writable:!0},blendRate:{value:0,writable:!0}});d.pointer=h;d.loopPtr=b.readShort();d.length=b.readUshort()<<1;d.relative=b.readUshort();d.vibratoDelay=b.readUbyte();b.position++;d.vibratoSpeed=b.readUbyte();
d.vibratoDepth=b.readUbyte();d.envelopeVol=b.readUbyte();d.attackSpeed=b.readUbyte();d.attackVol=b.readUbyte();d.decaySpeed=b.readUbyte();d.decayVol=b.readUbyte();d.sustainTime=b.readUbyte();d.releaseSpeed=b.readUbyte();d.releaseVol=b.readUbyte();d.arpeggio=new Int8Array(16);for(g=0;16>g;++g)d.arpeggio[g]=b.readByte();d.arpeggioSpeed=b.readUbyte();d.type=b.readByte();d.pulseRateNeg=b.readByte();d.pulseRatePos=b.readUbyte();d.pulseSpeed=b.readUbyte();d.pulsePosL=b.readUbyte();d.pulsePosH=b.readUbyte();
d.pulseDelay=b.readUbyte();d.synchro=b.readUbyte();d.blendRate=b.readUbyte();d.blendDelay=b.readUbyte();d.pulseCounter=b.readUbyte();d.blendCounter=b.readUbyte();d.arpeggioLimit=b.readUbyte();b.position+=12;this.samples.push(d);if(!b.bytesAvailable)break}if(2147483647!=a){this.mixer.store(b,b.length-a);c=this.samples.length;for(g=0;g<c;++g)d=this.samples[g],d.pointer&&(d.pointer-=f+a)}a=this.mixer.memory.length;this.mixer.memory.length+=256;this.mixer.loopLen=100;for(g=0;4>g;++g)this.voices[g].synth=
a,a+=64;b.position=e+2210;c=b.readUint();a=b.readUint();b.position=f+a;this.patterns=ByteArray(new ArrayBuffer(c-a));b.readBytes(this.patterns,0,c-a);a+=f;b.position=e+2197;this.lastSong=c=b.readUbyte();this.songs=[];this.songs.length=++c;f=e+2830;k=a-f;for(g=a=0;g<c;++g){j=Object.create(null,{speed:{value:0,writable:!0},length:{value:0,writable:!0},tracks:{value:[],writable:!0}});j.tracks=[];for(d=0;4>d;++d){b.position=f+a;h=b.readUshort();i=3==d&&g==c-1?k:b.readUshort();i=i-h>>1;i>j.length&&(j.length=
i);j.tracks[d]=new Uint32Array(i);b.position=f+h;for(h=0;h<i;++h)j.tracks[d][h]=b.readUshort();a+=2}b.position=e+2199+g;j.speed=b.readUbyte();this.songs[g]=j}b.clear()}}},process:{value:function(){for(var b,f,e,g,d,c,a=this.voices[3];a;){b=a.channel;d=0;do if(this.patterns.position=a.patternPos,c=a.sample,this.sampFlag=0,a.busy||(a.busy=1,0==c.loopPtr?(b.pointer=this.mixer.loopPtr,b.length=this.mixer.loopLen):0<c.loopPtr&&(b.pointer=c.type?a.synth:c.pointer+c.loopPtr,b.length=c.length-c.loopPtr)),
0==--a.tick)for(d=2;1<d;)if(e=this.patterns.readByte(),0>e)switch(e){case -125:a.sample=c=this.samples[this.patterns.readUbyte()];this.sampFlag=1;a.patternPos=this.patterns.position;break;case -126:this.speed=this.patterns.readUbyte();a.patternPos=this.patterns.position;break;case -127:e=c?c.relative:428;a.portaSpeed=this.patterns.readUbyte()*this.speed;a.portaNote=this.patterns.readUbyte();a.portaLimit=l[a.portaNote]*e>>10;a.portamento=0;a.portaDelay=this.patterns.readUbyte()*this.speed;a.portaFlag=
1;a.patternPos=this.patterns.position;break;case -124:b.enabled=0;a.tick=this.speed;a.busy=1;a.patternPos=this.patterns.position;d=0;break;case -128:for(a.trackPos++;;)if(e=this.song.tracks[a.index][a.trackPos],65535==e)this.mixer.complete=1;else if(32767<e)a.trackPos=(e^32768)>>1,this.loopSong||(this.complete&=~a.bitFlag,this.complete||(this.mixer.complete=1));else{a.patternPos=e;d=a.tick=1;break}break;default:a.tick=this.speed*-e,a.patternPos=this.patterns.position,d=0}else{d=0;a.patternPos=this.patterns.position;
a.note=e;a.arpeggioPos=0;a.vibratoFlag=-1;a.vibrato=0;a.arpeggioSpeed=c.arpeggioSpeed;a.vibratoDelay=c.vibratoDelay;a.vibratoSpeed=c.vibratoSpeed;a.vibratoDepth=c.vibratoDepth;if(1==c.type){if(this.sampFlag||c.synchro&2){a.pulseCounter=c.pulseCounter;a.pulseDelay=c.pulseDelay;a.pulseDir=0;a.pulsePos=c.pulsePosL;a.pulseSpeed=c.pulseSpeed;f=a.synth;for(g=f+c.pulsePosL;f<g;++f)this.mixer.memory[f]=c.pulseRateNeg;for(g+=c.length-c.pulsePosL;f<g;++f)this.mixer.memory[f]=c.pulseRatePos}b.pointer=a.synth}else if(2==
c.type){a.blendCounter=c.blendCounter;a.blendDelay=c.blendDelay;a.blendDir=0;a.blendPos=1;f=c.pointer;e=a.synth;for(g=f+31;f<g;++f)this.mixer.memory[e++]=this.mixer.memory[f];b.pointer=a.synth}else b.pointer=c.pointer;a.tick=this.speed;a.busy=0;a.period=l[a.note]*c.relative>>10;a.volume=0;a.envelopePos=0;a.sustainTime=c.sustainTime;b.length=c.length;b.period=a.period;b.volume=0;b.enabled=1;a.portaFlag&&!a.portamento&&(a.portamento=a.period,a.portaCounter=1,a.portaPeriod=a.portaLimit-a.period)}else 1==
a.tick&&(e=this.patterns.readAt(a.patternPos)-160&255,127<e&&(b.enabled=0));while(0<d);if(b.enabled){e=a.note+c.arpeggio[a.arpeggioPos];0==--a.arpeggioSpeed&&(a.arpeggioSpeed=c.arpeggioSpeed,++a.arpeggioPos==c.arpeggioLimit&&(a.arpeggioPos=0));a.period=l[e]*c.relative>>10;a.portaFlag&&(a.portaDelay?a.portaDelay--:(a.period+=a.portaCounter*a.portaPeriod/a.portaSpeed,++a.portaCounter>a.portaSpeed&&(a.note=a.portaNote,a.portaFlag=0)));a.vibratoDelay?a.vibratoDelay--:a.vibratoFlag&&(0>a.vibratoFlag?(a.vibrato+=
a.vibratoSpeed,a.vibrato==a.vibratoDepth&&(a.vibratoFlag^=2147483648)):(a.vibrato-=a.vibratoSpeed,0==a.vibrato&&(a.vibratoFlag^=2147483648)),0==a.vibrato&&(a.vibratoFlag^=1),a.period=a.vibratoFlag&1?a.period+a.vibrato:a.period-a.vibrato);b.period=a.period;switch(a.envelopePos){case 0:a.volume+=c.attackSpeed;a.volume>=c.attackVol&&(a.volume=c.attackVol,a.envelopePos=1);break;case 1:a.volume-=c.decaySpeed;a.volume<=c.decayVol&&(a.volume=c.decayVol,a.envelopePos=2);break;case 2:a.sustainTime?a.sustainTime--:
a.envelopePos=3;break;case 3:a.volume-=c.releaseSpeed,a.volume<=c.releaseVol&&(a.volume=c.releaseVol,a.envelopePos=4)}e=c.envelopeVol<<12;e>>=8;e>>=4;e*=a.volume;e>>=8;e>>=1;b.volume=e;if(1==c.type)if(a.pulseDelay)a.pulseDelay--;else if(a.pulseSpeed)a.pulseSpeed--;else{if(a.pulseCounter||!(c.synchro&1)){a.pulseSpeed=c.pulseSpeed;if(a.pulseDir&4)for(;;){if(a.pulsePos>=c.pulsePosL){d=1;break}a.pulseDir&=-5;a.pulsePos++;a.pulseCounter--;if(a.pulsePos<=c.pulsePosH){d=2;break}a.pulseDir|=4;a.pulsePos--;
a.pulseCounter--}else for(;;){if(a.pulsePos<=c.pulsePosH){d=2;break}a.pulseDir|=4;a.pulsePos--;a.pulseCounter--;if(a.pulsePos>=c.pulsePosL){d=1;break}a.pulseDir&=-5;a.pulsePos++;a.pulseCounter++}b=a.synth+a.pulsePos;1==d?(this.mixer.memory[b]=c.pulseRatePos,a.pulsePos--):(this.mixer.memory[b]=c.pulseRateNeg,a.pulsePos++)}}else if(2==c.type)if(a.blendDelay)a.blendDelay--;else if(a.blendCounter||!(c.synchro&4)){a.blendDir?1!=a.blendPos?a.blendPos--:(a.blendDir^=1,a.blendCounter--):a.blendPos!=c.blendRate<<
1?a.blendPos++:(a.blendDir^=1,a.blendCounter--);f=c.pointer;g=f+31;for(b=g+1;f<g;++f)e=a.blendPos*this.mixer.memory[b++]>>c.blendRate,this.mixer.memory[b++]=e+this.mixer.memory[f]}}a=a.next}}}});i.voices[3]=k(3,8);i.voices[3].next=i.voices[2]=k(2,4);i.voices[2].next=i.voices[1]=k(1,2);i.voices[1].next=i.voices[0]=k(0,1);return Object.seal(i)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.1 - 2012/04/14

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function i(g){return Object.create(null,{index:{value:g,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume:{value:0,writable:!0},last:{value:0,writable:!0},slideCtr:{value:0,writable:!0},slideDir:{value:0,writable:!0},slideParam:{value:0,writable:!0},slidePeriod:{value:0,writable:!0},slideSpeed:{value:0,writable:!0},
stepPeriod:{value:0,writable:!0},stepSpeed:{value:0,writable:!0},stepWanted:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.stepWanted=this.stepSpeed=this.stepPeriod=this.slideSpeed=this.slidePeriod=this.slideParam=this.slideDir=this.slideCtr=this.last=this.volume=this.param=this.effect=this.period=this.enabled=0}}})}var j=[1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,
151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,-1];window.neoart.FXPlayer=function(g){g=AmigaPlayer(g);Object.defineProperties(g,{id:{value:"FXPlayer"},standard:{value:0,writable:!0},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},
delphine:{value:0,writable:!0},force:{set:function(b){1>b?b=1:4<b&&(b=4);this.version=b}},ntsc:{set:function(b){this.standard=b;this.frequency(b);b=(b?20.44952532:20.637767904)*(this.sampleRate/1E3)/120;this.mixer.samplesTick=this.tempo/122*b>>0}},initialize:{value:function(){var b=this.voices[0];this.reset();this.ntsc=this.standard;this.speed=6;for(this.jumpFlag=this.patternPos=this.trackPos=0;b;)b.initialize(),b.channel=this.mixer.channels[b.index],b.sample=this.samples[0],b=b.next}},loader:{value:function(b){var d=
0,c,a,e,f,g=0,h;if(!(1686>b.length)){b.position=60;c=b.readString(4);if("SONG"!=c){b.position=124;c=b.readString(4);if("SO31"!=c||2350>b.length)return;e=544;this.samples.length=a=32;this.version=4}else e=0,this.samples.length=a=16,this.version=1;this.tempo=b.readUshort();b.position=0;for(c=1;c<a;++c)(h=b.readUint())?(f=AmigaSample(),f.pointer=g,g+=h,this.samples[c]=f):this.samples[c]=null;b.position+=20;for(c=1;c<a;++c)(f=this.samples[c])?(f.name=b.readString(22),f.length=b.readUshort()<<1,f.volume=
b.readUshort(),f.loop=b.readUshort(),f.repeat=b.readUshort()<<1):b.position+=30;b.position=530+e;this.length=a=b.readUbyte();b.position++;for(c=0;c<a;++c)h=b.readUbyte()<<8,this.track[c]=h,h>d&&(d=h);e&&(e+=4);b.position=660+e;d+=256;this.patterns.length=d;a=this.samples.length;for(c=0;c<d;++c){e=AmigaRow();e.note=b.readShort();h=b.readUbyte();e.param=b.readUbyte();e.effect=h&15;e.sample=h>>4;this.patterns[c]=e;if(4==this.version)e.note&4096&&(e.sample+=16,0<e.note&&(e.note&=61439));else{if(9==e.effect||
856<e.note)this.version=2;-3>e.note&&(this.version=3)}if(e.sample>=a||null==this.samples[e.sample])e.sample=0}this.mixer.store(b,g);for(c=1;c<a;++c)if(f=this.samples[c]){f.loop?f.loopPtr=f.pointer+f.loop:(f.loopPtr=this.mixer.memory.length,f.repeat=2);g=f.pointer+4;for(d=f.pointer;d<g;++d)this.mixer.memory[d]=0}f=AmigaSample();f.pointer=f.loopPtr=this.mixer.memory.length;f.length=f.repeat=2;this.samples[0]=f;for(c=b.position=d=this.delphine=0;265>c;++c)d+=b.readUshort();switch(d){case 172662:case 1391423:case 1458300:case 1706977:case 1920077:case 1920694:case 1677853:case 1931956:case 1926836:case 1385071:case 1720635:case 1714491:case 1731874:case 1437490:this.delphine=
1}}}},process:{value:function(){var b,d,c,a=this.voices[0];if(this.tick)for(;a;){b=a.channel;if(!(2==this.version&&-3==a.period))if(a.stepSpeed)a.stepPeriod+=a.stepSpeed,0>a.stepSpeed?a.stepPeriod<a.stepWanted&&(a.stepPeriod=a.stepWanted,2<this.version&&(a.stepSpeed=0)):a.stepPeriod>a.stepWanted&&(a.stepPeriod=a.stepWanted,2<this.version&&(a.stepSpeed=0)),2<this.version&&(a.last=a.stepPeriod),b.period=a.stepPeriod;else{if(a.slideSpeed&&(c=a.slideParam&15))if(++a.slideCtr==c)a.slideCtr=0,c=a.slideParam<<
4<<3,a.slideDir?(a.slidePeriod-=8,b.period=a.slidePeriod,c-=a.slideSpeed,c==a.slidePeriod&&(a.slideDir=0)):(a.slidePeriod+=8,b.period=a.slidePeriod,c+=a.slideSpeed,c==a.slidePeriod&&(a.slideDir=1));else{a=a.next;continue}c=0;switch(a.effect){case 1:c=this.tick%3;d=0;if(2==c){b.period=a.last;a=a.next;continue}for(c=1==c?a.param&15:a.param>>4;a.last!=j[d];)d++;b.period=j[d+c];break;case 2:c=a.param>>4;a.period=c?a.period+c:a.period-(a.param&15);b.period=a.period;break;case 3:this.mixer.filter.active=
1;break;case 4:this.mixer.filter.active=0;break;case 8:c=-1;case 7:a.stepSpeed=a.param&15;a.stepPeriod=2<this.version?a.last:a.period;0>c&&(a.stepSpeed=-a.stepSpeed);for(d=0;;){b=j[d];if(b==a.stepPeriod)break;if(0>b){d=-1;break}else d++}-1<d?(b=a.param>>4,-1<c&&(b=-b),d+=b,0>d&&(d=0),a.stepWanted=j[d]):a.stepWanted=a.period;break;case 9:a.slideSpeed=a.slidePeriod=a.period,a.slideParam=a.param,a.slideDir=0,a.slideCtr=0}}a=a.next}else for(c=this.track[this.trackPos]+this.patternPos;a;){b=a.channel;
a.enabled=0;d=this.patterns[c+a.index];a.period=d.note;a.effect=d.effect;a.param=d.param;if(-3==d.note)a.effect=0;else if(d.sample?(d=a.sample=this.samples[d.sample],a.volume=d.volume,5==a.effect?a.volume+=a.param:6==a.effect&&(a.volume-=a.param),b.volume=a.volume):d=a.sample,a.period){a.last=a.period;a.slideSpeed=0;a.stepSpeed=0;a.enabled=1;b.enabled=0;switch(a.period){case -2:b.volume=0;break;case -4:this.jumpFlag=1;break;case -5:break;default:b.pointer=d.pointer,b.length=d.length,b.period=this.delphine?
a.period<<1:a.period}a.enabled&&(b.enabled=1);b.pointer=d.loopPtr;b.length=d.repeat}a=a.next}if(++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag))this.patternPos=this.jumpFlag=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1)}}});g.voices[0]=i(0);g.voices[0].next=g.voices[1]=i(1);g.voices[1].next=g.voices[2]=i(2);g.voices[2].next=g.voices[3]=i(3);g.track=new Uint16Array(128);return Object.seal(g)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.1 - 2012/04/17

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function j(h){return Object.create(null,{index:{value:h,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume1:{value:0,writable:!0},volume2:{value:0,writable:!0},handler:{value:0,writable:!0},portaDir:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},
vibratoSpeed:{value:0,writable:!0},wavePos:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.wavePos=this.vibratoSpeed=this.vibratoPos=this.portaSpeed=this.portaPeriod=this.portaDir=this.handler=this.volume2=this.volume1=this.param=this.effect=this.period=this.enabled=0}}})}function l(){var h=AmigaSample();Object.defineProperties(h,{finetune:{value:0,writable:!0},restart:{value:0,writable:!0},waveLen:{value:0,writable:!0},waves:{value:null,writable:!0},volumes:{value:null,
writable:!0}});return Object.seal(h)}var m=[0,3,7,12,15,12,7,3,0,3,7,12,15,12,7,3,0,4,7,12,16,12,7,4,0,4,7,12,16,12,7,4,0,3,8,12,15,12,8,3,0,3,8,12,15,12,8,3,0,4,8,12,16,12,8,4,0,4,8,12,16,12,8,4,0,5,8,12,17,12,8,5,0,5,8,12,17,12,8,5,0,5,9,12,17,12,9,5,0,5,9,12,17,12,9,5,12,0,7,0,3,0,7,0,12,0,7,0,3,0,7,0,12,0,7,0,4,0,7,0,12,0,7,0,4,0,7,0,0,3,7,3,7,12,7,12,15,12,7,12,7,3,7,3,0,4,7,4,7,12,7,12,16,12,7,12,7,4,7,4,31,27,24,19,15,12,7,3,0,3,7,12,15,19,24,27,31,28,24,19,16,12,7,4,0,4,7,12,16,19,24,28,0,
12,0,12,0,12,0,12,0,12,0,12,0,12,0,12,0,12,24,12,0,12,24,12,0,12,24,12,0,12,24,12,0,3,0,3,0,3,0,3,0,3,0,3,0,3,0,3,0,4,0,4,0,4,0,4,0,4,0,4,0,4,0,4],k=[856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0],n=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,212,197,180,161,141,120,97,74,49,24];window.neoart.HMPlayer=function(h){h=AmigaPlayer(h);Object.defineProperties(h,{id:{value:"HMPlayer"},
track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},restart:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},initialize:{value:function(){var a=this.voices[0];this.reset();this.speed=6;this.jumpFlag=this.patternPos=this.trackPos=0;for(this.mixer.samplesTick=884;a;)a.initialize(),a.channel=this.mixer.channels[a.index],a.sample=this.samples[0],
a=a.next}},loader:{value:function(a){var c=0,f=0,d,e,b,g=0,h=0,i;if(!(2106>a.length)&&(a.position=1080,e=a.readString(4),"FEST"==e)){a.position=950;this.length=a.readUbyte();this.restart=a.readUbyte();for(d=0;128>d;++d)this.track[d]=a.readUbyte();a.position=0;this.title=a.readString(20);for(d=this.version=1;32>d;++d){this.samples[d]=null;e=a.readString(4);if("Mupp"==e){i=a.readUbyte();c=i-f++;for(b=0;128>b;++b)this.track[b]&&this.track[b]>=c&&this.track[b]--;c=l();c.name=e;c.length=c.repeat=32;c.restart=
a.readUbyte();c.waveLen=a.readUbyte();a.position+=17;c.finetune=a.readByte();c.volume=a.readUbyte();e=a.position+4;i=1084+(i<<10);a.position=i;c.pointer=this.mixer.memory.length;c.waves=new Uint16Array(64);c.volumes=new Uint8Array(64);this.mixer.store(a,896);for(b=0;64>b;++b)c.waves[b]=a.readUbyte()<<5;for(b=0;64>b;++b)c.volumes[b]=a.readUbyte()&127;a.position=i;a.writeInt(1718382436);a.position=e;g+=896}else{e=e.substr(0,2);"El"==e?a.position+=18:(a.position-=4,e=a.readString(22));i=a.readUshort();
if(!i){a.position+=6;continue}c=l();c.name=e;c.pointer=h;c.length=i<<1;c.finetune=a.readByte();c.volume=a.readUbyte();c.loop=a.readUshort()<<1;c.repeat=a.readUshort()<<1;h+=c.length}this.samples[d]=c}for(d=0;128>d;++d)i=this.track[d]<<8,this.track[d]=i,i>f&&(f=i);a.position=1084;f+=256;this.patterns.length=f;for(d=0;d<f;++d){for(i=a.readUint();1718382436==i;)a.position+=1020,i=a.readUint();b=AmigaRow();b.note=i>>16&4095;b.sample=i>>24&240|i>>12&15;b.effect=i>>8&15;b.param=i&255;if(31<b.sample||!this.samples[b.sample])b.sample=
0;this.patterns[d]=b}this.mixer.store(a,h);for(d=1;32>d;++d)if(c=this.samples[d],!(null==c||"Mupp"==c.name)){c.pointer+=g;c.loop?(c.loopPtr=c.pointer+c.loop,c.length=c.loop+c.repeat):(c.loopPtr=this.mixer.memory.length,c.repeat=2);h=c.pointer+4;for(b=c.pointer;b<h;++b)this.mixer.memory[b]=0}c=l();c.pointer=c.loopPtr=this.mixer.memory.length;c.length=c.repeat=2;this.samples[0]=c}}},process:{value:function(){var a,c,f,d,e,b=this.voices[0];if(this.tick)for(;b;)this.effects(b),this.handler(b),d=b.sample,
b.channel.pointer=d.loopPtr,b.channel.length=d.repeat,b=b.next;else for(c=this.track[this.trackPos]+this.patternPos;b;){a=b.channel;b.enabled=0;f=this.patterns[c+b.index];b.effect=f.effect;b.param=f.param;f.sample?(d=b.sample=this.samples[f.sample],b.volume2=d.volume,"Mupp"==d.name?(d.loopPtr=d.pointer+d.waves[0],b.handler=1,b.volume1=d.volumes[0]):(b.handler=0,b.volume1=64)):d=b.sample;f.note&&(3==b.effect||5==b.effect?f.note<b.period?(b.portaDir=1,b.portaPeriod=f.note):f.note>b.period?(b.portaDir=
0,b.portaPeriod=f.note):b.portaPeriod=0:(b.period=f.note,b.vibratoPos=0,b.wavePos=0,b.enabled=1,a.enabled=0,e=b.period*d.finetune>>8,a.period=b.period+e,b.handler?(a.pointer=d.loopPtr,a.length=d.repeat):(a.pointer=d.pointer,a.length=d.length)));switch(b.effect){case 11:this.trackPos=b.param-1;this.jumpFlag=1;break;case 12:b.volume2=b.param;64<b.volume2&&(b.volume2=64);break;case 13:this.jumpFlag=1;break;case 14:this.mixer.filter.active=b.param^1;break;case 15:e=b.param,1>e?e=1:31<e&&(e=31),this.speed=
e,this.tick=0}f.note||this.effects(b);this.handler(b);b.enabled&&(a.enabled=1);a.pointer=d.loopPtr;a.length=d.repeat;b=b.next}if(++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag))this.patternPos=this.jumpFlag=0,this.trackPos=++this.trackPos&127,this.trackPos==this.length&&(this.trackPos=this.restart,this.mixer.complete=1)}},effects:{value:function(a){var c=a.channel,f,d,e=a.period&4095,b,g;if(a.effect||a.param)switch(a.effect){case 0:g=this.tick%3;if(!g)break;
g=1==g?a.param>>4:a.param&15;d=37-g;for(f=0;f<d;++f)if(e>=k[f]){e=k[f+g];break}break;case 1:a.period-=a.param;113>a.period&&(a.period=113);e=a.period;break;case 2:a.period+=a.param;856<a.period&&(a.period=856);e=a.period;break;case 3:case 5:5==a.effect?b=1:a.param&&(a.portaSpeed=a.param,a.param=0);a.portaPeriod&&(a.portaDir?(a.period-=a.portaSpeed,a.period<a.portaPeriod&&(a.period=a.portaPeriod,a.portaPeriod=0)):(a.period+=a.portaSpeed,a.period>a.portaPeriod&&(a.period=a.portaPeriod,a.portaPeriod=
0)));e=a.period;break;case 4:case 6:6==a.effect?b=1:a.param&&(a.vibratoSpeed=a.param);g=n[a.vibratoPos>>2&31];g=(a.vibratoSpeed&15)*g>>7;e=127<a.vibratoPos?e-g:e+g;g=a.vibratoSpeed>>2&60;a.vibratoPos=a.vibratoPos+g&255;break;case 7:g=m[(a.vibratoPos&15)+((a.param&15)<<4)];a.vibratoPos++;for(f=0;37>f&&!(e>=k[f]);++f);g+=f;35<g&&(g-=12);e=k[g];break;case 10:b=1}c.period=e+(e*a.sample.finetune>>8);b&&(g=a.param>>4,a.volume2=g?a.volume2+g:a.volume2-(a.param&15),64<a.volume2?a.volume2=64:0>a.volume2&&
(a.volume2=0))}},handler:{value:function(a){var c;a.handler&&(c=a.sample,c.loopPtr=c.pointer+c.waves[a.wavePos],a.volume1=c.volumes[a.wavePos],++a.wavePos>c.waveLen&&(a.wavePos=c.restart));a.channel.volume=a.volume1*a.volume2>>6}}});h.voices[0]=j(0);h.voices[0].next=h.voices[1]=j(1);h.voices[1].next=h.voices[2]=j(2);h.voices[2].next=h.voices[3]=j(3);h.track=new Uint16Array(128);return Object.seal(h)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.0 - 2012/03/26

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function i(h){return Object.create(null,{index:{value:h,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},enabled:{value:0,writable:!0},cosoCounter:{value:0,writable:!0},cosoSpeed:{value:0,writable:!0},trackPtr:{value:0,writable:!0},trackPos:{value:0,writable:!0},trackTransp:{value:0,writable:!0},patternPtr:{value:0,writable:!0},patternPos:{value:0,writable:!0},frqseqPtr:{value:0,writable:!0},frqseqPos:{value:0,writable:!0},volseqPtr:{value:0,writable:!0},volseqPos:{value:0,
writable:!0},sample:{value:0,writable:!0},loopPtr:{value:0,writable:!0},repeat:{value:0,writable:!0},tick:{value:0,writable:!0},note:{value:0,writable:!0},transpose:{value:0,writable:!0},info:{value:0,writable:!0},infoPrev:{value:0,writable:!0},volume:{value:0,writable:!0},volCounter:{value:0,writable:!0},volSpeed:{value:0,writable:!0},volSustain:{value:0,writable:!0},volTransp:{value:0,writable:!0},volFade:{value:0,writable:!0},portaDelta:{value:0,writable:!0},vibrato:{value:0,writable:!0},vibDelay:{value:0,
writable:!0},vibDelta:{value:0,writable:!0},vibDepth:{value:0,writable:!0},vibSpeed:{value:0,writable:!0},slide:{value:0,writable:!0},sldActive:{value:0,writable:!0},sldDone:{value:0,writable:!0},sldCounter:{value:0,writable:!0},sldSpeed:{value:0,writable:!0},sldDelta:{value:0,writable:!0},sldPointer:{value:0,writable:!0},sldLen:{value:0,writable:!0},sldEnd:{value:0,writable:!0},sldLoopPtr:{value:0,writable:!0},initialize:{value:function(){this.channel=null;this.trackPtr=this.cosoSpeed=this.cosoCounter=
this.enabled=0;this.trackPos=12;this.volseqPos=this.volseqPtr=this.frqseqPos=this.frqseqPtr=this.patternPos=this.patternPtr=this.trackTransp=0;this.sample=-1;this.volume=this.infoPrev=this.info=this.transpose=this.note=this.tick=this.repeat=this.loopPtr=0;this.volSpeed=this.volCounter=1;this.volTransp=this.volSustain=0;this.volFade=100;this.sldLoopPtr=this.sldEnd=this.sldLen=this.sldPointer=this.sldDelta=this.sldSpeed=this.sldCounter=this.sldDone=this.sldActive=this.slide=this.vibSpeed=this.vibDepth=
this.vibDelta=this.vibDelay=this.vibrato=this.portaDelta=0}}})}var j=[1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1812,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3624];window.neoart.JHPlayer=function(h){h=AmigaPlayer(h);Object.defineProperties(h,
{id:{value:"JHPlayer"},songs:{value:[],writable:!0},samples:{value:[],writable:!0},stream:{value:null,writable:!0},base:{value:0,writable:!0},patterns:{value:0,writable:!0},patternLen:{value:0,writable:!0},periods:{value:0,writable:!0},frqseqs:{value:0,writable:!0},volseqs:{value:0,writable:!0},samplesData:{value:0,writable:!0},song:{value:null,writable:!0},voices:{value:[],writable:!0},coso:{value:0,writable:!0},variant:{value:0,writable:!0},initialize:{value:function(){var c=this.voices[0];this.reset();
this.song=this.songs[this.playSong];this.speed=this.song.speed;for(this.tick=this.coso||1<this.variant?1:this.speed;c;)c.initialize(),c.channel=this.mixer.channels[c.index],c.trackPtr=this.song.pointer+3*c.index,this.coso?(c.trackPos=0,c.patternPos=8):(this.stream.position=c.trackPtr,c.patternPtr=this.patterns+this.stream.readUbyte()*this.patternLen,c.trackTransp=this.stream.readByte(),c.volTransp=this.stream.readByte(),c.frqseqPtr=this.base,c.volseqPtr=this.base),c=c.next}},loader:{value:function(c){var d=0,
e,g,f,b,a,h;this.base=this.periods=0;if(this.coso="COSO"==c.readString(4)){for(e=0;7>e;++e)d+=c.readInt();16942==d&&(c.position=47,d+=c.readUbyte());switch(d){case 22666:case 18842:case 30012:case 22466:case 3546:this.variant=1;break;case 16948:case 18332:case 13698:this.variant=2;break;case 18546:case 13926:case 8760:case 17242:case 11394:case 14494:case 14392:case 13576:case 6520:this.variant=3;break;default:this.variant=4}this.version=2;c.position=4;this.frqseqs=c.readUint();this.volseqs=c.readUint();
this.patterns=c.readUint();h=c.readUint();a=c.readUint();d=c.readUint();this.samplesData=c.readUint();c.position=0;c.writeInt(16777216);c.writeInt(225);c.writeShort(65535);f=(this.samplesData-d)/10-1;this.lastSong=(d-a)/6}else{for(;12<c.bytesAvailable;)switch(d=c.readUshort(),d){case 576:d=c.readUshort();127==d&&(c.position+=2,this.periods=c.position+c.readUshort());break;case 28674:case 28675:this.channels=d&255;d=c.readUshort();30208==d&&(d=c.readUshort());16890==d&&(c.position+=4,this.base=c.position+
c.readUshort());break;case 21574:d=c.readUshort(),19800==d&&(g=c.position-4,c.position=c.length)}if(!g||!this.base||!this.periods)return;this.version=1;c.position=g+4;this.frqseqs=e=g+32;d=c.readUshort();this.volseqs=e+=++d<<6;d=c.readUshort();this.patterns=e+=++d<<6;d=c.readUshort();c.position+=2;this.patternLen=c.readUshort();h=e+=++d*this.patternLen;c.position-=4;d=c.readUshort();a=e+=12*++d;c.position=g+16;this.lastSong=c.readUshort();d=e+=6*++this.lastSong;f=c.readUshort();this.samplesData=e+
30*f}c.position=d;this.samples=[];for(e=d=0;e<f;++e)b=AmigaSample(),this.coso||(b.name=c.readString(18)),b.pointer=c.readUint(),b.length=c.readUshort()<<1,this.coso||(b.volume=c.readUshort()),b.loopPtr=c.readUshort()+b.pointer,b.repeat=c.readUshort()<<1,b.loopPtr&1&&b.loopPtr--,d+=b.length,this.samples[e]=b;c.position=this.samplesData;this.mixer.store(c,d);c.position=a;this.songs=[];for(e=d=0;e<this.lastSong;++e)f=Object.create(null,{pointer:{value:0,writable:!0},speed:{value:0,writable:!0},length:{value:0,
writable:!0}}),f.pointer=c.readUshort(),f.length=c.readUshort()-f.pointer+1,f.speed=c.readUshort(),f.pointer=12*f.pointer+h,f.length*=12,12<f.length&&(this.songs[d++]=f);this.lastSong=this.songs.length-1;if(!this.coso){c.position=0;for(this.variant=1;c.position<g;)if(d=c.readUshort(),45116==d||3072==d){if(d=c.readUshort(),229==d||230==d||233==d){this.variant=2;break}}else if(20219==d){this.variant=3;break}}this.stream=c}},process:{value:function(){var c,d,e,g,f,b,a=this.voices[0];if(0==--this.tick){for(this.tick=
this.speed;a;){c=a.channel;if(this.coso){if(0>--a.cosoCounter){a.cosoCounter=a.cosoSpeed;do{this.stream.position=a.patternPos;do if(d=0,b=this.stream.readByte(),-1==b)a.trackPos==this.song.length&&(a.trackPos=0,this.mixer.complete=1),this.stream.position=a.trackPtr+a.trackPos,b=this.stream.readUbyte(),a.trackTransp=this.stream.readByte(),e=this.stream.readAt(this.stream.position),3<this.variant&&127<e?(g=e>>4&15,e&=15,15==g?(g=100,e&&(g=15-e+1,e=g<<=1,g<<=1,g+=e),a.volFade=g):8==g?this.mixer.complete=
1:14==g&&(this.speed=e)):a.volTransp=this.stream.readByte(),this.stream.position=this.patterns+(b<<1),a.patternPos=this.stream.readUshort(),a.trackPos+=12,d=1;else if(-2==b)a.cosoCounter=a.cosoSpeed=this.stream.readUbyte(),d=3;else if(-3==b)a.cosoCounter=a.cosoSpeed=this.stream.readUbyte(),a.patternPos=this.stream.position;else if(a.note=b,a.info=this.stream.readByte(),a.info&224&&(a.infoPrev=this.stream.readByte()),a.patternPos=this.stream.position,a.portaDelta=0,0<=b)if(1==this.variant&&(c.enabled=
0),b=(a.info&31)+a.volTransp,this.stream.position=this.volseqs+(b<<1),this.stream.position=this.stream.readUshort(),a.volCounter=a.volSpeed=this.stream.readUbyte(),a.volSustain=0,b=this.stream.readByte(),a.vibSpeed=this.stream.readByte(),a.vibrato=64,a.vibDepth=a.vibDelta=this.stream.readByte(),a.vibDelay=this.stream.readUbyte(),a.volseqPtr=this.stream.position,a.volseqPos=0,-128!=b)1<this.variant&&a.info&64&&(b=a.infoPrev),this.stream.position=this.frqseqs+(b<<1),a.frqseqPtr=this.stream.readUshort(),
a.frqseqPos=0,a.tick=0;while(2<d)}while(0<d)}}else{this.stream.position=a.patternPtr+a.patternPos;b=this.stream.readByte();if(a.patternPos==this.patternLen||1==(b&127))a.trackPos==this.song.length&&(a.trackPos=0,this.mixer.complete=1),this.stream.position=a.trackPtr+a.trackPos,b=this.stream.readUbyte(),a.trackTransp=this.stream.readByte(),a.volTransp=this.stream.readByte(),-128==a.volTransp&&(this.mixer.complete=1),a.patternPtr=this.patterns+b*this.patternLen,a.patternPos=0,a.trackPos+=12,this.stream.position=
a.patternPtr,b=this.stream.readByte();if(b&127&&(a.note=b&127,a.portaDelta=0,e=this.stream.position,a.patternPos||(this.stream.position+=this.patternLen),this.stream.position-=2,a.infoPrev=this.stream.readByte(),this.stream.position=e,a.info=this.stream.readByte(),0<=b))1==this.variant&&(c.enabled=0),b=(a.info&31)+a.volTransp,this.stream.position=this.volseqs+(b<<6),a.volCounter=a.volSpeed=this.stream.readUbyte(),a.volSustain=0,b=this.stream.readByte(),a.vibSpeed=this.stream.readByte(),a.vibrato=
64,a.vibDepth=a.vibDelta=this.stream.readByte(),a.vibDelay=this.stream.readUbyte(),a.volseqPtr=this.stream.position,a.volseqPos=0,1<this.variant&&a.info&64&&(b=a.infoPrev),a.frqseqPtr=this.frqseqs+(b<<6),a.frqseqPos=0,a.tick=0;a.patternPos+=2}a=a.next}a=this.voices[0]}for(;a;){c=a.channel;a.enabled=0;do if(d=0,a.tick)a.tick--;else{this.stream.position=a.frqseqPtr+a.frqseqPos;do{b=this.stream.readByte();if(-31==b)break;d=3;3==this.variant&&this.coso&&(-27==b?b=-30:-26==b&&(b=-28));switch(b){case -32:a.frqseqPos=
this.stream.readUbyte()&63;this.stream.position=a.frqseqPtr+a.frqseqPos;break;case -30:f=this.samples[this.stream.readUbyte()];a.sample=-1;a.loopPtr=f.loopPtr;a.repeat=f.repeat;a.enabled=1;c.enabled=0;c.pointer=f.pointer;c.length=f.length;a.volseqPos=0;a.volCounter=1;a.slide=0;a.frqseqPos+=2;break;case -29:a.vibSpeed=this.stream.readByte();a.vibDepth=this.stream.readByte();a.frqseqPos+=3;break;case -28:f=this.samples[this.stream.readUbyte()];a.loopPtr=f.loopPtr;a.repeat=f.repeat;c.pointer=f.pointer;
c.length=f.length;a.slide=0;a.frqseqPos+=2;break;case -27:if(2>this.variant)break;f=this.samples[this.stream.readUbyte()];c.enabled=0;a.enabled=1;2==this.variant?(e=this.stream.readUbyte()*f.length,a.loopPtr=f.loopPtr+e,a.repeat=f.repeat,c.pointer=f.pointer+e,c.length=f.length,a.frqseqPos+=3):(a.sldPointer=f.pointer,a.sldEnd=f.pointer+f.length,b=this.stream.readUshort(),a.sldLoopPtr=65535==b?f.length:b<<1,a.sldLen=this.stream.readUshort()<<1,a.sldDelta=this.stream.readShort()<<1,a.sldActive=0,a.sldCounter=
0,a.sldSpeed=this.stream.readUbyte(),a.slide=1,a.sldDone=0,a.frqseqPos+=9);a.volseqPos=0;a.volCounter=1;break;case -26:if(3>this.variant)break;a.sldLen=this.stream.readUshort()<<1;a.sldDelta=this.stream.readShort()<<1;a.sldActive=0;a.sldCounter=0;a.sldSpeed=this.stream.readUbyte();a.sldDone=0;a.frqseqPos+=6;break;case -25:1==this.variant?(a.frqseqPtr=this.frqseqs+(this.stream.readUbyte()<<6),a.frqseqPos=0,this.stream.position=a.frqseqPtr,d=3):(b=this.stream.readUbyte(),b!=a.sample&&(f=this.samples[b],
a.sample=b,a.loopPtr=f.loopPtr,a.repeat=f.repeat,a.enabled=1,c.enabled=0,c.pointer=f.pointer,c.length=f.length),a.volseqPos=0,a.volCounter=1,a.slide=0,a.frqseqPos+=2);break;case -24:a.tick=this.stream.readUbyte();a.frqseqPos+=2;d=1;break;case -23:if(2>this.variant)break;f=this.samples[this.stream.readUbyte()];a.sample=-1;a.enabled=1;g=this.stream.readUbyte();e=this.stream.position;c.enabled=0;this.stream.position=this.samplesData+f.pointer+4;b=24*this.stream.readUshort()+(this.stream.readUshort()<<
2);this.stream.position+=24*g;a.loopPtr=this.stream.readUint()&4294967294;c.length=(this.stream.readUint()&4294967294)-a.loopPtr;a.loopPtr+=f.pointer+b+8;c.pointer=a.loopPtr;a.repeat=2;this.stream.position=e;e=a.loopPtr+1;this.mixer.memory[e]=this.mixer.memory[a.loopPtr];a.volseqPos=0;a.volCounter=1;a.slide=0;a.frqseqPos+=3;break;default:a.transpose=b,a.frqseqPos++,d=0}}while(2<d)}while(0<d);a.slide&&!a.sldDone&&0>--a.sldCounter&&(a.sldCounter=a.sldSpeed,a.sldActive?(b=a.sldLoopPtr+a.sldDelta,0>b?
(a.sldDone=1,b=a.sldLoopPtr-a.sldDelta):(e=a.sldPointer+a.sldLen+b,e>a.sldEnd&&(a.sldDone=1,b=a.sldLoopPtr-a.sldDelta)),a.sldLoopPtr=b):a.sldActive=1,a.loopPtr=a.sldPointer+a.sldLoopPtr,a.repeat=a.sldLen,c.pointer=a.loopPtr,c.length=a.repeat);do if(d=0,a.volSustain)a.volSustain--;else{if(--a.volCounter)break;a.volCounter=a.volSpeed;do{this.stream.position=a.volseqPtr+a.volseqPos;b=this.stream.readByte();if(-25>=b&&-31<=b)break;switch(b){case -24:a.volSustain=this.stream.readUbyte();a.volseqPos+=2;
d=1;break;case -32:a.volseqPos=(this.stream.readUbyte()&63)-5;d=3;break;default:a.volume=b,a.volseqPos++,d=0}}while(2<d)}while(0<d);b=a.transpose;0<=b&&(b+=a.note+a.trackTransp);b&=127;this.coso?(83<b&&(b=0),d=j[b],b<<=1):(b<<=1,this.stream.position=this.periods+b,d=this.stream.readUshort());if(a.vibDelay)a.vibDelay--;else if(3<this.variant)a.vibrato&32?(b=a.vibDelta+a.vibSpeed,b>a.vibDepth&&(a.vibrato&=-33,b=a.vibDepth)):(b=a.vibDelta-a.vibSpeed,0>b&&(a.vibrato|=32,b=0)),a.vibDelta=b,b=(b-(a.vibDepth>>
1))*d,d+=b>>10;else if(2<this.variant)b=a.vibSpeed,0>b&&(b&=127,a.vibrato^=1),a.vibrato&1||(a.vibrato&32?(a.vibDelta+=b,e=a.vibDepth<<1,a.vibDelta>e&&(a.vibrato&=-33,a.vibDelta=e)):(a.vibDelta-=b,0>a.vibDelta&&(a.vibrato|=32,a.vibDelta=0))),d+=b-a.vibDepth;else{if(0<=a.vibrato||!(a.vibrato&1))a.vibrato&32?(a.vibDelta+=a.vibSpeed,e=a.vibDepth<<1,a.vibDelta>=e&&(a.vibrato&=-33,a.vibDelta=e)):(a.vibDelta-=a.vibSpeed,0>a.vibDelta&&(a.vibrato|=32,a.vibDelta=0));if(e=a.vibDelta-a.vibDepth){for(b+=160;256>
b;)e+=e,b+=24;d+=e}}3>this.variant&&(a.vibrato^=1);a.info&32&&(b=a.infoPrev,3<this.variant?0>b?(a.portaDelta+=-b,b=a.portaDelta*d,d+=b>>10):(a.portaDelta+=b,b=a.portaDelta*d,d-=b>>10):0>b?(a.portaDelta+=-b<<11,d+=a.portaDelta>>16):(a.portaDelta+=b<<11,d-=a.portaDelta>>16));b=3<this.variant?a.volFade*a.volume/100:a.volume;c.period=d;c.volume=b;a.enabled&&(c.enabled=1,c.pointer=a.loopPtr,c.length=a.repeat);a=a.next}}}});h.voices[0]=i(0);h.voices[0].next=h.voices[1]=i(1);h.voices[1].next=h.voices[2]=
i(2);h.voices[2].next=h.voices[3]=i(3);return Object.seal(h)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.1 - 2012/04/16

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function h(f){return Object.create(null,{index:{value:f,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume:{value:0,writable:!0},portaDir:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},initialize:{value:function(){this.sample=
this.channel=null;this.vibratoSpeed=this.vibratoPos=this.portaSpeed=this.portaPeriod=this.portaDir=this.volume=this.param=this.effect=this.period=this.enabled=0}}})}var i=[856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0],j=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,212,197,180,161,141,120,97,74,49,24];window.neoart.MKPlayer=function(f){f=AmigaPlayer(f);Object.defineProperties(f,
{id:{value:"MKPlayer"},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},restart:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},restartSave:{value:0,writable:!0},force:{set:function(b){1>b?b=1:5<b&&(b=5);this.version=b;this.vibratoDepth=5==b?6:7;3==b?(this.restartSave=this.restart,this.restart=
0):(this.restart=this.restartSave,this.restartSave=0)}},initialize:{value:function(){var b=this.voices[0];this.reset();this.force=this.version;this.speed=6;for(this.jumpFlag=this.patternPos=this.trackPos=0;b;)b.initialize(),b.channel=this.mixer.channels[b.index],b.sample=this.samples[0],b=b.next}},loader:{value:function(b){var f=0,e,c,d=0,g;if(!(2106>b.length)&&(b.position=1080,e=b.readString(4),!("M.K."!=e&&"FLT4"!=e))){b.position=0;this.title=b.readString(20);this.version=1;b.position+=22;for(e=
1;32>e;++e)(g=b.readUshort())?(c=AmigaSample(),b.position-=24,c.name=b.readString(22),c.length=g<<1,b.position+=3,c.volume=b.readUbyte(),c.loop=b.readUshort()<<1,c.repeat=b.readUshort()<<1,b.position+=22,c.pointer=d,d+=c.length,this.samples[e]=c,32768<c.length&&(this.version=2)):(this.samples[e]=null,b.position+=28);b.position=950;this.length=b.readUbyte();g=b.readUbyte();this.restart=g<length?g:0;for(e=0;128>e;++e)g=b.readUbyte()<<8,this.track[e]=g,g>f&&(f=g);b.position=1084;f+=256;this.patterns.length=
f;for(e=0;e<f;++e){c=AmigaRow();g=b.readUint();c.note=g>>16&4095;c.effect=g>>8&15;c.sample=g>>24&240|g>>12&15;c.param=g&255;this.patterns[e]=c;if(31<c.sample||!this.samples[c.sample])c.sample=0;if(3==c.effect||4==c.effect)this.version=3;if(5==c.effect||6==c.effect)this.version=5;if(6<c.effect&&10>c.effect){this.version=0;return}}this.mixer.store(b,d);for(e=1;32>e;++e)if(c=this.samples[e]){-1<c.name.indexOf("2.0")&&(this.version=5);c.loop?(c.loopPtr=c.pointer+c.loop,c.length=c.loop+c.repeat):(c.loopPtr=
this.mixer.memory.length,c.repeat=2);d=c.pointer+4;for(b=c.pointer;b<d;++b)this.mixer.memory[b]=0}c=AmigaSample();c.pointer=c.loopPtr=this.mixer.memory.length;c.length=c.repeat=2;this.samples[0]=c;5>this.version&&this.restart&&(this.version=4)}}},process:{value:function(){var b,f,e,c,d,g,a=this.voices[0];if(this.tick)for(;a;){b=a.channel;if(!a.effect&&!a.param)b.period=a.period;else{switch(a.effect){case 0:d=this.tick%3;if(!d){b.period=a.period;a=a.next;continue}d=1==d?a.param>>4:a.param&15;c=a.period&
4095;e=37-d;for(f=0;f<e;++f)if(c>=i[f]){b.period=i[f+d];break}break;case 1:a.period-=a.param;113>a.period&&(a.period=113);b.period=a.period;break;case 2:a.period+=a.param;856<a.period&&(a.period=856);b.period=a.period;break;case 3:case 5:5==a.effect?g=1:a.param&&(a.portaSpeed=a.param,a.param=0);a.portaPeriod&&(a.portaDir?(a.period-=a.portaSpeed,a.period<=a.portaPeriod&&(a.period=a.portaPeriod,a.portaPeriod=0)):(a.period+=a.portaSpeed,a.period>=a.portaPeriod&&(a.period=a.portaPeriod,a.portaPeriod=
0)));b.period=a.period;break;case 4:case 6:6==a.effect?g=1:a.param&&(a.vibratoSpeed=a.param);d=a.vibratoPos>>2&31;d=(a.vibratoSpeed&15)*j[d]>>this.vibratoDepth;b.period=127<a.vibratoPos?a.period-d:a.period+d;d=a.vibratoSpeed>>2&60;a.vibratoPos=a.vibratoPos+d&255;break;case 10:g=1}g&&(d=a.param>>4,g=0,a.volume=d?a.volume+d:a.volume-(a.param&15),0>a.volume?a.volume=0:64<a.volume&&(a.volume=64),b.volume=a.volume)}a=a.next}else for(f=this.track[this.trackPos]+this.patternPos;a;){b=a.channel;a.enabled=
0;d=this.patterns[f+a.index];a.effect=d.effect;a.param=d.param;d.sample?(e=a.sample=this.samples[d.sample],b.volume=a.volume=e.volume):e=a.sample;d.note&&(3==a.effect||5==a.effect?d.note<a.period?(a.portaDir=1,a.portaPeriod=d.note):d.note>a.period?(a.portaDir=0,a.portaPeriod=d.note):a.portaPeriod=0:(a.enabled=1,a.vibratoPos=0,b.enabled=0,b.pointer=e.pointer,b.length=e.length,b.period=a.period=d.note));switch(a.effect){case 11:this.trackPos=a.param-1;this.jumpFlag^=1;break;case 12:b.volume=a.param;
5==this.version&&(a.volume=a.param);break;case 13:this.jumpFlag^=1;break;case 14:this.mixer.filter.active=a.param^1;break;case 15:d=a.param,1>d?d=1:31<d&&(d=31),this.speed=d,this.tick=0}a.enabled&&(b.enabled=1);b.pointer=e.loopPtr;b.length=e.repeat;a=a.next}if(++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag))this.patternPos=this.jumpFlag=0,this.trackPos=++this.trackPos&127,this.trackPos==this.length&&(this.trackPos=this.restart,this.mixer.complete=1)}}});
f.voices[0]=h(0);f.voices[0].next=f.voices[1]=h(1);f.voices[1].next=f.voices[2]=h(2);f.voices[2].next=f.voices[3]=h(3);f.track=new Uint16Array(128);return Object.seal(f)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.1 - 2012/04/16

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function i(g){return Object.create(null,{index:{value:g,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},loopCtr:{value:0,writable:!0},loopPos:{value:0,writable:!0},step:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume:{value:0,writable:!0},pointer:{value:0,writable:!0},length:{value:0,writable:!0},loopPtr:{value:0,writable:!0},repeat:{value:0,
writable:!0},finetune:{value:0,writable:!0},offset:{value:0,writable:!0},portaDir:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},glissando:{value:0,writable:!0},tremoloParam:{value:0,writable:!0},tremoloPos:{value:0,writable:!0},tremoloWave:{value:0,writable:!0},vibratoParam:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoWave:{value:0,writable:!0},funkPos:{value:0,writable:!0},funkSpeed:{value:0,writable:!0},funkWave:{value:0,writable:!0},initialize:{value:function(){this.sample=
this.channel=null;this.funkWave=this.funkSpeed=this.funkPos=this.vibratoWave=this.vibratoPos=this.vibratoParam=this.tremoloWave=this.tremoloPos=this.tremoloParam=this.glissando=this.portaSpeed=this.portaPeriod=this.portaDir=this.offset=this.finetune=this.repeat=this.loopPtr=this.length=this.pointer=this.volume=this.param=this.effect=this.period=this.step=this.loopPos=this.loopCtr=this.enabled=0}}})}function j(){var g=AmigaSample();Object.defineProperties(g,{finetune:{value:0,writable:!0},realLen:{value:0,
writable:!0}});return Object.seal(g)}var h=[856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0,850,802,757,715,674,637,601,567,535,505,477,450,425,401,379,357,337,318,300,284,268,253,239,225,213,201,189,179,169,159,150,142,134,126,119,113,0,844,796,752,709,670,632,597,563,532,502,474,447,422,398,376,355,335,316,298,282,266,251,237,224,211,199,188,177,167,158,149,141,133,125,118,112,0,838,791,746,704,665,
628,592,559,528,498,470,444,419,395,373,352,332,314,296,280,264,249,235,222,209,198,187,176,166,157,148,140,132,125,118,111,0,832,785,741,699,660,623,588,555,524,495,467,441,416,392,370,350,330,312,294,278,262,247,233,220,208,196,185,175,165,156,147,139,131,124,117,110,0,826,779,736,694,655,619,584,551,520,491,463,437,413,390,368,347,328,309,292,276,260,245,232,219,206,195,184,174,164,155,146,138,130,123,116,109,0,820,774,730,689,651,614,580,547,516,487,460,434,410,387,365,345,325,307,290,274,258,
244,230,217,205,193,183,172,163,154,145,137,129,122,115,109,0,814,768,725,684,646,610,575,543,513,484,457,431,407,384,363,342,323,305,288,272,256,242,228,216,204,192,181,171,161,152,144,136,128,121,114,108,0,907,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,0,900,850,802,757,715,675,636,601,567,535,505,477,450,425,401,379,357,337,318,300,284,268,253,238,225,212,200,189,179,169,159,150,142,134,126,119,0,894,
844,796,752,709,670,632,597,563,532,502,474,447,422,398,376,355,335,316,298,282,266,251,237,223,211,199,188,177,167,158,149,141,133,125,118,0,887,838,791,746,704,665,628,592,559,528,498,470,444,419,395,373,352,332,314,296,280,264,249,235,222,209,198,187,176,166,157,148,140,132,125,118,0,881,832,785,741,699,660,623,588,555,524,494,467,441,416,392,370,350,330,312,294,278,262,247,233,220,208,196,185,175,165,156,147,139,131,123,117,0,875,826,779,736,694,655,619,584,551,520,491,463,437,413,390,368,347,
328,309,292,276,260,245,232,219,206,195,184,174,164,155,146,138,130,123,116,0,868,820,774,730,689,651,614,580,547,516,487,460,434,410,387,365,345,325,307,290,274,258,244,230,217,205,193,183,172,163,154,145,137,129,122,115,0,862,814,768,725,684,646,610,575,543,513,484,457,431,407,384,363,342,323,305,288,272,256,242,228,216,203,192,181,171,161,152,144,136,128,121,114,0],k=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,212,197,180,161,141,120,97,74,49,24],l=[0,5,6,
7,8,10,11,13,16,19,22,26,32,43,64,128];window.neoart.PTPlayer=function(g){g=AmigaPlayer(g);Object.defineProperties(g,{id:{value:"PTPlayer"},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternBreak:{value:0,writable:!0},patternDelay:{value:0,writable:!0},breakPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},vibratoDepth:{value:0,
writable:!0},force:{set:function(a){1>a?a=1:3<a&&(a=3);this.version=a;this.vibratoDepth=2>a?6:7}},initialize:{value:function(){var a=this.voices[0];this.tempo=125;this.speed=6;this.jumpFlag=this.breakPos=this.patternDelay=this.patternBreak=this.patternPos=this.trackPos=0;this.reset();for(this.force=this.version;a;)a.initialize(),a.channel=this.mixer.channels[a.index],a.sample=this.samples[0],a=a.next}},loader:{value:function(a){var c=0,e,d,f=0,b;if(!(2106>a.length)&&(a.position=1080,e=a.readString(4),
!("M.K."!=e&&"M!K!"!=e))){a.position=0;this.title=a.readString(20);this.version=1;a.position+=22;for(e=1;32>e;++e)(b=a.readUshort())?(d=j(),a.position-=24,d.name=a.readString(22),d.length=d.realLen=b<<1,a.position+=2,d.finetune=37*a.readUbyte(),d.volume=a.readUbyte(),d.loop=a.readUshort()<<1,d.repeat=a.readUshort()<<1,a.position+=22,d.pointer=f,f+=d.length,this.samples[e]=d):(this.samples[e]=null,a.position+=28);a.position=950;this.length=a.readUbyte();a.position++;for(e=0;128>e;++e)b=a.readUbyte()<<
8,this.track[e]=b,b>c&&(c=b);a.position=1084;c+=256;this.patterns.length=c;for(e=0;e<c;++e){b=AmigaRow();Object.defineProperties(b,{step:{value:0,writable:!0}});d=Object.seal(b);d.step=b=a.readUint();d.note=b>>16&4095;d.effect=b>>8&15;d.sample=b>>24&240|b>>12&15;d.param=b&255;this.patterns[e]=d;if(31<d.sample||!this.samples[d.sample])d.sample=0;15==d.effect&&31<d.param&&(this.version=2);8==d.effect&&(this.version=3)}this.mixer.store(a,f);for(e=1;32>e;++e)if(d=this.samples[e]){d.loop||4<d.repeat?(d.loopPtr=
d.pointer+d.loop,d.length=d.loop+d.repeat):(d.loopPtr=this.mixer.memory.length,d.repeat=2);f=d.pointer+2;for(a=d.pointer;a<f;++a)this.mixer.memory[a]=0}d=j();d.pointer=d.loopPtr=this.mixer.memory.length;d.length=d.repeat=2;this.samples[0]=d}}},process:{value:function(){var a,c,e,d,f,b=this.voices[0];if(this.tick)this.effects();else if(this.patternDelay)this.effects();else{for(e=this.track[this.trackPos]+this.patternPos;b;){a=b.channel;b.enabled=0;b.step||(a.period=b.period);d=this.patterns[e+b.index];
b.step=d.step;b.effect=d.effect;b.param=d.param;d.sample&&(c=b.sample=this.samples[d.sample],b.pointer=c.pointer,b.length=c.length,b.loopPtr=b.funkWave=c.loopPtr,b.repeat=c.repeat,b.finetune=c.finetune,a.volume=b.volume=c.volume);if(d.note){if(3664==(b.step&4080))b.finetune=37*(b.param&15);else if(3==b.effect||5==b.effect)if(d.note==b.period)b.portaPeriod=0;else{c=b.finetune;for(f=c+37;c<f&&!(d.note>=h[c]);++c);0<c&&(f=b.finetune/37>>0&8)&&c--;b.portaPeriod=h[c];b.portaDir=d.note>b.portaPeriod?0:
1}else 9==b.effect&&this.moreEffects(b);for(c=0;37>c&&!(d.note>=h[c]);++c);b.period=h[b.finetune+c];3792==(b.step&4080)?(b.funkSpeed&&this.updateFunk(b),this.extended(b)):(4>b.vibratoWave&&(b.vibratoPos=0),4>b.tremoloWave&&(b.tremoloPos=0),a.enabled=0,a.pointer=b.pointer,a.length=b.length,a.period=b.period,b.enabled=1,this.moreEffects(b))}else this.moreEffects(b);b=b.next}for(b=this.voices[0];b;)a=b.channel,b.enabled&&(a.enabled=1),a.pointer=b.loopPtr,a.length=b.repeat,b=b.next}if(++this.tick==this.speed&&
(this.tick=0,this.patternPos+=4,this.patternDelay&&--this.patternDelay&&(this.patternPos-=4),this.patternBreak&&(this.patternBreak=0,this.patternPos=this.breakPos,this.breakPos=0),256==this.patternPos||this.jumpFlag))this.patternPos=this.breakPos,this.jumpFlag=this.breakPos=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1)}},effects:{value:function(){for(var a,c,e,d,f,b=this.voices[0];b;){a=b.channel;b.funkSpeed&&this.updateFunk(b);if(0==(b.step&4095))a.period=b.period;else{switch(b.effect){case 0:f=
this.tick%3;if(!f){a.period=b.period;b=b.next;continue}f=1==f?b.param>>4:b.param&15;c=b.finetune;for(e=c+37;c<e;++c)if(b.period>=h[c]){a.period=h[c+f];break}break;case 1:b.period-=b.param;113>b.period&&(b.period=113);a.period=b.period;break;case 2:b.period+=b.param;856<b.period&&(b.period=856);a.period=b.period;break;case 3:case 5:5==b.effect?d=1:(b.portaSpeed=b.param,b.param=0);if(b.portaPeriod)if(b.portaDir?(b.period-=b.portaSpeed,b.period<=b.portaPeriod&&(b.period=b.portaPeriod,b.portaPeriod=0)):
(b.period+=b.portaSpeed,b.period>=b.portaPeriod&&(b.period=b.portaPeriod,b.portaPeriod=0)),b.glissando){c=b.finetune;for(f=c+37;c<f&&!(b.period>=h[c]);++c);c==f&&c--;a.period=h[c]}else a.period=b.period;break;case 4:case 6:if(6==b.effect)d=1;else if(b.param){if(f=b.param&15)b.vibratoParam=b.vibratoParam&240|f;if(f=b.param&240)b.vibratoParam=b.vibratoParam&15|f}e=b.vibratoPos>>2&31;(c=b.vibratoWave&3)?(f=255,e<<=3,1==c&&(f=127<b.vibratoPos?f-e:e)):f=k[e];f=(b.vibratoParam&15)*f>>this.vibratoDepth;
a.period=127<b.vibratoPos?b.period-f:b.period+f;f=b.vibratoParam>>2&60;b.vibratoPos=b.vibratoPos+f&255;break;case 7:a.period=b.period;if(b.param){if(f=b.param&15)b.tremoloParam=b.tremoloParam&240|f;if(f=b.param&240)b.tremoloParam=b.tremoloParam&15|f}e=b.tremoloPos>>2&31;(c=b.tremoloWave&3)?(f=255,e<<=3,1==c&&(f=127<b.tremoloPos?f-e:e)):f=k[e];f=(b.tremoloParam&15)*f>>6;a.volume=127<b.tremoloPos?b.volume-f:b.volume+f;f=b.tremoloParam>>2&60;b.tremoloPos=b.tremoloPos+f&255;break;case 10:d=1;break;case 14:this.extended(b)}d&&
(d=0,f=b.param>>4,b.volume=f?b.volume+f:b.volume-(b.param&15),0>b.volume?b.volume=0:64<b.volume&&(b.volume=64),a.volume=b.volume)}b=b.next}}},moreEffects:{value:function(a){var c=a.channel;a.funkSpeed&&this.updateFunk(a);switch(a.effect){case 9:a.param&&(a.offset=a.param);c=a.offset<<8;c>=a.length?a.length=2:(a.pointer+=c,a.length-=c);break;case 11:this.trackPos=a.param-1;this.breakPos=0;this.jumpFlag=1;break;case 12:a.volume=a.param;64<a.volume&&(a.volume=64);c.volume=a.volume;break;case 13:this.breakPos=
10*(a.param>>4)+(a.param&15);this.breakPos=63<this.breakPos?0:this.breakPos<<2;this.jumpFlag=1;break;case 14:this.extended(a);break;case 15:if(!a.param)break;32>a.param?this.speed=a.param:this.mixer.samplesTick=2.5*this.sampleRate/a.param>>0;this.tick=0}}},extended:{value:function(a){var c=a.channel,e;e=a.param&15;switch(a.param>>4){case 0:this.mixer.filter.active=e;break;case 1:if(this.tick)break;a.period-=e;113>a.period&&(a.period=113);c.period=a.period;break;case 2:if(this.tick)break;a.period+=
e;856<a.period&&(a.period=856);c.period=a.period;break;case 3:a.glissando=e;break;case 4:a.vibratoWave=e;break;case 5:a.finetune=37*e;break;case 6:if(this.tick)break;e?(a.loopCtr?a.loopCtr--:a.loopCtr=e,a.loopCtr&&(this.breakPos=a.loopPos<<2,this.patternBreak=1)):a.loopPos=this.patternPos>>2;break;case 7:a.tremoloWave=e;break;case 8:c=a.length-2;e=this.mixer.memory;for(a=a.loopPtr;a<c;)e[a]=0.5*(e[a]+e[++a]);e[++a]=0.5*(e[a]+e[0]);break;case 9:if(this.tick||!e||!a.period)break;if(this.tick%e)break;
c.enabled=0;c.pointer=a.pointer;c.length=a.length;c.delay=30;c.enabled=1;c.pointer=a.loopPtr;c.length=a.repeat;c.period=a.period;break;case 10:if(this.tick)break;a.volume+=e;64<a.volume&&(a.volume=64);c.volume=a.volume;break;case 11:if(this.tick)break;a.volume-=e;0>a.volume&&(a.volume=0);c.volume=a.volume;break;case 12:this.tick==e&&(c.volume=a.volume=0);break;case 13:if(this.tick!=e||!a.period)break;c.enabled=0;c.pointer=a.pointer;c.length=a.length;c.delay=30;c.enabled=1;c.pointer=a.loopPtr;c.length=
a.repeat;c.period=a.period;break;case 14:if(this.tick||this.patternDelay)break;this.patternDelay=++e;break;case 15:if(this.tick)break;(a.funkSpeed=e)&&this.updateFunk(a)}}},updateFunk:{value:function(a){var c=a.channel,e,d;a.funkPos+=l[a.funkSpeed];128>a.funkPos||(a.funkPos=0,1==this.version?(e=a.pointer+a.sample.realLen-a.repeat,d=a.funkWave+a.repeat,d>e&&(d=a.loopPtr,c.length=a.repeat),c.pointer=a.funkWave=d):(e=a.loopPtr+a.repeat,d=a.funkWave+1,d>=e&&(d=a.loopPtr),this.mixer.memory[d]=-this.mixer.memory[d]))}}});
g.voices[0]=i(0);g.voices[0].next=g.voices[1]=i(1);g.voices[1].next=g.voices[2]=i(2);g.voices[2].next=g.voices[3]=i(3);g.track=new Uint16Array(128);return Object.seal(g)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.0 - 2012/02/12

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function h(g,a){return Object.create(null,{index:{value:g,writable:!0},bitFlag:{value:a,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},trackPtr:{value:0,writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},tick:{value:0,writable:!0},busy:{value:0,writable:!0},flags:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},volume:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},
vibratoPtr:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},synthPos:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.patternPos=this.trackPos=this.trackPtr=0;this.busy=this.tick=1;this.synthPos=this.vibratoPos=this.vibratoPtr=this.portaSpeed=this.volume=this.period=this.note=this.flags=0}}})}function j(){var g=AmigaSample();Object.defineProperties(g,{relative:{value:0,writable:!0},divider:{value:0,writable:!0},vibrato:{value:0,writable:!0},hiPos:{value:0,
writable:!0},loPos:{value:0,writable:!0},wave:{value:[],writable:!0}});return Object.seal(g)}window.neoart.RHPlayer=function(g){g=AmigaPlayer(g);Object.defineProperties(g,{id:{value:"RHPlayer"},songs:{value:[],writable:!0},samples:{value:[],writable:!0},song:{value:null,writable:!0},periods:{value:0,writable:!0},vibrato:{value:0,writable:!0},voices:{value:[],writable:!0},stream:{value:null,writable:!0},complete:{value:0,writable:!0},variant:{value:0,writable:!0},initialize:{value:function(){var a,
f,d,e=this.voices[3];this.reset();this.song=this.songs[this.playSong];this.complete=15;for(a=0;a<this.samples.length;++a)if(d=this.samples[a],d.wave.length)for(f=0;f<d.length;++f)this.mixer.memory[d.pointer+f]=d.wave[f];for(;e;)e.initialize(),e.channel=this.mixer.channels[e.index],e.trackPtr=this.song.tracks[e.index],e.trackPos=4,this.stream.position=e.trackPtr,e.patternPos=this.stream.readUint(),e=e.next}},loader:{value:function(a){var f,d,e,b,c,g,i,h;for(a.position=44;1024>a.position;)if(c=a.readUshort(),
32272==c||32288==c)c=a.readUshort(),16890==c&&(f=a.position+a.readUshort(),c=a.readUshort(),53756==c?(g=f+a.readUint(),this.mixer.loopLen=64,a.position+=2):(g=f,this.mixer.loopLen=512),e=a.position+a.readUshort(),c=a.readUbyte(),114==c&&(d=a.readUbyte()));else if(20937==c){if(a.position+=2,c=a.readUshort(),17914==c){h=a.position+a.readUshort();for(a.position+=2;;)if(c=a.readUshort(),19450==c){b=a.position+a.readUshort();break}}}else if(49404==c)a.position+=2,c=a.readUshort(),16875==c&&(i=a.readUshort());
else if(13421==c)a.position+=2,c=a.readUshort(),18938==c&&(this.vibrato=a.position+a.readUshort());else if(16960==c&&(c=a.readUshort(),17914==c)){this.periods=a.position+a.readUshort();break}if(e&&g&&d&&i){a.position=g;this.samples=[];d++;for(f=0;f<d;++f)c=j(),c.length=a.readUint(),c.relative=parseInt(3579545/a.readUshort()),c.pointer=this.mixer.store(a,c.length),this.samples[f]=c;a.position=e;for(f=0;f<d;++f)c=this.samples[f],a.position+=4,c.loopPtr=a.readInt(),a.position+=6,c.volume=a.readUshort(),
b&&(c.divider=a.readUshort(),c.vibrato=a.readUshort(),c.hiPos=a.readUshort(),c.loPos=a.readUshort(),a.position+=8);if(b){a.position=b;f=b-e>>5;e=f+3;this.variant=1;if(f>=d)for(;d<f;++d)this.samples[d]=j();for(;f<e;++f){c=j();a.position+=4;c.loopPtr=a.readInt();c.length=a.readUshort();c.relative=a.readUshort();a.position+=2;c.volume=a.readUshort();c.divider=a.readUshort();c.vibrato=a.readUshort();c.hiPos=a.readUshort();c.loPos=a.readUshort();b=a.position;a.position=h;a.position=a.readInt();c.pointer=
this.mixer.memory.length;this.mixer.memory.length+=c.length;for(d=0;d<c.length;++d)c.wave[d]=a.readByte();this.samples[f]=c;h+=4;a.position=b}}a.position=i;this.songs=[];for(c=65536;;){i=Object.create(null,{speed:{value:0,writable:!0},tracks:{value:null,writable:!0}});a.position++;i.tracks=new Uint32Array(4);i.speed=a.readUbyte();for(f=0;4>f;++f)d=a.readUint(),d<c&&(c=d),i.tracks[f]=d;this.songs.push(i);if(18>c-a.position)break}this.lastSong=this.songs.length-1;a.length=g;for(a.position=352;512>a.position;)c=
a.readUshort(),45116==c&&(c=a.readUshort(),133==c?this.variant=2:134==c?this.variant=4:135==c&&(this.variant=3));this.stream=a;this.version=1}}},process:{value:function(){for(var a,f,d,e,b=this.voices[3];b;){a=b.channel;this.stream.position=b.patternPos;d=b.sample;b.busy||(b.busy=1,0==d.loopPtr?(a.pointer=this.mixer.loopPtr,a.length=this.mixer.loopLen):0<d.loopPtr&&(a.pointer=d.pointer+d.loopPtr,a.length=d.length-d.loopPtr));if(0==--b.tick){b.flags=0;for(f=1;f;)if(e=this.stream.readByte(),0>e)switch(e){case -121:3==
this.variant&&(b.volume=this.stream.readUbyte());break;case -122:4==this.variant&&(b.volume=this.stream.readUbyte());break;case -123:1<this.variant&&(this.mixer.complete=1);break;case -124:this.stream.position=b.trackPtr+b.trackPos;e=this.stream.readUint();b.trackPos+=4;e||(this.stream.position=b.trackPtr,e=this.stream.readUint(),b.trackPos=4,this.loopSong||(this.complete&=~b.bitFlag,this.complete||(this.mixer.complete=1)));this.stream.position=e;break;case -125:4==this.variant&&(b.flags|=4);break;
case -126:b.tick=this.song.speed*this.stream.readByte();b.patternPos=this.stream.position;a.pointer=this.mixer.loopPtr;a.length=this.mixer.loopLen;f=0;break;case -127:b.portaSpeed=this.stream.readByte();b.flags|=1;break;case -128:e=this.stream.readByte(),0>e&&(e=0),b.sample=d=this.samples[e],b.vibratoPtr=this.vibrato+d.vibrato,b.vibratoPos=b.vibratoPtr}else b.tick=this.song.speed*e,b.note=this.stream.readByte(),b.patternPos=this.stream.position,b.synthPos=d.loPos,b.vibratoPos=b.vibratoPtr,a.pointer=
d.pointer,a.length=d.length,a.volume=b.volume?b.volume:d.volume,this.stream.position=this.periods+(b.note<<1),e=this.stream.readUshort()*d.relative,a.period=b.period=e>>10,a.enabled=1,b.busy=f=0}else{if(1==b.tick&&(4!=this.variant||!(b.flags&4)))a.enabled=0;b.flags&1&&(a.period=b.period+=b.portaSpeed);d.divider&&(this.stream.position=b.vibratoPos,e=this.stream.readByte(),-124==e&&(this.stream.position=b.vibratoPtr,e=this.stream.readByte()),b.vibratoPos=this.stream.position,e*=parseInt(b.period/d.divider),
a.period=b.period+e)}d.hiPos&&(e=0,b.flags&2?(b.synthPos--,b.synthPos<=d.loPos&&(b.flags&=-3,e=60)):(b.synthPos++,b.synthPos>d.hiPos&&(b.flags|=2,e=60)),this.mixer.memory[d.pointer+b.synthPos]=e);b=b.next}}}});g.voices[3]=h(3,8);g.voices[3].next=g.voices[2]=h(2,4);g.voices[2].next=g.voices[1]=h(1,2);g.voices[1].next=g.voices[0]=h(0,1);return Object.seal(g)}})();/*
  Flod JS 2.0
  2012/04/01
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 1.0 - 2012/02/08

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function l(g){return Object.create(null,{index:{value:g,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},step:{value:0,writable:!0},row:{value:0,writable:!0},sample:{value:0,writable:!0},samplePtr:{value:0,writable:!0},sampleLen:{value:0,writable:!0},note:{value:0,writable:!0},noteTimer:{value:0,writable:!0},period:{value:0,writable:!0},volume:{value:0,writable:!0},bendTo:{value:0,writable:!0},bendSpeed:{value:0,writable:!0},arpeggioCtr:{value:0,writable:!0},
envelopeCtr:{value:0,writable:!0},pitchCtr:{value:0,writable:!0},pitchFallCtr:{value:0,writable:!0},sustainCtr:{value:0,writable:!0},phaseTimer:{value:0,writable:!0},phaseSpeed:{value:0,writable:!0},wavePos:{value:0,writable:!0},waveList:{value:0,writable:!0},waveTimer:{value:0,writable:!0},waitCtr:{value:0,writable:!0},initialize:{value:function(){this.sample=this.row=this.step=0;this.samplePtr=-1;this.noteTimer=this.note=this.sampleLen=0;this.period=39321;this.waitCtr=this.waveTimer=this.waveList=
this.wavePos=this.phaseSpeed=this.phaseTimer=this.sustainCtr=this.pitchFallCtr=this.pitchCtr=this.envelopeCtr=this.arpeggioCtr=this.bendSpeed=this.bendTo=this.volume=0}}})}function n(){var g=AmigaSample();Object.defineProperties(g,{waveform:{value:0,writable:!0},arpeggio:{value:null,writable:!0},attackSpeed:{value:0,writable:!0},attackMax:{value:0,writable:!0},decaySpeed:{value:0,writable:!0},decayMin:{value:0,writable:!0},sustain:{value:0,writable:!0},releaseSpeed:{value:0,writable:!0},releaseMin:{value:0,
writable:!0},phaseShift:{value:0,writable:!0},phaseSpeed:{value:0,writable:!0},finetune:{value:0,writable:!0},pitchFall:{value:0,writable:!0}});g.arpeggio=new Uint8Array(16);return Object.seal(g)}var p=[1166,408,908],o=[0,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,
160,151,143,135,127,0,0,0,0,0,0,0,4028,3806,3584,3394,3204,3013,2855,2696,2538,2395,2268,2141,2014,1903,1792,1697,1602,1507,1428,1348,1269,1198,1134,1071,1007,952,896,849,801,754,714,674,635,599,567,536,504,476,448,425,401,377,357,337,310,300,284,268,252,238,224,213,201,189,179,169,159,150,142,134,0,0,0,0,0,0,0,3993,3773,3552,3364,3175,2987,2830,2672,2515,2374,2248,2122,1997,1887,1776,1682,1588,1494,1415,1336,1258,1187,1124,1061,999,944,888,841,794,747,708,668,629,594,562,531,500,472,444,421,397,
374,354,334,315,297,281,266,250,236,222,211,199,187,177,167,158,149,141,133,0,0,0,0,0,0,0,3957,3739,3521,3334,3147,2960,2804,2648,2493,2353,2228,2103,1979,1870,1761,1667,1574,1480,1402,1324,1247,1177,1114,1052,990,935,881,834,787,740,701,662,624,589,557,526,495,468,441,417,394,370,351,331,312,295,279,263,248,234,221,209,197,185,176,166,156,148,140,132,0,0,0,0,0,0,0,3921,3705,3489,3304,3119,2933,2779,2625,2470,2331,2208,2084,1961,1853,1745,1652,1560,1467,1390,1313,1235,1166,1104,1042,981,927,873,826,
780,734,695,657,618,583,552,521,491,464,437,413,390,367,348,329,309,292,276,261,246,232,219,207,195,184,174,165,155,146,138,131,0,0,0,0,0,0,0,3886,3671,3457,3274,3090,2907,2754,2601,2448,2310,2188,2065,1943,1836,1729,1637,1545,1454,1377,1301,1224,1155,1094,1033,972,918,865,819,773,727,689,651,612,578,547,517,486,459,433,410,387,364,345,326,306,289,274,259,243,230,217,205,194,182,173,163,153,145,137,130,0,0,0,0,0,0,0,3851,3638,3426,3244,3062,2880,2729,2577,2426,2289,2168,2047,1926,1819,1713,1622,1531,
1440,1365,1289,1213,1145,1084,1024,963,910,857,811,766,720,683,645,607,573,542,512,482,455,429,406,383,360,342,323,304,287,271,256,241,228,215,203,192,180,171,162,152,144,136,128,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127];window.neoart.S1Player=
function(g){g=AmigaPlayer(g);Object.defineProperties(g,{id:{value:"S1Player"},tracksPtr:{value:null,writable:!0},tracks:{value:[],writable:!0},patternsPtr:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},waveLists:{value:null,writable:!0},speedDef:{value:0,writable:!0},patternDef:{value:0,writable:!0},mix1Speed:{value:0,writable:!0},mix2Speed:{value:0,writable:!0},mix1Dest:{value:0,writable:!0},mix2Dest:{value:0,writable:!0},mix1Source1:{value:0,writable:!0},
mix1Source2:{value:0,writable:!0},mix2Source1:{value:0,writable:!0},mix2Source2:{value:0,writable:!0},doFilter:{value:0,writable:!0},doReset:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},trackEnd:{value:0,writable:!0},trackLen:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternEnd:{value:0,writable:!0},patternLen:{value:0,writable:!0},mix1Ctr:{value:0,writable:!0},mix2Ctr:{value:0,writable:!0},mix1Pos:{value:0,writable:!0},mix2Pos:{value:0,writable:!0},
audPtr:{value:0,writable:!0},audLen:{value:0,writable:!0},audPer:{value:0,writable:!0},audVol:{value:0,writable:!0},initialize:{value:function(){var b,e,c=this.voices[0];this.reset();this.tick=this.speed=this.speedDef;this.trackPos=1;this.trackEnd=0;this.patternPos=-1;this.patternEnd=0;this.patternLen=this.patternDef;for(this.mix2Ctr=this.mix2Pos=this.mix1Ctr=this.mix1Pos=0;c;)c.initialize(),b=this.mixer.channels[c.index],c.channel=b,c.step=this.tracksPtr[c.index],e=this.tracks[c.step],c.row=this.patternsPtr[e.pattern],
c.sample=this.patterns[c.row].sample,b.length=32,b.period=c.period,b.enabled=1,c=c.next}},loader:{value:function(b){for(var e,c,j,h,a,i,d,f,g,l,k,m;8<b.bytesAvailable;)if(f=b.readUshort(),16890==f&&(j=b.readUshort(),f=b.readUshort(),53736==f&&(f=b.readUshort(),65492==f))){m=4076==j?4090:5222==j?5188:j;i=j+b.position-6;break}if(i&&(b.position=i," SID-MON BY R.v.VLIET  (c) 1988 "==b.readString(32))){b.position=i-44;f=b.readUint();for(c=1;4>c;++c)this.tracksPtr[c]=(b.readUint()-f)/6>>0;b.position=i-
8;f=b.readUint();a=b.readUint();a<f&&(a=b.length-i);g=a-f>>2;this.patternsPtr=new Uint32Array(g);b.position=i+f+4;for(c=1;c<g;++c){f=b.readUint()/5>>0;if(0==f){g=c;break}this.patternsPtr[c]=f}this.patternsPtr.length=g;b.position=i-44;f=b.readUint();b.position=i-28;a=(b.readUint()-f)/6>>0;this.tracks.length=a;b.position=i+f;for(c=0;c<a;++c){f=AmigaStep();f.pattern=b.readUint();f.pattern>=g&&(f.pattern=0);b.readByte();f.transpose=b.readByte();if(-99>f.transpose||99<f.transpose)f.transpose=0;this.tracks[c]=
f}b.position=i-24;f=b.readUint();k=b.readUint()-f;for(c=0;32>c;++c)this.mixer.memory[c]=0;this.mixer.store(b,k,i+f);k>>=5;b.position=i-16;f=b.readUint();a=b.readUint()-f+16;j=k+2<<4;this.waveLists=new Uint8Array(a<j?j:a);b.position=i+f;for(c=0;c<j;)this.waveLists[c++]=c>>4,this.waveLists[c++]=255,this.waveLists[c++]=255,this.waveLists[c++]=16,c+=12;for(c=16;c<a;++c)this.waveLists[c]=b.readUbyte();b.position=i-20;b.position=i+b.readUint();this.mix1Source1=b.readUint();this.mix2Source1=b.readUint();
this.mix1Source2=b.readUint();this.mix2Source2=b.readUint();this.mix1Dest=b.readUint();this.mix2Dest=b.readUint();this.patternDef=b.readUint();this.trackLen=b.readUint();this.speedDef=b.readUint();this.mix1Speed=b.readUint();this.mix2Speed=b.readUint();this.mix1Source1>k&&(this.mix1Source1=0);this.mix2Source1>k&&(this.mix2Source1=0);this.mix1Source2>k&&(this.mix1Source2=0);this.mix2Source2>k&&(this.mix2Source2=0);this.mix1Dest>k&&(this.mix1Speed=0);this.mix2Dest>k&&(this.mix2Speed=0);0==this.speedDef&&
(this.speedDef=4);b.position=i-28;j=b.readUint();g=b.readUint()-j>>5;63<g&&(g=63);a=g+1;b.position=i-4;f=b.readUint();if(1==f){b.position=1820;f=b.readUshort();if(19962!=f&&(b.position=1788,f=b.readUshort(),19962!=f)){this.version=0;return}b.position+=b.readUshort();this.samples.length=a+3;for(c=0;3>c;++c)d=n(),d.waveform=16+c,d.length=p[c],d.pointer=this.mixer.store(b,d.length),d.loop=d.loopPtr=0,d.repeat=4,d.volume=64,this.samples[a+c]=d,b.position+=d.length}else this.samples.length=a,b.position=
i+f,e=b.readUint(),l=(e>>5)+15,h=b.position,e+=h;d=n();this.samples[0]=d;b.position=i+j;for(c=1;c<a;++c){d=n();d.waveform=b.readUint();for(j=0;16>j;++j)d.arpeggio[j]=b.readUbyte();d.attackSpeed=b.readUbyte();d.attackMax=b.readUbyte();d.decaySpeed=b.readUbyte();d.decayMin=b.readUbyte();d.sustain=b.readUbyte();b.readByte();d.releaseSpeed=b.readUbyte();d.releaseMin=b.readUbyte();d.phaseShift=b.readUbyte();d.phaseSpeed=b.readUbyte();d.finetune=b.readUbyte();d.pitchFall=b.readByte();5188==m?(d.pitchFall=
d.finetune,d.finetune=0):(15<d.finetune&&(d.finetune=0),d.finetune*=67);d.phaseShift>k&&(d.phaseShift=0,d.phaseSpeed=0);if(15<d.waveform)if(15<l&&d.waveform>l)d.waveform=0;else{f=h+(d.waveform-16<<5);if(f>=b.length)continue;j=b.position;b.position=f;d.pointer=b.readUint();d.loop=b.readUint();d.length=b.readUint();d.name=b.readString(20);0==d.loop||99999==d.loop||199999==d.loop||d.loop>=d.length?(d.loop=0,d.repeat=4090==m?2:4):(d.repeat=d.length-d.loop,d.loop-=d.pointer);d.length-=d.pointer;d.length<
d.loop+d.repeat&&(d.length=d.loop+d.repeat);d.pointer=this.mixer.store(b,d.length,e+d.pointer);d.loopPtr=6>d.repeat||0==d.loop?0:d.pointer+d.loop;b.position=j}else d.waveform>k&&(d.waveform=0);this.samples[c]=d}b.position=i-12;f=b.readUint();a=(b.readUint()-f)/5>>0;this.patterns.length=a;b.position=i+f;for(c=0;c<a;++c){e=AmigaRow();Object.defineProperties(e,{speed:{value:0,writable:!0}});e=Object.seal(e);e.note=b.readUbyte();e.sample=b.readUbyte();e.effect=b.readUbyte();e.param=b.readUbyte();e.speed=
b.readUbyte();if(5188==m){if(0<e.note&&255>e.note&&(e.note+=469),0<e.effect&&255>e.effect&&(e.effect+=469),59<e.sample)e.sample=g+(e.sample-60)}else e.sample>g&&(e.sample=0);this.patterns[c]=e}4464==m||4550==m||5188==m?(4464==m&&(this.mix1Speed=this.mix2Speed=0),this.doReset=this.doFilter=0):this.doReset=this.doFilter=1;this.version=1}}},process:{value:function(){var b,e,c,g=this.mixer.memory,h,a;for(a=this.voices[0];a;){b=a.channel;this.audPtr=-1;this.audLen=this.audPer=this.audVol=0;if(0==this.tick)if(this.patternEnd&&
(this.trackEnd?a.step=this.tracksPtr[a.index]:a.step++,c=this.tracks[a.step],a.row=this.patternsPtr[c.pattern],this.doReset&&(a.noteTimer=0)),0==a.noteTimer){h=this.patterns[a.row];0==h.sample?h.note&&(a.noteTimer=h.speed,a.waitCtr&&(e=this.samples[a.sample],this.audPtr=e.pointer,this.audLen=e.length,a.samplePtr=e.loopPtr,a.sampleLen=e.repeat,a.waitCtr=1,b.enabled=0)):(e=this.samples[h.sample],a.waitCtr&&(b.enabled=a.waitCtr=0),15<e.waveform?(this.audPtr=e.pointer,this.audLen=e.length,a.samplePtr=
e.loopPtr,a.sampleLen=e.repeat,a.waitCtr=1):(a.wavePos=0,a.waveList=e.waveform,c=a.waveList<<4,this.audPtr=this.waveLists[c]<<5,this.audLen=32,a.waveTimer=this.waveLists[++c]),a.noteTimer=h.speed,a.sample=h.sample,a.envelopeCtr=a.pitchCtr=a.pitchFallCtr=0);if(h.note&&(a.noteTimer=h.speed,255!=h.note))switch(e=this.samples[a.sample],c=this.tracks[a.step],a.note=h.note+c.transpose,a.period=this.audPer=o[1+e.finetune+a.note],a.phaseSpeed=e.phaseSpeed,a.bendSpeed=a.volume=0,a.envelopeCtr=a.pitchCtr=a.pitchFallCtr=
0,h.effect){case 0:if(0==h.param)break;e.attackSpeed=h.param;e.attackMax=h.param;a.waveTimer=0;break;case 2:this.speed=h.param;a.waveTimer=0;break;case 3:this.patternLen=h.param;a.waveTimer=0;break;default:a.bendTo=h.effect+c.transpose,a.bendSpeed=h.param}a.row++}else a.noteTimer--;e=this.samples[a.sample];this.audVol=a.volume;switch(a.envelopeCtr){case 0:this.audVol+=e.attackSpeed;this.audVol>e.attackMax&&(this.audVol=e.attackMax,a.envelopeCtr+=2);break;case 2:this.audVol-=e.decaySpeed;if(this.audVol<=
e.decayMin||-256>this.audVol)this.audVol=e.decayMin,a.envelopeCtr+=2,a.sustainCtr=e.sustain;break;case 4:a.sustainCtr--;if(0==a.sustainCtr||-256==a.sustainCtr)a.envelopeCtr+=2;break;case 6:if(this.audVol-=e.releaseSpeed,this.audVol<=e.releaseMin||-256>this.audVol)this.audVol=e.releaseMin,a.envelopeCtr=8}a.volume=this.audVol;a.arpeggioCtr=++a.arpeggioCtr&15;c=e.finetune+e.arpeggio[a.arpeggioCtr]+a.note;a.period=this.audPer=o[c];if(a.bendSpeed&&(h=o[e.finetune+a.bendTo],c=~a.bendSpeed+1,-128>c&&(c&=
255),a.pitchCtr+=c,a.period+=a.pitchCtr,0>c&&a.period<=h||0<c&&a.period>=h))a.note=a.bendTo,a.period=h,a.bendSpeed=0,a.pitchCtr=0;e.phaseShift&&(a.phaseSpeed?a.phaseSpeed--:(a.phaseTimer=++a.phaseTimer&31,c=(e.phaseShift<<5)+a.phaseTimer,a.period+=g[c]>>2));a.pitchFallCtr-=e.pitchFall;-256>a.pitchFallCtr&&(a.pitchFallCtr+=256);a.period+=a.pitchFallCtr;0==a.waitCtr&&(a.waveTimer?a.waveTimer--:16>a.wavePos&&(c=(a.waveList<<4)+a.wavePos,h=this.waveLists[c++],255==h?a.wavePos=this.waveLists[c]&254:(this.audPtr=
h<<5,a.waveTimer=this.waveLists[c],a.wavePos+=2)));-1<this.audPtr&&(b.pointer=this.audPtr);0!=this.audPer&&(b.period=a.period);0!=this.audLen&&(b.length=this.audLen);b.volume=e.volume?e.volume:this.audVol>>2;b.enabled=1;a=a.next}this.trackEnd=this.patternEnd=0;++this.tick>this.speed&&(this.tick=0,++this.patternPos==this.patternLen&&(this.patternPos=0,this.patternEnd=1,++this.trackPos==this.trackLen&&(this.trackPos=this.trackEnd=this.mixer.complete=1)));if(this.mix1Speed){if(0==this.mix1Ctr){this.mix1Ctr=
this.mix1Speed;c=this.mix1Pos=++this.mix1Pos&31;b=(this.mix1Dest<<5)+31;a=(this.mix1Source1<<5)+31;h=this.mix1Source2<<5;for(e=31;-1<e;--e)g[b--]=g[a--]+g[h+c]>>1,c=--c&31}this.mix1Ctr--}if(this.mix2Speed){if(0==this.mix2Ctr){this.mix2Ctr=this.mix2Speed;c=this.mix2Pos=++this.mix2Pos&31;b=(this.mix2Dest<<5)+31;a=(this.mix2Source1<<5)+31;h=this.mix2Source2<<5;for(e=31;-1<e;--e)g[b--]=g[a--]+g[h+c]>>1,c=--c&31}this.mix2Ctr--}this.doFilter&&(c=this.mix1Pos+32,g[c]=~g[c]+1);for(a=this.voices[0];a;)b=a.channel,
1==a.waitCtr?a.waitCtr++:2==a.waitCtr&&(a.waitCtr++,b.pointer=a.samplePtr,b.length=a.sampleLen),a=a.next}}});g.voices[0]=l(0);g.voices[0].next=g.voices[1]=l(1);g.voices[1].next=g.voices[2]=l(2);g.voices[2].next=g.voices[3]=l(3);g.tracksPtr=new Uint32Array(4);return Object.seal(g)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.0 - 2012/03/31

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function k(i){return Object.create(null,{index:{value:i,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},step:{value:null,writable:!0},row:{value:null,writable:!0},instr:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},pattern:{value:0,writable:!0},instrument:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},volume:{value:0,writable:!0},original:{value:0,writable:!0},adsrPos:{value:0,writable:!0},
sustainCtr:{value:0,writable:!0},pitchBend:{value:0,writable:!0},pitchBendCtr:{value:0,writable:!0},noteSlideTo:{value:0,writable:!0},noteSlideSpeed:{value:0,writable:!0},waveCtr:{value:0,writable:!0},wavePos:{value:0,writable:!0},arpeggioCtr:{value:0,writable:!0},arpeggioPos:{value:0,writable:!0},vibratoCtr:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},speed:{value:0,writable:!0},initialize:{value:function(){this.sample=this.instr=this.row=this.step=null;this.speed=this.vibratoPos=this.vibratoCtr=
this.arpeggioPos=this.arpeggioCtr=this.wavePos=this.waveCtr=this.noteSlideSpeed=this.noteSlideTo=this.pitchBendCtr=this.pitchBend=this.sustainCtr=this.adsrPos=this.original=this.volume=this.period=this.note=this.instrument=this.pattern=this.enabled=0}}})}function m(){return Object.create(null,{wave:{value:0,writable:!0},waveLen:{value:0,writable:!0},waveDelay:{value:0,writable:!0},waveSpeed:{value:0,writable:!0},arpeggio:{value:0,writable:!0},arpeggioLen:{value:0,writable:!0},arpeggioDelay:{value:0,
writable:!0},arpeggioSpeed:{value:0,writable:!0},vibrato:{value:0,writable:!0},vibratoLen:{value:0,writable:!0},vibratoDelay:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},pitchBend:{value:0,writable:!0},pitchBendDelay:{value:0,writable:!0},attackMax:{value:0,writable:!0},attackSpeed:{value:0,writable:!0},decayMin:{value:0,writable:!0},decaySpeed:{value:0,writable:!0},sustain:{value:0,writable:!0},releaseMin:{value:0,writable:!0},releaseSpeed:{value:0,writable:!0}})}var l=[0,5760,5424,5120,
4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,107,101,95];window.neoart.S2Player=function(i){i=AmigaPlayer(i);Object.defineProperties(i,{id:{value:"S2Player"},tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},instruments:{value:[],writable:!0},
samples:{value:[],writable:!0},arpeggios:{value:null,writable:!0},vibratos:{value:null,writable:!0},waves:{value:null,writable:!0},length:{value:0,writable:!0},speedDef:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternLen:{value:0,writable:!0},arpeggioFx:{value:null,writable:!0},arpeggioPos:{value:0,writable:!0},initialize:{value:function(){var b=this.voices[0];this.reset();this.tick=this.speed=this.speedDef;this.patternPos=
this.trackPos=0;for(this.patternLen=64;b;)b.initialize(),b.channel=this.mixer.channels[b.index],b.instr=this.instruments[0],this.arpeggioFx[b.index]=0,b=b.next}},loader:{value:function(b){var e=0,d=0,c,g,a,i=0,h,f,j;b.position=58;if("SIDMON II - THE MIDI VERSION"==b.readString(28)){b.position=2;this.length=b.readUbyte();this.speedDef=b.readUbyte();this.samples.length=b.readUshort()>>6;b.position=14;a=b.readUint();this.tracks.length=a;for(b.position=90;d<a;++d)c=AmigaStep(),Object.defineProperties(c,
{soundTranspose:{value:0,writable:!0}}),c=Object.seal(c),c.pattern=b.readUbyte(),c.pattern>e&&(e=c.pattern),this.tracks[d]=c;for(d=0;d<a;++d)c=this.tracks[d],c.transpose=b.readByte();for(d=0;d<a;++d)c=this.tracks[d],c.soundTranspose=b.readByte();c=b.position;b.position=26;a=b.readUint()>>5;this.instruments.length=++a;b.position=c;this.instruments[0]=m();for(d=0;++d<a;)c=m(),c.wave=b.readUbyte()<<4,c.waveLen=b.readUbyte(),c.waveSpeed=b.readUbyte(),c.waveDelay=b.readUbyte(),c.arpeggio=b.readUbyte()<<
4,c.arpeggioLen=b.readUbyte(),c.arpeggioSpeed=b.readUbyte(),c.arpeggioDelay=b.readUbyte(),c.vibrato=b.readUbyte()<<4,c.vibratoLen=b.readUbyte(),c.vibratoSpeed=b.readUbyte(),c.vibratoDelay=b.readUbyte(),c.pitchBend=b.readByte(),c.pitchBendDelay=b.readUbyte(),b.readByte(),b.readByte(),c.attackMax=b.readUbyte(),c.attackSpeed=b.readUbyte(),c.decayMin=b.readUbyte(),c.decaySpeed=b.readUbyte(),c.sustain=b.readUbyte(),c.releaseMin=b.readUbyte(),c.releaseSpeed=b.readUbyte(),this.instruments[d]=c,b.position+=
9;c=b.position;b.position=30;a=b.readUint();this.waves=new Uint8Array(a);b.position=c;for(d=0;d<a;++d)this.waves[d]=b.readUbyte();c=b.position;b.position=34;a=b.readUint();this.arpeggios=new Int8Array(a);b.position=c;for(d=0;d<a;++d)this.arpeggios[d]=b.readByte();c=b.position;b.position=38;a=b.readUint();this.vibratos=new Int8Array(a);b.position=c;for(d=0;d<a;++d)this.vibratos[d]=b.readByte();a=this.samples.length;for(d=c=0;d<a;++d)f=AmigaSample(),Object.defineProperties(f,{negStart:{value:0,writable:!0},
negLen:{value:0,writable:!0},negSpeed:{value:0,writable:!0},negDir:{value:0,writable:!0},negOffset:{value:0,writable:!0},negPos:{value:0,writable:!0},negCtr:{value:0,writable:!0},negToggle:{value:0,writable:!0}}),f=Object.seal(f),b.readUint(),f.length=b.readUshort()<<1,f.loop=b.readUshort()<<1,f.repeat=b.readUshort()<<1,f.negStart=c+(b.readUshort()<<1),f.negLen=b.readUshort()<<1,f.negSpeed=b.readUshort(),f.negDir=b.readUshort(),f.negOffset=b.readShort(),f.negPos=b.readUint(),f.negCtr=b.readUshort(),
b.position+=6,f.name=b.readString(32),f.pointer=c,f.loopPtr=c+f.loop,c+=f.length,this.samples[d]=f;f=c;a=++e;e=new Uint16Array(++e);for(d=0;d<a;++d)e[d]=b.readUshort();c=b.position;b.position=50;a=b.readUint();this.patterns=[];b.position=c;g=1;for(d=0;d<a;++d)h=AmigaRow(),Object.defineProperties(h,{speed:{value:0,writable:!0}}),h=Object.seal(h),(j=b.readByte())?0>j?h.speed=~j:112>j?(h.note=j,j=b.readByte(),d++,0>j?h.speed=~j:112>j?(h.sample=j,j=b.readByte(),d++,0>j?h.speed=~j:(h.effect=j,h.param=
b.readUbyte(),d++)):(h.effect=j,h.param=b.readUbyte(),d++)):(h.effect=j,h.param=b.readUbyte(),d++):(h.effect=b.readByte(),h.param=b.readUbyte(),d+=2),this.patterns[i++]=h,c+e[g]==b.position&&(e[g++]=i);e[g]=this.patterns.length;0!=(b.position&1)&&b.position++;this.mixer.store(b,f);a=this.tracks.length;for(d=0;d<a;++d)c=this.tracks[d],c.pattern=e[c.pattern];this.length++;this.version=2}}},process:{value:function(){var b,e,d,c,g,a=this.voices[0];this.arpeggioPos=++this.arpeggioPos&3;if(++this.tick>=
this.speed){for(this.tick=0;a;)b=a.channel,a.enabled=a.note=0,this.patternPos||(a.step=this.tracks[this.trackPos+a.index*this.length],a.pattern=a.step.pattern,a.speed=0),0>--a.speed&&(a.row=d=this.patterns[a.pattern++],a.speed=d.speed,d.note&&(a.enabled=1,a.note=d.note+a.step.transpose,b.enabled=0)),a.pitchBend=0,a.note&&(a.waveCtr=a.sustainCtr=0,a.arpeggioCtr=a.arpeggioPos=0,a.vibratoCtr=a.vibratoPos=0,a.pitchBendCtr=a.noteSlideSpeed=0,a.adsrPos=4,a.volume=0,d.sample&&(a.instrument=d.sample,a.instr=
this.instruments[a.instrument+a.step.soundTranspose],a.sample=this.samples[this.waves[a.instr.wave]]),a.original=a.note+this.arpeggios[a.instr.arpeggio],b.period=a.period=l[a.original],c=a.sample,b.pointer=c.pointer,b.length=c.length,b.enabled=a.enabled,b.pointer=c.loopPtr,b.length=c.repeat),a=a.next;++this.patternPos==this.patternLen&&(this.patternPos=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1))}for(a=this.voices[0];a;){if(a.sample&&(c=a.sample,!c.negToggle))if(c.negToggle=
1,c.negCtr)c.negCtr=--c.negCtr&31;else{c.negCtr=c.negSpeed;if(!c.negDir){a=a.next;continue}g=c.negStart+c.negPos;this.mixer.memory[g]=~this.mixer.memory[g];c.negPos+=c.negOffset;g=c.negLen-1;0>c.negPos?2==c.negDir?c.negPos=g:(c.negOffset=-c.negOffset,c.negPos+=c.negOffset):g<c.negPos&&(1==c.negDir?c.negPos=0:(c.negOffset=-c.negOffset,c.negPos+=c.negOffset))}a=a.next}for(a=this.voices[0];a;)a.sample&&(a.sample.negToggle=0),a=a.next;for(a=this.voices[0];a;){b=a.channel;e=a.instr;switch(a.adsrPos){case 4:a.volume+=
e.attackSpeed;e.attackMax<=a.volume&&(a.volume=e.attackMax,a.adsrPos--);break;case 3:e.decaySpeed?(a.volume-=e.decaySpeed,e.decayMin>=a.volume&&(a.volume=e.decayMin,a.adsrPos--)):a.adsrPos--;break;case 2:a.sustainCtr==e.sustain?a.adsrPos--:a.sustainCtr++;break;case 1:a.volume-=e.releaseSpeed,e.releaseMin>=a.volume&&(a.volume=e.releaseMin,a.adsrPos--)}b.volume=a.volume>>2;e.waveLen&&(a.waveCtr==e.waveDelay?(a.waveCtr=e.waveDelay-e.waveSpeed,a.wavePos==e.waveLen?a.wavePos=0:a.wavePos++,a.sample=c=this.samples[this.waves[e.wave+
a.wavePos]],b.pointer=c.pointer,b.length=c.length):a.waveCtr++);e.arpeggioLen&&(a.arpeggioCtr==e.arpeggioDelay?(a.arpeggioCtr=e.arpeggioDelay-e.arpeggioSpeed,a.arpeggioPos==e.arpeggioLen?a.arpeggioPos=0:a.arpeggioPos++,g=a.original+this.arpeggios[e.arpeggio+a.arpeggioPos],a.period=l[g]):a.arpeggioCtr++);d=a.row;if(this.tick)switch(d.effect){case 112:this.arpeggioFx[0]=d.param>>4;this.arpeggioFx[2]=d.param&15;g=a.original+this.arpeggioFx[this.arpeggioPos];a.period=l[g];break;case 113:a.pitchBend=~d.param+
1;break;case 114:a.pitchBend=d.param;break;case 115:if(0!=a.adsrPos)break;0!=a.instrument&&(a.volume=e.attackMax);a.volume+=d.param<<2;256<=a.volume&&(a.volume=-1);break;case 116:if(0!=a.adsrPos)break;0!=a.instrument&&(a.volume=e.attackMax);a.volume-=d.param<<2;0>a.volume&&(a.volume=0)}switch(d.effect){case 117:e.attackMax=d.param;e.attackSpeed=d.param;break;case 118:this.patternLen=d.param;break;case 124:b.volume=d.param;a.volume=d.param<<2;255<=a.volume&&(a.volume=255);break;case 127:if(g=d.param&
15)this.speed=g}e.vibratoLen&&(a.vibratoCtr==e.vibratoDelay?(a.vibratoCtr=e.vibratoDelay-e.vibratoSpeed,a.vibratoPos==e.vibratoLen?a.vibratoPos=0:a.vibratoPos++,a.period+=this.vibratos[e.vibrato+a.vibratoPos]):a.vibratoCtr++);e.pitchBend&&(a.pitchBendCtr==e.pitchBendDelay?a.pitchBend+=e.pitchBend:a.pitchBendCtr++);d.param&&d.effect&&112>d.effect&&(a.noteSlideTo=l[d.effect+a.step.transpose],g=d.param,0>a.noteSlideTo-a.period&&(g=-g),a.noteSlideSpeed=g);if(a.noteSlideTo&&a.noteSlideSpeed&&(a.period+=
a.noteSlideSpeed,0>a.noteSlideSpeed&&a.period<a.noteSlideTo||0<a.noteSlideSpeed&&a.period>a.noteSlideTo))a.noteSlideSpeed=0,a.period=a.noteSlideTo;a.period+=a.pitchBend;95>a.period?a.period=95:5760<a.period&&(a.period=5760);b.period=a.period;a=a.next}}}});i.voices[0]=k(0);i.voices[0].next=i.voices[1]=k(1);i.voices[1].next=i.voices[2]=k(2);i.voices[2].next=i.voices[3]=k(3);i.arpeggioFx=new Uint8Array(4);return Object.seal(i)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.1 - 2012/04/13

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function h(e){return Object.create(null,{index:{value:e,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},last:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.param=this.effect=this.last=this.period=this.enabled=0}}})}var i=[856,808,762,720,678,640,604,570,538,508,480,453,428,
404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0,0,0];window.neoart.STPlayer=function(e){e=AmigaPlayer(e);Object.defineProperties(e,{id:{value:"STPlayer"},standard:{value:0,writable:!0},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},force:{set:function(b){1>
b?b=1:4<b&&(b=4);this.version=b}},ntsc:{set:function(b){this.standard=b;this.frequency(b);2>this.version&&(b=(b?20.44952532:20.637767904)*(this.sampleRate/1E3)/120,this.mixer.samplesTick=(240-this.tempo)*b>>0)}},initialize:{value:function(){var b=this.voices[0];this.reset();this.ntsc=this.standard;this.speed=6;for(this.jumpFlag=this.patternPos=this.trackPos=0;b;)b.initialize(),b.channel=this.mixer.channels[b.index],b.sample=this.samples[0],b=b.next}},loader:{value:function(b){var d=0,c,a,e=0,g=0,
f;if(!(1626>b.length)){this.title=b.readString(20);e+=this.isLegal(this.title);this.version=1;b.position=42;for(c=1;16>c;++c)(f=b.readUshort())?(a=AmigaSample(),b.position-=24,a.name=b.readString(22),a.length=f<<1,b.position+=3,a.volume=b.readUbyte(),a.loop=b.readUshort(),a.repeat=b.readUshort()<<1,b.position+=22,a.pointer=g,g+=a.length,this.samples[c]=a,e+=this.isLegal(a.name),9999<a.length&&(this.version=3)):(this.samples[c]=null,b.position+=28);b.position=470;this.length=b.readUbyte();this.tempo=
b.readUbyte();for(c=0;128>c;++c)f=b.readUbyte()<<8,16384<f&&e--,this.track[c]=f,f>d&&(d=f);b.position=600;d+=256;this.patterns.length=d;c=b.length-g-600>>2;d>c&&(d=c);for(c=0;c<d;++c){a=AmigaRow();a.note=b.readUshort();f=b.readUbyte();a.param=b.readUbyte();a.effect=f&15;a.sample=f>>4;this.patterns[c]=a;2<a.effect&&11>a.effect&&e--;a.note&&(113>a.note||856<a.note)&&e--;if(a.sample&&(15<a.sample||!this.samples[a.sample]))15<a.sample&&e--,a.sample=0;if(2<a.effect||!a.effect&&0!=a.param)this.version=
2;if(11==a.effect||13==a.effect)this.version=4}this.mixer.store(b,g);for(c=1;16>c;++c)if(a=this.samples[c]){a.loop?(a.loopPtr=a.pointer+a.loop,a.pointer=a.loopPtr,a.length=a.repeat):(a.loopPtr=this.mixer.memory.length,a.repeat=2);g=a.pointer+4;for(b=a.pointer;b<g;++b)this.mixer.memory[b]=0}a=AmigaSample();a.pointer=a.loopPtr=this.mixer.memory.length;a.length=a.repeat=2;this.samples[0]=a;1>e&&(this.version=0)}}},process:{value:function(){var b,d,c,a=this.voices[0];if(this.tick)for(;a;){if(a.param)if(b=
a.channel,1==this.version)1==a.effect?this.arpeggio(a):2==a.effect&&(c=a.param>>4,a.period=c?a.period+c:a.period-(a.param&15),b.period=a.period);else{switch(a.effect){case 0:this.arpeggio(a);break;case 1:a.last-=a.param&15;113>a.last&&(a.last=113);b.period=a.last;break;case 2:a.last+=a.param&15,856<a.last&&(a.last=856),b.period=a.last}if(2!=(this.version&2)){a=a.next;continue}switch(a.effect){case 12:b.volume=a.param;break;case 13:this.mixer.filter.active=0;break;case 14:this.speed=a.param&15}}a=
a.next}else for(c=this.track[this.trackPos]+this.patternPos;a;){b=a.channel;a.enabled=0;d=this.patterns[c+a.index];a.period=d.note;a.effect=d.effect;a.param=d.param;d.sample?(d=a.sample=this.samples[d.sample],b.volume=2==(this.version&2)&&12==a.effect?a.param:d.volume):d=a.sample;a.period&&(a.enabled=1,b.enabled=0,b.pointer=d.pointer,b.length=d.length,b.period=a.last=a.period);a.enabled&&(b.enabled=1);b.pointer=d.loopPtr;b.length=d.repeat;if(!(4>this.version))switch(a.effect){case 11:this.trackPos=
a.param-1;this.jumpFlag^=1;break;case 12:b.volume=a.param;break;case 13:this.jumpFlag^=1;break;case 14:this.mixer.filter.active=a.param^1;break;case 15:if(!a.param)break;this.speed=a.param&15;this.tick=0}a=a.next}if(++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag))this.patternPos=this.jumpFlag=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1)}},arpeggio:{value:function(b){var d=b.channel,c=0,a=this.tick%3;if(a){for(a=1==a?b.param>>
4:b.param&15;b.last!=i[c];)c++;d.period=i[c+a]}else d.period=b.last}},isLegal:{value:function(b){var d,c=0,a=b.length;if(!a)return 0;for(;c<a;++c)if((d=b.charCodeAt(c))&&(32>d||127<d))return 0;return 1}}});e.voices[0]=h(0);e.voices[0].next=e.voices[1]=h(1);e.voices[1].next=e.voices[2]=h(2);e.voices[2].next=e.voices[3]=h(3);e.track=new Uint16Array(128);return Object.seal(e)}})();/*
  Flod JS 2.1
  2012/04/30
  Christian Corti
  Neoart Costa Rica

  Last Update: Flod JS 2.0 - 2012/03/05

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
  IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.
  To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to
  Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
*/
(function(){function y(m){m=Object.create(null,{index:{value:m,writable:!0},next:{value:null,writable:!0},flags:{value:0,writable:!0},delay:{value:0,writable:!0},channel:{value:null,writable:!0},patternLoop:{value:0,writable:!0},patternLoopRow:{value:0,writable:!0},playing:{value:null,writable:!0},note:{value:0,writable:!0},keyoff:{value:0,writable:!0},period:{value:0,writable:!0},finetune:{value:0,writable:!0},arpDelta:{value:0,writable:!0},vibDelta:{value:0,writable:!0},instrument:{value:null,writable:!0},
autoVibratoPos:{value:0,writable:!0},autoSweep:{value:0,writable:!0},autoSweepPos:{value:0,writable:!0},sample:{value:null,writable:!0},sampleOffset:{value:0,writable:!0},volume:{value:0,writable:!0},volEnabled:{value:0,writable:!0},volEnvelope:{value:null,writable:!0},volDelta:{value:0,writable:!0},volSlide:{value:0,writable:!0},volSlideMaster:{value:0,writable:!0},fineSlideU:{value:0,writable:!0},fineSlideD:{value:0,writable:!0},fadeEnabled:{value:0,writable:!0},fadeDelta:{value:0,writable:!0},
fadeVolume:{value:0,writable:!0},panning:{value:0,writable:!0},panEnabled:{value:0,writable:!0},panEnvelope:{value:null,writable:!0},panSlide:{value:0,writable:!0},portaU:{value:0,writable:!0},portaD:{value:0,writable:!0},finePortaU:{value:0,writable:!0},finePortaD:{value:0,writable:!0},xtraPortaU:{value:0,writable:!0},xtraPortaD:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},glissando:{value:0,writable:!0},glissPeriod:{value:0,writable:!0},vibratoPos:{value:0,
writable:!0},vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},vibratoReset:{value:0,writable:!0},tremoloPos:{value:0,writable:!0},tremoloSpeed:{value:0,writable:!0},tremoloDepth:{value:0,writable:!0},waveControl:{value:0,writable:!0},tremorPos:{value:0,writable:!0},tremorOn:{value:0,writable:!0},tremorOff:{value:0,writable:!0},tremorVolume:{value:0,writable:!0},retrigx:{value:0,writable:!0},retrigy:{value:0,writable:!0},reset:{value:function(){this.volume=this.sample.volume;this.panning=
this.sample.panning;this.finetune=this.sample.finetune>>3<<2;this.fadeDelta=this.fadeEnabled=this.volDelta=this.keyoff=0;this.fadeVolume=65536;this.autoVibratoPos=0;this.autoSweep=1;this.vibratoReset=this.vibDelta=this.autoSweepPos=0;4>(this.waveControl&15)&&(this.vibratoPos=0);4>this.waveControl>>4&&(this.tremoloPos=0)}},autoVibrato:{value:function(){var a;this.autoVibratoPos=this.autoVibratoPos+this.playing.vibratoSpeed&255;switch(this.playing.vibratoType){case 0:a=z[this.autoVibratoPos];break;
case 1:a=128>this.autoVibratoPos?-64:64;break;case 2:a=(64+(this.autoVibratoPos>>1)&127)-64;break;case 3:a=(64-(this.autoVibratoPos>>1)&127)-64}a*=this.playing.vibratoDepth;this.autoSweep&&(this.playing.vibratoSweep?this.autoSweepPos>this.playing.vibratoSweep?(this.autoSweepPos&2&&(a*=this.autoSweepPos/this.playing.vibratoSweep),this.autoSweep=0):a*=++this.autoSweepPos/this.playing.vibratoSweep:this.autoSweep=0);this.flags|=j;return a>>6}},tonePortamento:{value:function(){this.glissPeriod||(this.glissPeriod=
this.period);this.period<this.portaPeriod?(this.glissPeriod+=this.portaSpeed<<2,this.period=this.glissando?Math.round(this.glissPeriod/64)<<6:this.glissPeriod,this.period>=this.portaPeriod&&(this.period=this.portaPeriod,this.glissPeriod=this.portaPeriod=0)):this.period>this.portaPeriod&&(this.glissPeriod-=this.portaSpeed<<2,this.period=this.glissando?Math.round(this.glissPeriod/64)<<6:this.glissPeriod,this.period<=this.portaPeriod&&(this.period=this.portaPeriod,this.glissPeriod=this.portaPeriod=0));
this.flags|=j}},tremolo:{value:function(){var a=255,e=this.tremoloPos&31;switch(this.waveControl>>4&3){case 0:a=s[e];break;case 1:a=e<<3}this.volDelta=a*this.tremoloDepth>>6;31<this.tremoloPos&&(this.volDelta=-this.volDelta);this.tremoloPos=this.tremoloPos+this.tremoloSpeed&63;this.flags|=i}},tremor:{value:function(){this.tremorPos==this.tremorOn?(this.tremorVolume=this.volume,this.volume=0):(this.tremorPos=0,this.volume=this.tremorVolume);this.flags|=i;this.tremorPos++}},vibrato:{value:function(){var a=
255,e=this.vibratoPos&31;switch(this.waveControl&3){case 0:a=s[e];break;case 1:a=e<<3,31<this.vibratoPos&&(a=255-a)}this.vibDelta=a*this.vibratoDepth>>7;31<this.vibratoPos&&(this.vibDelta=-this.vibDelta);this.vibratoPos=this.vibratoPos+this.vibratoSpeed&63;this.flags|=j}}});m.volEnvelope=t();m.panEnvelope=t();return Object.seal(m)}function o(){return Object.create(null,{points:{value:[],writable:!0},total:{value:0,writable:!0},sustain:{value:0,writable:!0},loopStart:{value:0,writable:!0},loopEnd:{value:0,
writable:!0},flags:{value:0,writable:!0}})}function t(){return Object.create(null,{value:{value:0,writable:!0},position:{value:0,writable:!0},frame:{value:0,writable:!0},delta:{value:0,writable:!0},fraction:{value:0,writable:!0},stopped:{value:0,writable:!0},reset:{value:function(){this.stopped=this.fraction=this.delta=this.frame=this.position=this.value=0}}})}function u(){var i=Object.create(null,{name:{value:"",writable:!0},samples:{value:[],writable:!0},noteSamples:{value:null,writable:!0},fadeout:{value:0,
writable:!0},volData:{value:null,writable:!0},volEnabled:{value:0,writable:!0},panData:{value:null,writable:!0},panEnabled:{value:0,writable:!0},vibratoType:{value:0,writable:!0},vibratoSweep:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0}});i.noteSamples=new Uint8Array(96);i.volData=o();i.panData=o();return Object.seal(i)}function v(i,a){var e=Object.create(null,{rows:{value:[],writable:!0},length:{value:0,writable:!0},size:{value:0,writable:!0}});e.rows.length=
e.size=i*a;e.length=i;return Object.seal(e)}function p(i,a){var e=Object.create(null,{frame:{value:0,writable:!0},value:{value:0,writable:!0}});e.frame=i||0;e.value=a||0;return Object.seal(e)}function q(){return Object.create(null,{note:{value:0,writable:!0},instrument:{value:0,writable:!0},volume:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0}})}function w(){var i=SBSample();Object.defineProperties(i,{finetune:{value:0,writable:!0},panning:{value:0,writable:!0},relative:{value:0,
writable:!0}});return Object.seal(i)}var j=1,i=2,z=[0,-2,-3,-5,-6,-8,-9,-11,-12,-14,-16,-17,-19,-20,-22,-23,-24,-26,-27,-29,-30,-32,-33,-34,-36,-37,-38,-39,-41,-42,-43,-44,-45,-46,-47,-48,-49,-50,-51,-52,-53,-54,-55,-56,-56,-57,-58,-59,-59,-60,-60,-61,-61,-62,-62,-62,-63,-63,-63,-64,-64,-64,-64,-64,-64,-64,-64,-64,-64,-64,-63,-63,-63,-62,-62,-62,-61,-61,-60,-60,-59,-59,-58,-57,-56,-56,-55,-54,-53,-52,-51,-50,-49,-48,-47,-46,-45,-44,-43,-42,-41,-39,-38,-37,-36,-34,-33,-32,-30,-29,-27,-26,-24,-23,-22,
-20,-19,-17,-16,-14,-12,-11,-9,-8,-6,-5,-3,-2,0,2,3,5,6,8,9,11,12,14,16,17,19,20,22,23,24,26,27,29,30,32,33,34,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,56,57,58,59,59,60,60,61,61,62,62,62,63,63,63,64,64,64,64,64,64,64,64,64,64,64,63,63,63,62,62,62,61,61,60,60,59,59,58,57,56,56,55,54,53,52,51,50,49,48,47,46,45,44,43,42,41,39,38,37,36,34,33,32,30,29,27,26,24,23,22,20,19,17,16,14,12,11,9,8,6,5,3,2],s=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,
212,197,180,161,141,120,97,74,49,24],n=[0,0.04417,0.062489,0.076523,0.088371,0.098821,0.108239,0.116927,0.124977,0.132572,0.139741,0.146576,0.153077,0.159335,0.16535,0.171152,0.176772,0.18221,0.187496,0.19263,0.197643,0.202503,0.207273,0.211951,0.216477,0.220943,0.225348,0.229631,0.233854,0.237985,0.242056,0.246066,0.249985,0.253873,0.25767,0.261437,0.265144,0.268819,0.272404,0.275989,0.279482,0.282976,0.286409,0.289781,0.293153,0.296464,0.299714,0.302965,0.306185,0.309344,0.312473,0.315602,0.318671,
0.321708,0.324746,0.327754,0.3307,0.333647,0.336563,0.339449,0.342305,0.345161,0.347986,0.350781,0.353545,0.356279,0.359013,0.361717,0.364421,0.367094,0.369737,0.37238,0.374992,0.377574,0.380157,0.382708,0.38526,0.387782,0.390303,0.392794,0.395285,0.397746,0.400176,0.402606,0.405037,0.407437,0.409836,0.412206,0.414576,0.416915,0.419254,0.421563,0.423841,0.42618,0.428458,0.430737,0.432985,0.435263,0.437481,0.439729,0.441916,0.444134,0.446321,0.448508,0.450665,0.452852,0.455009,0.457136,0.459262,0.461389,
0.463485,0.465611,0.467708,0.469773,0.471839,0.473935,0.47597,0.478036,0.480072,0.482077,0.484112,0.486117,0.488122,0.490127,0.492101,0.494106,0.496051,0.498025,0.5,0.501944,0.503888,0.505802,0.507746,0.50966,0.511574,0.513488,0.515371,0.517255,0.519138,0.521022,0.522905,0.524758,0.526611,0.528465,0.530318,0.53214,0.533993,0.535816,0.537639,0.539462,0.541254,0.543046,0.544839,0.546631,0.548423,0.550216,0.551978,0.553739,0.555501,0.557263,0.558995,0.560757,0.562489,0.56422,0.565952,0.567683,0.569384,
0.571116,0.572817,0.574518,0.57622,0.57789,0.579592,0.581262,0.582964,0.584634,0.586305,0.587946,0.589617,0.591257,0.592928,0.594568,0.596209,0.597849,0.599459,0.6011,0.60271,0.60435,0.60596,0.60757,0.60915,0.61076,0.61237,0.61395,0.61556,0.617139,0.618719,0.620268,0.621848,0.623428,0.624977,0.626557,0.628106,0.629655,0.631205,0.632754,0.634303,0.635822,0.637372,0.63889,0.64044,0.641959,0.643478,0.644966,0.646485,0.648004,0.649523,0.651012,0.6525,0.653989,0.655477,0.656966,0.658454,0.659943,0.661431,
0.66289,0.664378,0.665836,0.667294,0.668783,0.670241,0.671699,0.673127,0.674585,0.676043,0.677471,0.678929,0.680357,0.681785,0.683213,0.684641,0.686068,0.687496,0.688894,0.690321,0.691749,0.693147,0.694574,0.695972,0.697369,0.698767,0.700164,0.701561,0.702928,0.704326,0.705723,0.70711],x=[0,0.005863,0.013701,0.021569,0.029406,0.037244,0.045082,0.052919,0.060757,0.068625,0.076463,0.0843,0.092138,0.099976,0.107844,0.115681,0.123519,0.131357,0.139194,0.147032,0.1549,0.162738,0.170575,0.178413,0.186251,
0.194119,0.201956,0.209794,0.217632,0.225469,0.233307,0.241175,0.249013,0.25685,0.264688,0.272526,0.280394,0.288231,0.296069,0.303907,0.311744,0.319582,0.32745,0.335288,0.343125,0.350963,0.3588,0.366669,0.374506,0.382344,0.390182,0.398019,0.405857,0.413725,0.421563,0.4294,0.437238,0.445076,0.452944,0.460781,0.468619,0.476457,0.484294,0.492132,0.5],r=[29024,27392,25856,24384,23040,21696,20480,19328,18240,17216,16256,15360,14512,13696,12928,12192,11520,10848,10240,9664,9120,8608,8128,7680,7256,6848,
6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3628,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1814,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,907,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,227,214,202,190,180,169,160,151,142,134,127,120,113,107,101,95,90,85,80,75,71,67,63,60,57,53,50,48,45,42,40,38,36,34,32,30,28];window.neoart.F2Player=function(m){m=SBPlayer(m);Object.defineProperties(m,{id:{value:"F2Player"},patterns:{value:[],
writable:!0},instruments:{value:[],writable:!0},voices:{value:[],writable:!0},linear:{value:0,writable:!0},complete:{value:0,writable:!0},order:{value:0,writable:!0},position:{value:0,writable:!0},nextOrder:{value:0,writable:!0},nextPosition:{value:0,writable:!0},pattern:{value:null,writable:!0},patternDelay:{value:0,writable:!0},patternOffset:{value:0,writable:!0},timer:{value:0,writable:!0},initialize:{value:function(){var a=0,e;this.reset();this.timer=this.speed;this.position=this.order=0;this.nextPosition=
this.nextOrder=-1;this.complete=this.patternOffset=this.patternDelay=0;this.master=64;for(this.voices.length=this.channels;a<this.channels;++a)e=y(a),e.channel=this.mixer.channels[a],e.playing=this.instruments[0],e.sample=e.playing.samples[0],this.voices[a]=e,a&&(this.voices[a-1].next=e)}},loader:{value:function(a){var e,d,h,f,c,i,g,b=22,j,k;if(!(360>a.length)){a.position=17;this.title=a.readString(20);a.position++;d=a.readString(20);if("FastTracker v2.00   "==d||"FastTracker v 2.00  "==d)this.version=
1;else if("Sk@le Tracker"==d)this.version=b=2;else if("MadTracker 2.0"==d)this.version=3;else if("MilkyTracker        "==d)this.version=4;else if("DigiBooster Pro 2.18"==d)this.version=5;else if(-1!=d.indexOf("OpenMPT"))this.version=6;else return;a.readUshort();e=a.readUint();this.length=a.readUshort();this.restart=a.readUshort();this.channels=a.readUshort();k=j=a.readUshort();this.instruments=[];this.instruments.length=a.readUshort()+1;this.linear=a.readUshort();this.speed=a.readUshort();this.tempo=
a.readUshort();this.track=new Uint8Array(this.length);for(d=0;d<this.length;++d)h=a.readUbyte(),h>=k&&(j=h+1),this.track[d]=h;this.patterns=[];this.patterns.length=j;if(j!=k){f=v(64,this.channels);h=f.size;for(d=0;d<h;++d)f.rows[d]=q();this.patterns[--j]=f}a.position=g=e+60;i=k;for(d=0;d<i;++d){e=a.readUint();a.position++;f=v(a.readUshort(),this.channels);j=f.size;k=a.readUshort();a.position=g+e;c=a.position+k;if(k)for(h=0;h<j;++h){e=q();k=a.readUbyte();if(k&128){if(k&1&&(e.note=a.readUbyte()),k&
2&&(e.instrument=a.readUbyte()),k&4&&(e.volume=a.readUbyte()),k&8&&(e.effect=a.readUbyte()),k&16)e.param=a.readUbyte()}else e.note=k,e.instrument=a.readUbyte(),e.volume=a.readUbyte(),e.effect=a.readUbyte(),e.param=a.readUbyte();97!=e.note&&96<e.note&&(e.note=0);f.rows[h]=e}else for(h=0;h<j;++h)f.rows[h]=q();this.patterns[d]=f;g=a.position;g!=c&&(g=a.position=c)}c=a.position;i=this.instruments.length;for(d=1;d<i;++d){h=a.readUint();if(a.position+h>=a.length)break;f=u();f.name=a.readString(22);a.position++;
k=a.readUshort();16<k&&(k=16);e=a.readUint();2==b&&64!=e&&(e=64);if(k){f.samples=[];f.samples.length=k;for(h=0;96>h;++h)f.noteSamples[h]=a.readUbyte();for(h=0;12>h;++h)f.volData.points[h]=p(a.readUshort(),a.readUshort());for(h=0;12>h;++h)f.panData.points[h]=p(a.readUshort(),a.readUshort());f.volData.total=a.readUbyte();f.panData.total=a.readUbyte();f.volData.sustain=a.readUbyte();f.volData.loopStart=a.readUbyte();f.volData.loopEnd=a.readUbyte();f.panData.sustain=a.readUbyte();f.panData.loopStart=
a.readUbyte();f.panData.loopEnd=a.readUbyte();f.volData.flags=a.readUbyte();f.panData.flags=a.readUbyte();f.volData.flags&1&&(f.volEnabled=1);f.panData.flags&1&&(f.panEnabled=1);f.vibratoType=a.readUbyte();f.vibratoSweep=a.readUbyte();f.vibratoDepth=a.readUbyte();f.vibratoSpeed=a.readUbyte();f.fadeout=a.readUshort()<<1;a.position+=b;g=a.position;this.instruments[d]=f;for(h=0;h<k;++h)c=w(),c.length=a.readUint(),c.loopStart=a.readUint(),c.loopLen=a.readUint(),c.volume=a.readUbyte(),c.finetune=a.readByte(),
c.loopMode=a.readUbyte(),c.panning=a.readUbyte(),c.relative=a.readByte(),a.position++,c.name=a.readString(22),f.samples[h]=c,a.position=g+=e;for(h=0;h<k;++h)if(c=f.samples[h],c.length)g=a.position+c.length,c.loopMode&16&&(c.bits=16,c.loopMode^=16,c.length>>=1,c.loopStart>>=1,c.loopLen>>=1),c.loopLen||(c.loopMode=0),c.store(a),c.loopMode&&(c.length=c.loopStart+c.loopLen),a.position=g}else a.position=c+h;c=a.position;if(c>=a.length)break}f=u();f.volData=o();f.panData=o();f.samples=[];for(d=0;12>d;++d)f.volData.points[d]=
p(),f.panData.points[d]=p();c=w();c.length=220;c.data=new Float32Array(220);for(d=0;220>d;++d)c.data[d]=0;f.samples[0]=c;this.instruments[0]=f}}},process:{value:function(){var a,e,d,h,f,c,l,g,b=this.voices[0];if(this.tick)for(;b;){c=this.pattern.rows[this.position+b.index];if(b.delay)if((c.param&15)==this.tick)b.flags=b.delay,b.delay=0;else{b=b.next;continue}if(c.volume)switch(e=c.volume>>4,d=c.volume&15,e){case 6:b.volume-=d;0>b.volume&&(b.volume=0);b.flags|=i;break;case 7:b.volume+=d;64<b.volume&&
(b.volume=64);b.flags|=i;break;case 11:b.vibrato();break;case 13:b.panning-=d;0>b.panning&&(b.panning=0);b.flags|=4;break;case 14:b.panning+=d;255<b.panning&&(b.panning=255);b.flags|=4;break;case 15:b.portaPeriod&&b.tonePortamento()}e=c.param>>4;d=c.param&15;switch(c.effect){case 0:if(!c.param)break;g=(this.tick-this.timer)%3;0>g&&(g+=3);2==this.tick&&18==this.timer&&(g=0);g?1==g?this.linear?b.arpDelta=-(d<<6):(g=this.amiga(b.note+d,b.finetune),b.arpDelta=g-b.period):this.linear?b.arpDelta=-(e<<6):
(g=this.amiga(b.note+e,b.finetune),b.arpDelta=g-b.period):b.arpDelta=0;b.flags|=j;break;case 1:b.period-=b.portaU;0>b.period&&(b.period=0);b.flags|=j;break;case 2:b.period+=b.portaD;9212<b.period&&(b.period=9212);b.flags|=j;break;case 3:b.portaPeriod&&b.tonePortamento();break;case 4:e&&(b.vibratoSpeed=e);d&&(b.vibratoDepth=d<<2);b.vibrato();break;case 5:f=1;b.portaPeriod&&b.tonePortamento();break;case 6:f=1;b.vibrato();break;case 7:b.tremolo();break;case 10:f=1;break;case 14:switch(e){case 9:0==this.tick%
d&&(b.volEnvelope.reset(),b.panEnvelope.reset(),b.flags|=i|12);break;case 12:this.tick==d&&(b.volume=0,b.flags|=i)}break;case 17:e=b.volSlideMaster>>4;d=b.volSlideMaster&15;e?(this.master+=e,64<this.master&&(this.master=64),b.flags|=i):d&&(this.master-=d,0>this.master&&(this.master=0),b.flags|=i);break;case 20:this.tick==c.param&&(b.fadeEnabled=1,b.keyoff=1);break;case 24:e=b.panSlide>>4;d=b.panSlide&15;e?(b.panning+=e,255<b.panning&&(b.panning=255),b.flags|=4):d&&(b.panning-=d,0>b.panning&&(b.panning=
0),b.flags|=4);break;case 27:a=this.tick;c.volume||a++;if(a%b.retrigy)break;(!c.volume||80<c.volume)&&b.retrigx&&this.retrig(b);b.flags|=8;break;case 29:b.tremor()}f&&(e=b.volSlide>>4,d=b.volSlide&15,f=0,e?(b.volume+=e,b.flags|=i):d&&(b.volume-=d,b.flags|=i));b=b.next}else{0<=this.nextOrder&&(this.order=this.nextOrder);0<=this.nextPosition&&(this.position=this.nextPosition);this.nextOrder=this.nextPosition=-1;for(this.pattern=this.patterns[this.track[this.order]];b;){c=this.pattern.rows[this.position+
b.index];a=c.volume>>4;f=3==c.effect||5==c.effect||15==a;e=c.param>>4;b.keyoff=0;b.arpDelta&&(b.arpDelta=0,b.flags|=j);if(c.instrument)b.instrument=c.instrument<this.instruments.length?this.instruments[c.instrument]:null,b.volEnvelope.reset(),b.panEnvelope.reset(),b.flags|=i|36;else if(97==c.note||20==c.effect&&!c.param)b.fadeEnabled=1,b.keyoff=1;if(c.note&&97!=c.note)if(b.instrument){if(d=b.instrument,g=c.note-1,l=d.samples[d.noteSamples[g]],g+=l.relative,0<=g&&118>=g)(f||(b.note=g,b.sample=l,c.instrument?
(b.volEnabled=d.volEnabled,b.panEnabled=d.panEnabled,b.flags|=15):b.flags|=j|8),c.instrument?(b.reset(),b.fadeDelta=d.fadeout):b.finetune=l.finetune>>3<<2,14==c.effect&&5==e&&(b.finetune=(c.param&15)-8<<3),g=this.linear?(120-g<<6)-b.finetune:this.amiga(g,b.finetune),f)?b.portaPeriod=g:(b.period=g,b.glissPeriod=0)}else b.volume=0,b.flags=i|32;else b.vibratoReset&&4!=c.effect&&6!=c.effect&&(b.vibDelta=0,b.vibratoReset=0,b.flags|=j);if(c.volume)if(16<=c.volume&&80>=c.volume)b.volume=c.volume-16,b.flags|=
i|32;else switch(d=c.volume&15,a){case 6:b.volume-=d;0>b.volume&&(b.volume=0);b.flags|=i;break;case 7:b.volume+=d;64<b.volume&&(b.volume=64);b.flags|=i;break;case 10:d&&(b.vibratoSpeed=d);break;case 11:d&&(b.vibratoDepth=d<<2);break;case 12:b.panning=d<<4;b.flags|=4;break;case 15:d&&(b.portaSpeed=d<<4)}if(c.effect)switch(d=c.param&15,c.effect){case 1:c.param&&(b.portaU=c.param<<2);break;case 2:c.param&&(b.portaD=c.param<<2);break;case 3:c.param&&15!=a&&(b.portaSpeed=c.param);break;case 4:b.vibratoReset=
1;break;case 5:c.param&&(b.volSlide=c.param);break;case 6:c.param&&(b.volSlide=c.param);b.vibratoReset=1;break;case 7:e&&(b.tremoloSpeed=e);d&&(b.tremoloDepth=d);break;case 8:b.panning=c.param;b.flags|=4;break;case 9:c.param&&(b.sampleOffset=c.param<<8);b.sampleOffset>=b.sample.length&&(b.volume=0,b.sampleOffset=0,b.flags&=~(j|8),b.flags|=i|32);break;case 10:c.param&&(b.volSlide=c.param);break;case 11:this.nextOrder=c.param;this.nextOrder>=this.length?this.complete=1:this.nextPosition=0;h=1;this.patternOffset=
0;break;case 12:b.volume=c.param;b.flags|=i|32;break;case 13:this.nextPosition=(10*e+d)*this.channels;this.patternOffset=0;h||(this.nextOrder=this.order+1,this.nextOrder>=this.length&&(this.complete=1,this.nextPosition=-1));break;case 14:switch(e){case 1:d&&(b.finePortaU=d<<2);b.period-=b.finePortaU;b.flags|=j;break;case 2:d&&(b.finePortaD=d<<2);b.period+=b.finePortaD;b.flags|=j;break;case 3:b.glissando=d;break;case 4:b.waveControl=b.waveControl&240|d;break;case 6:d?(b.patternLoop?b.patternLoop--:
b.patternLoop=d,b.patternLoop&&(this.nextPosition=b.patternLoopRow)):b.patternLoopRow=this.patternOffset=this.position;break;case 7:b.waveControl=b.waveControl&15|d<<4;break;case 10:d&&(b.fineSlideU=d);b.volume+=b.fineSlideU;b.flags|=i;break;case 11:d&&(b.fineSlideD=d);b.volume-=b.fineSlideD;b.flags|=i;break;case 13:b.delay=b.flags;b.flags=0;break;case 14:this.patternDelay=d*this.timer}break;case 15:if(!c.param)break;32>c.param?this.timer=c.param:this.mixer.samplesTick=2.5*this.sampleRate/c.param>>
0;break;case 16:this.master=c.param;64<this.master&&(this.master=64);b.flags|=i;break;case 17:c.param&&(b.volSlideMaster=c.param);break;case 21:if(!b.instrument||!b.instrument.volEnabled)break;d=b.instrument;g=c.param;e=d.volData.total;for(a=0;a<e&&!(g<d.volData.points[a].frame);a++);b.volEnvelope.position=--a;e--;d.volData.flags&4&&a==d.volData.loopEnd&&(a=b.volEnvelope.position=d.volData.loopStart,g=d.volData.points[a].frame,b.volEnvelope.frame=g);a>=e?(b.volEnvelope.value=d.volData.points[e].value,
b.volEnvelope.stopped=1):(b.volEnvelope.stopped=0,b.volEnvelope.frame=g,g>d.volData.points[a].frame&&b.volEnvelope.position++,e=d.volData.points[a],a=d.volData.points[++a],g=a.frame-e.frame,b.volEnvelope.delta=(g?(a.value-e.value<<8)/g>>0:0)||0,b.volEnvelope.fraction=e.value<<8);break;case 24:c.param&&(b.panSlide=c.param);break;case 27:e&&(b.retrigx=e);d&&(b.retrigy=d);if(!c.volume&&b.retrigy){a=this.tick+1;if(a%b.retrigy)break;80<c.volume&&b.retrigx&&this.retrig(b)}break;case 29:c.param&&(b.tremorOn=
++e,b.tremorOff=++d+e);break;case 33:1==e?(d&&(b.xtraPortaU=d),b.period-=b.xtraPortaU,b.flags|=j):2==e&&(d&&(b.xtraPortaD=d),b.period+=b.xtraPortaD,b.flags|=j)}b=b.next}}if(++this.tick>=this.timer+this.patternDelay&&(this.patternDelay=this.tick=0,0>this.nextPosition&&(this.nextPosition=this.position+this.channels,this.nextPosition>=this.pattern.size||this.complete)))this.nextOrder=this.order+1,this.nextPosition=this.patternOffset,this.nextOrder>=this.length&&(this.nextOrder=this.restart,this.mixer.complete=
1)}},fast:{value:function(){for(var a,e,d,h,f,c=this.voices[0],l;c;)a=c.channel,d=c.flags,c.flags=0,d&8&&(a.index=c.sampleOffset,a.pointer=-1,a.dir=0,a.fraction=0,a.sample=c.sample,a.length=c.sample.length,a.enabled=a.sample.data?1:0,c.playing=c.instrument,c.sampleOffset=0),h=c.playing,e=h.vibratoSpeed?c.autoVibrato():0,l=c.volume+c.volDelta,h.volEnabled?(c.volEnabled&&!c.volEnvelope.stopped&&this.envelope(c,c.volEnvelope,h.volData),l=l*c.volEnvelope.value>>6,d|=i,c.fadeEnabled&&(c.fadeVolume-=c.fadeDelta,
0>c.fadeVolume?(l=0,c.fadeVolume=0,c.fadeEnabled=0,c.volEnvelope.value=0,c.volEnvelope.stopped=1,c.panEnvelope.stopped=1):l=l*c.fadeVolume>>16)):c.keyoff&&(l=0,d|=i),f=c.panning,h.panEnabled&&(c.panEnabled&&!c.panEnvelope.stopped&&this.envelope(c,c.panEnvelope,h.panData),f=c.panEnvelope.value<<2,d|=4,0>f?f=0:255<f&&(f=255)),d&i&&(0>l?l=0:64<l&&(l=64),a.volume=x[l*this.master>>6],a.lvol=a.volume*a.lpan,a.rvol=a.volume*a.rpan),d&4&&(a.panning=f,a.lpan=n[256-f],a.rpan=n[f],a.lvol=a.volume*a.lpan,a.rvol=
a.volume*a.rpan),d&j&&(e+=c.period+c.arpDelta+c.vibDelta,a.speed=this.linear?(548077568*Math.pow(2,(4608-e)/768)/this.sampleRate>>0)/65536:(65536*(14317456/e)/this.sampleRate>>0)/65536,a.delta=a.speed>>0,a.speed-=a.delta),c=c.next}},accurate:{value:function(){for(var a,e,d,h,f,c,l,g=this.voices[0];g;){a=g.channel;d=g.flags;g.flags=0;d&8&&(a.sample&&(d|=32,a.mixCounter=220,a.oldSample=null,a.oldPointer=-1,a.enabled&&(a.oldDir=a.dir,a.oldFraction=a.fraction,a.oldSpeed=a.speed,a.oldSample=a.sample,a.oldPointer=
a.pointer,a.oldLength=a.length,a.lmixRampD=a.lvol,a.lmixDeltaD=a.lvol/220,a.rmixRampD=a.rvol,a.rmixDeltaD=a.rvol/220)),a.dir=1,a.fraction=0,a.sample=g.sample,a.pointer=g.sampleOffset,a.length=g.sample.length,a.enabled=a.sample.data?1:0,g.playing=g.instrument,g.sampleOffset=0);h=g.playing;e=h.vibratoSpeed?g.autoVibrato():0;f=g.volume+g.volDelta;h.volEnabled?(g.volEnabled&&!g.volEnvelope.stopped&&this.envelope(g,g.volEnvelope,h.volData),f=f*g.volEnvelope.value>>6,d|=i,g.fadeEnabled&&(g.fadeVolume-=
g.fadeDelta,0>g.fadeVolume?(f=0,g.fadeVolume=0,g.fadeEnabled=0,g.volEnvelope.value=0,g.volEnvelope.stopped=1,g.panEnvelope.stopped=1):f=f*g.fadeVolume>>16)):g.keyoff&&(f=0,d|=i);c=g.panning;h.panEnabled&&(g.panEnabled&&!g.panEnvelope.stopped&&this.envelope(g,g.panEnvelope,h.panData),c=g.panEnvelope.value<<2,d|=4,0>c?c=0:255<c&&(c=255));if(a.enabled){if(d&i&&(0>f?f=0:64<f&&(f=64),f=x[f*this.master>>6],h=f*n[256-c],l=f*n[c],f!=a.volume&&!a.mixCounter?(a.volCounter=d&32?220:this.mixer.samplesTick,a.lvolDelta=
(h-a.lvol)/a.volCounter,a.rvolDelta=(l-a.rvol)/a.volCounter):(a.lvol=h,a.rvol=l),a.volume=f),d&4&&(f=n[256-c],h=n[c],c!=a.panning&&!a.mixCounter&&!a.volCounter?(a.panCounter=this.mixer.samplesTick,a.lpanDelta=(f-a.lpan)/a.panCounter,a.rpanDelta=(h-a.rpan)/a.panCounter):(a.lpan=f,a.rpan=h),a.panning=c),d&j&&(e+=g.period+g.arpDelta+g.vibDelta,a.speed=this.linear?(548077568*Math.pow(2,(4608-e)/768)/this.sampleRate>>0)/65536:(65536*(14317456/e)/this.sampleRate>>0)/65536),a.mixCounter)a.lmixRampU=0,a.lmixDeltaU=
a.lvol/220,a.rmixRampU=0,a.rmixDeltaU=a.rvol/220}else a.volCounter=0,a.panCounter=0;g=g.next}}},envelope:{value:function(a,e,d){var h=e.position,f=d.points[h];if(e.frame==f.frame){d.flags&4&&h==d.loopEnd&&(h=e.position=d.loopStart,f=d.points[h],e.frame=f.frame);if(h==d.total-1){e.value=f.value;e.stopped=1;return}if(d.flags&2&&h==d.sustain&&!a.fadeEnabled){e.value=f.value;return}e.position++;a=d.points[e.position];e.delta=(a.value-f.value<<8)/(a.frame-f.frame)>>0||0;e.fraction=f.value<<8}else e.fraction+=
e.delta;e.value=e.fraction>>8;e.frame++}},amiga:{value:function(a,e){var d=0,h=r[++a];0>e?d=(r[--a]-h)/64:0<e&&(d=(h-r[++a])/64);return h-d*e>>0}},retrig:{value:function(a){switch(a.retrigx){case 1:a.volume--;break;case 2:a.volume++;break;case 3:a.volume-=4;break;case 4:a.volume-=8;break;case 5:a.volume-=16;break;case 6:a.volume=(a.volume<<1)/3;break;case 7:a.volume>>=1;break;case 8:a.volume=a.sample.volume;break;case 9:a.volume++;break;case 10:a.volume+=2;break;case 11:a.volume+=4;break;case 12:a.volume+=
8;break;case 13:a.volume+=16;break;case 14:a.volume=3*a.volume>>1;break;case 15:a.volume<<=1}0>a.volume?a.volume=0:64<a.volume&&(a.volume=64);a.flags|=i}}});return Object.seal(m)}})();
